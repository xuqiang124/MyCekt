/Users/I764812/myCode/MyCekt/code/train_demo_1.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embeddings_tensor = torch.tensor(embeddings, dtype=torch.long)
=== GPU信息 ===
PyTorch版本: 2.7.1
CUDA可用: False
CUDA不可用，将使用CPU训练
==================================================
使用CPU训练
Namespace(no_cuda=False, seed=42, data_dir='../data', save_dir='../model', graph_save_dir='graphs', load_dir='', hid_dim=32, emb_dim=32, attn_dim=32, vae_encoder_dim=32, vae_decoder_dim=32, edge_types=2, dropout=0, bias=True, binary=True, result_type=12, temp=0.5, hard=False, no_factor=False, prior=False, var=1, epochs=50, batch_size=512, train_ratio=0.6, val_ratio=0.2, shuffle=True, lr=0.001, lr_decay=50, gamma=0.5, test=False, test_model_dir='logs/expDKT', weight_method='senet', amp=False, gpu_id=0, cuda=False, factor=True)
从pkl文件加载数据集...../data/439
从pkl文件加载数据集...../data/439
训练集大小: 1489
验证集大小: 577
测试集大小: 517
模型初始化完成
start training!
EarlyStopping: 监控 val_loss (最小值)，耐心值 15，最小变化阈值 0.001
开始训练，最大epoch数: 50
提前停止配置已启用，监控验证损失
y_pred: tensor([0.7991, 0.7394, 0.7520,  ..., 0.7131, 0.7814, 0.7509],
       grad_fn=<IndexBackward0>)
负样本数量： 13736
正样本数量： 8198
TP:  8198
TN:  0
FP:  13736
FN:  0
batch idx: 0, loss: 1.056608 auc: 0.4932, acc: 0.3738, precision: 0.3738, recall: 1.0000, f1: 0.5441, time: 0.109s
y_pred: tensor([0.1735, 0.1444, 0.1344,  ..., 0.1670, 0.1933, 0.1966],
       grad_fn=<IndexBackward0>)
负样本数量： 13818
正样本数量： 7857
TP:  0
TN:  13818
FP:  0
FN:  7857
batch idx: 1, loss: 0.762990 auc: 0.6116, acc: 0.6375, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.086s
y_pred: tensor([0.2286, 0.2804, 0.2752,  ..., 0.2686, 0.2776, 0.2749],
       grad_fn=<IndexBackward0>)
负样本数量： 12857
正样本数量： 7464
TP:  0
TN:  12857
FP:  0
FN:  7464
batch idx: 2, loss: 0.659757 auc: 0.6666, acc: 0.6327, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.084s
First attempt - auc_train: 0.4931528811 acc_train: 0.3737576365
y_pred: tensor([0.5276, 0.5465, 0.5538,  ..., 0.5445, 0.5581, 0.5667])
负样本数量： 15607
正样本数量： 7016
TP:  81
TN:  15607
FP:  0
FN:  6935
y_pred: tensor([0.3912, 0.5082, 0.5484,  ..., 0.5770, 0.5515, 0.4247])
负样本数量： 1959
正样本数量： 913
TP:  17
TN:  1959
FP:  0
FN:  896
First attempt - auc_val: 0.7368932614 acc_val: 0.6934535650
Epoch: 0000 loss_train: 0.8264513413 auc_train: 0.5904698082 acc_train: 0.5479871761 precision_train: 0.1245858788 recall_train: 0.3333333333 f1_train: 0.1813797071 loss_val: 0.6557378471 auc_val: 0.7321205942 acc_val: 0.6907379245 precision_val: 1.0000000000 recall_val: 0.0150824871 f1_val: 0.0296928431 time: 0.3786s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0000: val_loss 改善从 0.655738 到 0.655738
y_pred: tensor([0.5360, 0.5155, 0.5561,  ..., 0.6035, 0.6116, 0.5638],
       grad_fn=<IndexBackward0>)
负样本数量： 14358
正样本数量： 7721
TP:  309
TN:  14287
FP:  71
FN:  7412
batch idx: 0, loss: 0.651363 auc: 0.7281, acc: 0.6611, precision: 0.8132, recall: 0.0400, f1: 0.0763, time: 0.087s
y_pred: tensor([0.5518, 0.5699, 0.5777,  ..., 0.5800, 0.4050, 0.3840],
       grad_fn=<IndexBackward0>)
负样本数量： 13906
正样本数量： 8090
TP:  840
TN:  13518
FP:  388
FN:  7250
batch idx: 1, loss: 0.638450 auc: 0.7389, acc: 0.6528, precision: 0.6840, recall: 0.1038, f1: 0.1803, time: 0.091s
y_pred: tensor([0.4502, 0.4944, 0.4811,  ..., 0.3178, 0.4641, 0.3288],
       grad_fn=<IndexBackward0>)
负样本数量： 12147
正样本数量： 7708
TP:  0
TN:  12147
FP:  0
FN:  7708
batch idx: 2, loss: 0.600422 auc: 0.7532, acc: 0.6118, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.087s
First attempt - auc_train: 0.7281118646 acc_train: 0.6610806649
y_pred: tensor([0.3244, 0.1843, 0.2533,  ..., 0.4889, 0.4817, 0.4653])
负样本数量： 15529
正样本数量： 6989
TP:  0
TN:  15529
FP:  0
FN:  6989
y_pred: tensor([0.1728, 0.1582, 0.1619,  ..., 0.2972, 0.3556, 0.3941])
负样本数量： 2037
正样本数量： 940
TP:  0
TN:  2037
FP:  0
FN:  940
First attempt - auc_val: 0.7700174845 acc_val: 0.6896260769
Epoch: 0001 loss_train: 0.6300781171 auc_train: 0.7400896365 acc_train: 0.6418737186 precision_train: 0.4990656609 recall_train: 0.0479508713 f1_train: 0.0855276930 loss_val: 0.5411067307 auc_val: 0.7693625583 acc_val: 0.6869359810 precision_val: 0.0000000000 recall_val: 0.0000000000 f1_val: 0.0000000000 time: 0.3733s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0001: val_loss 改善从 0.541107 到 0.541107
y_pred: tensor([0.3855, 0.3710, 0.1883,  ..., 0.4819, 0.4300, 0.4588],
       grad_fn=<IndexBackward0>)
负样本数量： 13926
正样本数量： 7787
TP:  0
TN:  13926
FP:  0
FN:  7787
batch idx: 0, loss: 0.573041 auc: 0.7675, acc: 0.6414, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.090s
y_pred: tensor([0.1540, 0.1235, 0.1634,  ..., 0.3786, 0.3845, 0.4473],
       grad_fn=<IndexBackward0>)
负样本数量： 14057
正样本数量： 8224
TP:  10
TN:  14056
FP:  1
FN:  8214
batch idx: 1, loss: 0.571664 auc: 0.7749, acc: 0.6313, precision: 0.9091, recall: 0.0012, f1: 0.0024, time: 0.089s
y_pred: tensor([0.1341, 0.1217, 0.0941,  ..., 0.4875, 0.5329, 0.5462],
       grad_fn=<IndexBackward0>)
负样本数量： 12428
正样本数量： 7508
TP:  773
TN:  12275
FP:  153
FN:  6735
batch idx: 2, loss: 0.551630 auc: 0.7871, acc: 0.6545, precision: 0.8348, recall: 0.1030, f1: 0.1833, time: 0.089s
First attempt - auc_train: 0.7675235257 acc_train: 0.6413669230
y_pred: tensor([0.1517, 0.1207, 0.1095,  ..., 0.6267, 0.6392, 0.5865])
负样本数量： 15646
正样本数量： 7024
TP:  3508
TN:  13672
FP:  1974
FN:  3516
y_pred: tensor([0.4120, 0.5077, 0.5171,  ..., 0.2386, 0.3962, 0.4476])
负样本数量： 1920
正样本数量： 905
TP:  471
TN:  1675
FP:  245
FN:  434
First attempt - auc_val: 0.7774423976 acc_val: 0.7578297309
Epoch: 0002 loss_train: 0.5654448668 auc_train: 0.7765083899 acc_train: 0.6423871720 precision_train: 0.5812880424 recall_train: 0.0347242664 f1_train: 0.0619114419 loss_val: 0.5238243639 auc_val: 0.7813699672 acc_val: 0.7587378743 precision_val: 0.6488668349 recall_val: 0.5099362564 f1_val: 0.5710667393 time: 0.3695s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0002: val_loss 改善从 0.523824 到 0.523824
y_pred: tensor([0.1362, 0.1077, 0.0934,  ..., 0.3898, 0.4961, 0.5920],
       grad_fn=<IndexBackward0>)
负样本数量： 14118
正样本数量： 8258
TP:  4291
TN:  12705
FP:  1413
FN:  3967
batch idx: 0, loss: 0.540409 auc: 0.7865, acc: 0.7596, precision: 0.7523, recall: 0.5196, f1: 0.6147, time: 0.086s
y_pred: tensor([0.1597, 0.1266, 0.1114,  ..., 0.3468, 0.3963, 0.4592],
       grad_fn=<IndexBackward0>)
负样本数量： 13812
正样本数量： 7883
TP:  4307
TN:  12018
FP:  1794
FN:  3576
batch idx: 1, loss: 0.538609 auc: 0.7853, acc: 0.7525, precision: 0.7059, recall: 0.5464, f1: 0.6160, time: 0.088s
y_pred: tensor([0.3882, 0.1764, 0.1188,  ..., 0.7852, 0.7438, 0.7667],
       grad_fn=<IndexBackward0>)
负样本数量： 12481
正样本数量： 7378
TP:  3703
TN:  11379
FP:  1102
FN:  3675
batch idx: 2, loss: 0.527056 auc: 0.7894, acc: 0.7595, precision: 0.7707, recall: 0.5019, f1: 0.6079, time: 0.087s
First attempt - auc_train: 0.7864987545 acc_train: 0.7595638184
y_pred: tensor([0.3883, 0.4387, 0.5000,  ..., 0.0929, 0.0929, 0.0924])
负样本数量： 15605
正样本数量： 7037
TP:  2638
TN:  14574
FP:  1031
FN:  4399
y_pred: tensor([0.4528, 0.5336, 0.5781,  ..., 0.7102, 0.7189, 0.7434])
负样本数量： 1961
正样本数量： 892
TP:  356
TN:  1868
FP:  93
FN:  536
First attempt - auc_val: 0.7711255338 acc_val: 0.7601801961
Epoch: 0003 loss_train: 0.5353580316 auc_train: 0.7870611378 acc_train: 0.7571651665 precision_train: 0.7429615046 recall_train: 0.5226268236 f1_train: 0.6128514457 loss_val: 0.4934857637 auc_val: 0.7915119886 acc_val: 0.7698552575 precision_val: 0.7559350266 recall_val: 0.3869893981 f1_val: 0.5118774129 time: 0.3628s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0003: val_loss 改善从 0.493486 到 0.493486
y_pred: tensor([0.3922, 0.1885, 0.1350,  ..., 0.7679, 0.7724, 0.7729],
       grad_fn=<IndexBackward0>)
负样本数量： 13542
正样本数量： 8101
TP:  3121
TN:  13061
FP:  481
FN:  4980
batch idx: 0, loss: 0.524952 auc: 0.7922, acc: 0.7477, precision: 0.8665, recall: 0.3853, f1: 0.5334, time: 0.087s
y_pred: tensor([0.5133, 0.5000, 0.2287,  ..., 0.8150, 0.8300, 0.8533],
       grad_fn=<IndexBackward0>)
负样本数量： 14029
正样本数量： 8022
TP:  3430
TN:  13162
FP:  867
FN:  4592
batch idx: 1, loss: 0.525857 auc: 0.7801, acc: 0.7524, precision: 0.7982, recall: 0.4276, f1: 0.5569, time: 0.092s
y_pred: tensor([0.2255, 0.3356, 0.3856,  ..., 0.7317, 0.7642, 0.7834],
       grad_fn=<IndexBackward0>)
负样本数量： 12840
正样本数量： 7396
TP:  3453
TN:  11932
FP:  908
FN:  3943
batch idx: 2, loss: 0.518377 auc: 0.7877, acc: 0.7603, precision: 0.7918, recall: 0.4669, f1: 0.5874, time: 0.087s
First attempt - auc_train: 0.7921633339 acc_train: 0.7476782331
y_pred: tensor([0.2085, 0.1545, 0.1354,  ..., 0.1969, 0.2825, 0.1772])
负样本数量： 15647
正样本数量： 7004
TP:  3436
TN:  13795
FP:  1852
FN:  3568
y_pred: tensor([0.2130, 0.1644, 0.1409,  ..., 0.2195, 0.1619, 0.2417])
负样本数量： 1919
正样本数量： 925
TP:  516
TN:  1630
FP:  289
FN:  409
First attempt - auc_val: 0.7770930238 acc_val: 0.7607169661
Epoch: 0004 loss_train: 0.5230618517 auc_train: 0.7866276438 acc_train: 0.7534648252 precision_train: 0.8188284246 recall_train: 0.4265697453 f1_train: 0.5592085460 loss_val: 0.5292685628 auc_val: 0.7831781472 acc_val: 0.7576439964 precision_val: 0.6453834300 recall_val: 0.5242073255 f1_val: 0.5777972985 time: 0.3718s
Epoch 0004: val_loss 没有改善 0.529269，最佳值 0.493486，等待 1/15
y_pred: tensor([0.5364, 0.6586, 0.3149,  ..., 0.7840, 0.8024, 0.8554],
       grad_fn=<IndexBackward0>)
负样本数量： 14118
正样本数量： 7960
TP:  4015
TN:  12796
FP:  1322
FN:  3945
batch idx: 0, loss: 0.515063 auc: 0.7919, acc: 0.7614, precision: 0.7523, recall: 0.5044, f1: 0.6039, time: 0.090s
y_pred: tensor([0.5627, 0.2432, 0.1941,  ..., 0.5929, 0.6453, 0.6749],
       grad_fn=<IndexBackward0>)
负样本数量： 13891
正样本数量： 8182
TP:  4043
TN:  12720
FP:  1171
FN:  4139
batch idx: 1, loss: 0.515697 auc: 0.7922, acc: 0.7594, precision: 0.7754, recall: 0.4941, f1: 0.6036, time: 0.094s
y_pred: tensor([0.5082, 0.6233, 0.6030,  ..., 0.3271, 0.3828, 0.4693],
       grad_fn=<IndexBackward0>)
负样本数量： 12402
正样本数量： 7377
TP:  2960
TN:  11819
FP:  583
FN:  4417
batch idx: 2, loss: 0.524510 auc: 0.7859, acc: 0.7472, precision: 0.8355, recall: 0.4012, f1: 0.5421, time: 0.105s
First attempt - auc_train: 0.7919384739 acc_train: 0.7614367243
y_pred: tensor([0.5610, 0.6201, 0.2125,  ..., 0.1467, 0.2178, 0.2620])
负样本数量： 15722
正样本数量： 7027
TP:  3061
TN:  14306
FP:  1416
FN:  3966
y_pred: tensor([0.1737, 0.1272, 0.1076,  ..., 0.8320, 0.8654, 0.8648])
负样本数量： 1844
正样本数量： 902
TP:  403
TN:  1722
FP:  122
FN:  499
First attempt - auc_val: 0.7812989694 acc_val: 0.7634181722
Epoch: 0005 loss_train: 0.5184234182 auc_train: 0.7900265754 acc_train: 0.7560259870 precision_train: 0.7877192773 recall_train: 0.4665925227 f1_train: 0.5832110588 loss_val: 0.4989032745 auc_val: 0.7897633182 acc_val: 0.7686355246 precision_val: 0.7256679111 recall_val: 0.4411952220 f1_val: 0.5484920147 time: 0.3968s
Epoch 0005: val_loss 没有改善 0.498903，最佳值 0.493486，等待 2/15
y_pred: tensor([0.1749, 0.1214, 0.1050,  ..., 0.2955, 0.3088, 0.3557],
       grad_fn=<IndexBackward0>)
负样本数量： 14110
正样本数量： 7849
TP:  3504
TN:  13217
FP:  893
FN:  4345
batch idx: 0, loss: 0.512187 auc: 0.7879, acc: 0.7615, precision: 0.7969, recall: 0.4464, f1: 0.5723, time: 0.089s
y_pred: tensor([0.1787, 0.1225, 0.0961,  ..., 0.7518, 0.7907, 0.8266],
       grad_fn=<IndexBackward0>)
负样本数量： 13888
正样本数量： 7926
TP:  4122
TN:  12658
FP:  1230
FN:  3804
batch idx: 1, loss: 0.502362 auc: 0.8008, acc: 0.7692, precision: 0.7702, recall: 0.5201, f1: 0.6209, time: 0.091s
y_pred: tensor([0.4843, 0.4942, 0.5878,  ..., 0.8850, 0.8880, 0.9043],
       grad_fn=<IndexBackward0>)
负样本数量： 12413
正样本数量： 7744
TP:  3977
TN:  11425
FP:  988
FN:  3767
batch idx: 2, loss: 0.507415 auc: 0.8027, acc: 0.7641, precision: 0.8010, recall: 0.5136, f1: 0.6259, time: 0.088s
First attempt - auc_train: 0.7878863893 acc_train: 0.7614645476
y_pred: tensor([0.4470, 0.4895, 0.5255,  ..., 0.8969, 0.8882, 0.8965])
负样本数量： 15653
正样本数量： 7006
TP:  3271
TN:  14298
FP:  1355
FN:  3735
y_pred: tensor([0.1453, 0.1087, 0.0956,  ..., 0.6240, 0.6859, 0.7400])
负样本数量： 1913
正样本数量： 923
TP:  403
TN:  1750
FP:  163
FN:  520
First attempt - auc_val: 0.7926614872 acc_val: 0.7753651971
Epoch: 0006 loss_train: 0.5073211193 auc_train: 0.7971344630 acc_train: 0.7649323726 precision_train: 0.7893644679 recall_train: 0.4933485803 f1_train: 0.6063336089 loss_val: 0.5025451481 auc_val: 0.7882998731 acc_val: 0.7672665195 precision_val: 0.7095522466 recall_val: 0.4517526225 f1_val: 0.5518584591 time: 0.3672s
Epoch 0006: val_loss 没有改善 0.502545，最佳值 0.493486，等待 3/15
y_pred: tensor([0.1515, 0.1106, 0.0892,  ..., 0.8789, 0.9015, 0.8708],
       grad_fn=<IndexBackward0>)
负样本数量： 13844
正样本数量： 8037
TP:  3848
TN:  13018
FP:  826
FN:  4189
batch idx: 0, loss: 0.505270 auc: 0.7951, acc: 0.7708, precision: 0.8233, recall: 0.4788, f1: 0.6055, time: 0.088s
y_pred: tensor([0.4354, 0.5079, 0.5232,  ..., 0.9171, 0.9154, 0.9097],
       grad_fn=<IndexBackward0>)
负样本数量： 13841
正样本数量： 8105
TP:  3893
TN:  13045
FP:  796
FN:  4212
batch idx: 1, loss: 0.495422 auc: 0.8071, acc: 0.7718, precision: 0.8302, recall: 0.4803, f1: 0.6086, time: 0.088s
y_pred: tensor([0.4653, 0.5812, 0.5881,  ..., 0.8731, 0.8523, 0.8787],
       grad_fn=<IndexBackward0>)
负样本数量： 12726
正样本数量： 7377
TP:  3670
TN:  11872
FP:  854
FN:  3707
batch idx: 2, loss: 0.499198 auc: 0.8020, acc: 0.7731, precision: 0.8112, recall: 0.4975, f1: 0.6168, time: 0.087s
First attempt - auc_train: 0.7950864316 acc_train: 0.7708057219
y_pred: tensor([0.4151, 0.1616, 0.1135,  ..., 0.8986, 0.8863, 0.9124])
负样本数量： 15511
正样本数量： 7070
TP:  3480
TN:  14225
FP:  1286
FN:  3590
y_pred: tensor([0.4648, 0.5259, 0.5546,  ..., 0.1334, 0.1315, 0.1482])
负样本数量： 2055
正样本数量： 859
TP:  393
TN:  1935
FP:  120
FN:  466
First attempt - auc_val: 0.8007470813 acc_val: 0.7840662504
Epoch: 0007 loss_train: 0.4999634027 auc_train: 0.8013767313 acc_train: 0.7719092265 precision_train: 0.8215825656 recall_train: 0.4855328706 f1_train: 0.6102604160 loss_val: 0.4824538380 auc_val: 0.7950509084 acc_val: 0.7914840518 precision_val: 0.7481269617 recall_val: 0.4748646909 f1_val: 0.5804613981 time: 0.3653s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0007: val_loss 改善从 0.482454 到 0.482454
y_pred: tensor([0.5615, 0.5955, 0.6613,  ..., 0.8696, 0.8773, 0.8888],
       grad_fn=<IndexBackward0>)
负样本数量： 13786
正样本数量： 7780
TP:  3879
TN:  12941
FP:  845
FN:  3901
batch idx: 0, loss: 0.494924 auc: 0.8004, acc: 0.7799, precision: 0.8211, recall: 0.4986, f1: 0.6204, time: 0.088s
y_pred: tensor([0.1492, 0.1093, 0.0980,  ..., 0.7644, 0.7703, 0.8217],
       grad_fn=<IndexBackward0>)
负样本数量： 14019
正样本数量： 8067
TP:  3826
TN:  13435
FP:  584
FN:  4241
batch idx: 1, loss: 0.490313 auc: 0.8059, acc: 0.7815, precision: 0.8676, recall: 0.4743, f1: 0.6133, time: 0.090s
y_pred: tensor([0.3994, 0.1679, 0.2168,  ..., 0.3033, 0.2847, 0.2941],
       grad_fn=<IndexBackward0>)
负样本数量： 12606
正样本数量： 7672
TP:  3693
TN:  12158
FP:  448
FN:  3979
batch idx: 2, loss: 0.485488 auc: 0.8161, acc: 0.7817, precision: 0.8918, recall: 0.4814, f1: 0.6252, time: 0.089s
First attempt - auc_train: 0.8004455407 acc_train: 0.7799313735
y_pred: tensor([0.3743, 0.4002, 0.5298,  ..., 0.9194, 0.9062, 0.9071])
负样本数量： 15549
正样本数量： 7008
TP:  3786
TN:  14142
FP:  1407
FN:  3222
y_pred: tensor([0.4905, 0.5381, 0.1971,  ..., 0.9089, 0.8874, 0.9135])
负样本数量： 2017
正样本数量： 921
TP:  521
TN:  1768
FP:  249
FN:  400
First attempt - auc_val: 0.8091887296 acc_val: 0.7947865408
Epoch: 0008 loss_train: 0.4902416666 auc_train: 0.8075088279 acc_train: 0.7810505908 precision_train: 0.8601711440 recall_train: 0.4847416110 f1_train: 0.6196577618 loss_val: 0.5017360151 auc_val: 0.8015211118 acc_val: 0.7869439852 precision_val: 0.7028408622 recall_val: 0.5529645970 f1_val: 0.6184041492 time: 0.3719s
Epoch 0008: val_loss 没有改善 0.501736，最佳值 0.482454，等待 1/15
y_pred: tensor([0.1571, 0.1211, 0.1036,  ..., 0.8997, 0.9039, 0.9247],
       grad_fn=<IndexBackward0>)
负样本数量： 14476
正样本数量： 7959
TP:  4539
TN:  12988
FP:  1488
FN:  3420
batch idx: 0, loss: 0.499196 auc: 0.8062, acc: 0.7812, precision: 0.7531, recall: 0.5703, f1: 0.6491, time: 0.091s
y_pred: tensor([0.1497, 0.1076, 0.0993,  ..., 0.8307, 0.8553, 0.8671],
       grad_fn=<IndexBackward0>)
负样本数量： 13335
正样本数量： 8312
TP:  3399
TN:  13125
FP:  210
FN:  4913
batch idx: 1, loss: 0.497964 auc: 0.8158, acc: 0.7633, precision: 0.9418, recall: 0.4089, f1: 0.5703, time: 0.093s
y_pred: tensor([0.4771, 0.3884, 0.1627,  ..., 0.3066, 0.4347, 0.1880],
       grad_fn=<IndexBackward0>)
负样本数量： 12600
正样本数量： 7248
TP:  3513
TN:  12130
FP:  470
FN:  3735
batch idx: 2, loss: 0.481445 auc: 0.8110, acc: 0.7881, precision: 0.8820, recall: 0.4847, f1: 0.6256, time: 0.097s
First attempt - auc_train: 0.8062051296 acc_train: 0.7812346780
y_pred: tensor([0.4881, 0.5299, 0.4363,  ..., 0.9113, 0.9118, 0.9116])
负样本数量： 15472
正样本数量： 6972
TP:  3788
TN:  14090
FP:  1382
FN:  3184
y_pred: tensor([0.3030, 0.1523, 0.1120,  ..., 0.9307, 0.9303, 0.8963])
负样本数量： 2094
正样本数量： 957
TP:  554
TN:  1836
FP:  258
FN:  403
First attempt - auc_val: 0.8131101606 acc_val: 0.7965603279
Epoch: 0009 loss_train: 0.4928685427 auc_train: 0.8110007770 acc_train: 0.7775711906 precision_train: 0.8589738768 recall_train: 0.4879700198 f1_train: 0.6149739025 loss_val: 0.4992415905 auc_val: 0.8045798892 acc_val: 0.7899550247 precision_val: 0.7074772989 recall_val: 0.5611042468 f1_val: 0.6251462461 time: 0.3946s
Epoch 0009: val_loss 没有改善 0.499242，最佳值 0.482454，等待 2/15
y_pred: tensor([0.3597, 0.3890, 0.3710,  ..., 0.4962, 0.5749, 0.5820],
       grad_fn=<IndexBackward0>)
负样本数量： 14103
正样本数量： 8171
TP:  4694
TN:  12804
FP:  1299
FN:  3477
batch idx: 0, loss: 0.490095 auc: 0.8115, acc: 0.7856, precision: 0.7832, recall: 0.5745, f1: 0.6628, time: 0.086s
y_pred: tensor([0.3026, 0.1543, 0.1211,  ..., 0.9196, 0.9099, 0.9035],
       grad_fn=<IndexBackward0>)
负样本数量： 13723
正样本数量： 8204
TP:  4100
TN:  13148
FP:  575
FN:  4104
batch idx: 1, loss: 0.478590 auc: 0.8156, acc: 0.7866, precision: 0.8770, recall: 0.4998, f1: 0.6367, time: 0.088s
y_pred: tensor([0.3857, 0.3780, 0.1644,  ..., 0.8897, 0.8934, 0.8913],
       grad_fn=<IndexBackward0>)
负样本数量： 12585
正样本数量： 7144
TP:  3088
TN:  12253
FP:  332
FN:  4056
batch idx: 2, loss: 0.485279 auc: 0.8111, acc: 0.7776, precision: 0.9029, recall: 0.4323, f1: 0.5846, time: 0.090s
First attempt - auc_train: 0.8115343084 acc_train: 0.7855795995
y_pred: tensor([0.2849, 0.2995, 0.2991,  ..., 0.1592, 0.1574, 0.2682])
负样本数量： 15669
正样本数量： 7070
TP:  3167
TN:  14998
FP:  671
FN:  3903
y_pred: tensor([0.4019, 0.4032, 0.3935,  ..., 0.8850, 0.8795, 0.9062])
负样本数量： 1897
正样本数量： 859
TP:  412
TN:  1817
FP:  80
FN:  447
First attempt - auc_val: 0.8116384409 acc_val: 0.7988477945
Epoch: 0010 loss_train: 0.4846548140 auc_train: 0.8127669493 acc_train: 0.7832586697 precision_train: 0.8543921486 recall_train: 0.5021592485 f1_train: 0.6280431825 loss_val: 0.4536960870 auc_val: 0.8159900189 acc_val: 0.8038143182 precision_val: 0.8312838665 recall_val: 0.4637882772 f1_val: 0.5952966565 time: 0.3662s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0010: val_loss 改善从 0.453696 到 0.453696
y_pred: tensor([0.2900, 0.3668, 0.2971,  ..., 0.5547, 0.6097, 0.6900],
       grad_fn=<IndexBackward0>)
负样本数量： 13880
正样本数量： 8125
TP:  3931
TN:  13428
FP:  452
FN:  4194
batch idx: 0, loss: 0.475338 auc: 0.8153, acc: 0.7889, precision: 0.8969, recall: 0.4838, f1: 0.6286, time: 0.088s
y_pred: tensor([0.1333, 0.1960, 0.1116,  ..., 0.9030, 0.9336, 0.9365],
       grad_fn=<IndexBackward0>)
负样本数量： 13914
正样本数量： 7899
TP:  4453
TN:  12737
FP:  1177
FN:  3446
batch idx: 1, loss: 0.487079 auc: 0.8101, acc: 0.7881, precision: 0.7909, recall: 0.5637, f1: 0.6583, time: 0.090s
y_pred: tensor([0.1258, 0.1007, 0.0900,  ..., 0.9179, 0.9299, 0.9053],
       grad_fn=<IndexBackward0>)
负样本数量： 12617
正样本数量： 7495
TP:  3798
TN:  12146
FP:  471
FN:  3697
batch idx: 2, loss: 0.471118 auc: 0.8183, acc: 0.7928, precision: 0.8897, recall: 0.5067, f1: 0.6457, time: 0.087s
First attempt - auc_train: 0.8152526047 acc_train: 0.7888661668
y_pred: tensor([0.4450, 0.4734, 0.4994,  ..., 0.1871, 0.3020, 0.3316])
负样本数量： 15575
正样本数量： 7074
TP:  3020
TN:  15100
FP:  475
FN:  4054
y_pred: tensor([0.4487, 0.1744, 0.2405,  ..., 0.3462, 0.1783, 0.1718])
负样本数量： 1991
正样本数量： 855
TP:  415
TN:  1912
FP:  79
FN:  440
First attempt - auc_val: 0.8138265100 acc_val: 0.8000353216
Epoch: 0011 loss_train: 0.4778449635 auc_train: 0.8145500948 acc_train: 0.7898962908 precision_train: 0.8591617948 recall_train: 0.5180984852 f1_train: 0.6441820217 loss_val: 0.4511088282 auc_val: 0.8135278159 acc_val: 0.8088370565 precision_val: 0.8520862655 recall_val: 0.4561477910 f1_val: 0.5933766043 time: 0.3678s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0011: val_loss 改善从 0.451109 到 0.451109
y_pred: tensor([0.1638, 0.1319, 0.2062,  ..., 0.9033, 0.8912, 0.9260],
       grad_fn=<IndexBackward0>)
负样本数量： 13912
正样本数量： 8089
TP:  3759
TN:  13557
FP:  355
FN:  4330
batch idx: 0, loss: 0.475565 auc: 0.8118, acc: 0.7871, precision: 0.9137, recall: 0.4647, f1: 0.6161, time: 0.090s
y_pred: tensor([0.1215, 0.1638, 0.1994,  ..., 0.1891, 0.1674, 0.1725],
       grad_fn=<IndexBackward0>)
负样本数量： 14263
正样本数量： 8053
TP:  4175
TN:  13672
FP:  591
FN:  3878
batch idx: 1, loss: 0.463631 auc: 0.8175, acc: 0.7997, precision: 0.8760, recall: 0.5184, f1: 0.6514, time: 0.092s
y_pred: tensor([0.2998, 0.3172, 0.3636,  ..., 0.9315, 0.9322, 0.9353],
       grad_fn=<IndexBackward0>)
负样本数量： 12236
正样本数量： 7377
TP:  3749
TN:  11728
FP:  508
FN:  3628
batch idx: 2, loss: 0.471771 auc: 0.8184, acc: 0.7891, precision: 0.8807, recall: 0.5082, f1: 0.6445, time: 0.093s
First attempt - auc_train: 0.8117779571 acc_train: 0.7870551339
y_pred: tensor([0.4254, 0.4549, 0.4829,  ..., 0.9376, 0.9295, 0.9496])
负样本数量： 15459
正样本数量： 7089
TP:  3469
TN:  14703
FP:  756
FN:  3620
y_pred: tensor([0.1628, 0.1429, 0.1271,  ..., 0.3144, 0.2821, 0.2791])
负样本数量： 2107
正样本数量： 840
TP:  417
TN:  1982
FP:  125
FN:  423
First attempt - auc_val: 0.8156216137 acc_val: 0.8059251375
Epoch: 0012 loss_train: 0.4703222215 auc_train: 0.8158932559 acc_train: 0.7919715641 precision_train: 0.8901243549 recall_train: 0.4971155512 f1_train: 0.6373150544 loss_val: 0.4541529566 auc_val: 0.8140490829 acc_val: 0.8099866610 precision_val: 0.7952188912 recall_val: 0.4928891341 f1_val: 0.6083478917 time: 0.3794s
Epoch 0012: val_loss 没有改善 0.454153，最佳值 0.451109，等待 1/15
y_pred: tensor([0.4967, 0.1768, 0.2126,  ..., 0.9297, 0.9374, 0.9411],
       grad_fn=<IndexBackward0>)
负样本数量： 13609
正样本数量： 7579
TP:  3820
TN:  12987
FP:  622
FN:  3759
batch idx: 0, loss: 0.472056 auc: 0.8123, acc: 0.7932, precision: 0.8600, recall: 0.5040, f1: 0.6356, time: 0.087s
y_pred: tensor([0.2908, 0.1557, 0.1146,  ..., 0.9093, 0.9003, 0.8958],
       grad_fn=<IndexBackward0>)
负样本数量： 14175
正样本数量： 8329
TP:  4234
TN:  13694
FP:  481
FN:  4095
batch idx: 1, loss: 0.462112 auc: 0.8195, acc: 0.7967, precision: 0.8980, recall: 0.5083, f1: 0.6492, time: 0.090s
y_pred: tensor([0.3446, 0.3495, 0.3220,  ..., 0.9249, 0.9475, 0.9353],
       grad_fn=<IndexBackward0>)
负样本数量： 12627
正样本数量： 7611
TP:  3889
TN:  12184
FP:  443
FN:  3722
batch idx: 2, loss: 0.463123 auc: 0.8194, acc: 0.7942, precision: 0.8977, recall: 0.5110, f1: 0.6513, time: 0.087s
First attempt - auc_train: 0.8123289753 acc_train: 0.7932320181
y_pred: tensor([0.4832, 0.5146, 0.3780,  ..., 0.9249, 0.9562, 0.9572])
负样本数量： 15489
正样本数量： 7073
TP:  3395
TN:  14812
FP:  677
FN:  3678
y_pred: tensor([0.1547, 0.1240, 0.1211,  ..., 0.9291, 0.9438, 0.9254])
负样本数量： 2077
正样本数量： 856
TP:  420
TN:  2004
FP:  73
FN:  436
First attempt - auc_val: 0.8154548495 acc_val: 0.8069763319
Epoch: 0013 loss_train: 0.4657634894 auc_train: 0.8170665252 acc_train: 0.7946964738 precision_train: 0.8852319681 recall_train: 0.5077798599 f1_train: 0.6453339882 loss_val: 0.4420250654 auc_val: 0.8199588794 acc_val: 0.8167169419 precision_val: 0.8428348052 recall_val: 0.4853242751 f1_val: 0.6159626409 time: 0.3658s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0013: val_loss 改善从 0.442025 到 0.442025
y_pred: tensor([0.1196, 0.0987, 0.0858,  ..., 0.9559, 0.9469, 0.9450],
       grad_fn=<IndexBackward0>)
负样本数量： 13693
正样本数量： 8043
TP:  4275
TN:  13135
FP:  558
FN:  3768
batch idx: 0, loss: 0.460355 auc: 0.8191, acc: 0.8010, precision: 0.8845, recall: 0.5315, f1: 0.6640, time: 0.086s
y_pred: tensor([0.1184, 0.0918, 0.0884,  ..., 0.3840, 0.4341, 0.4865],
       grad_fn=<IndexBackward0>)
负样本数量： 13861
正样本数量： 8207
TP:  4161
TN:  13430
FP:  431
FN:  4046
batch idx: 1, loss: 0.458700 auc: 0.8214, acc: 0.7971, precision: 0.9061, recall: 0.5070, f1: 0.6502, time: 0.093s
y_pred: tensor([0.4018, 0.1564, 0.1276,  ..., 0.9465, 0.9309, 0.9437],
       grad_fn=<IndexBackward0>)
负样本数量： 12857
正样本数量： 7269
TP:  3631
TN:  12312
FP:  545
FN:  3638
batch idx: 2, loss: 0.468859 auc: 0.8136, acc: 0.7922, precision: 0.8695, recall: 0.4995, f1: 0.6345, time: 0.088s
First attempt - auc_train: 0.8190754191 acc_train: 0.8009753404
y_pred: tensor([0.1195, 0.1021, 0.0980,  ..., 0.2806, 0.2766, 0.2724])
负样本数量： 15581
正样本数量： 7030
TP:  3239
TN:  15072
FP:  509
FN:  3791
y_pred: tensor([0.2961, 0.1340, 0.2556,  ..., 0.9376, 0.9421, 0.9422])
负样本数量： 1985
正样本数量： 899
TP:  421
TN:  1915
FP:  70
FN:  478
First attempt - auc_val: 0.8177820937 acc_val: 0.8098270753
Epoch: 0014 loss_train: 0.4626375536 auc_train: 0.8180212218 acc_train: 0.7967539327 precision_train: 0.8867257379 recall_train: 0.5126809359 f1_train: 0.6495820101 loss_val: 0.4485109150 auc_val: 0.8166580031 acc_val: 0.8099066028 precision_val: 0.8608140227 recall_val: 0.4645188980 f1_val: 0.6033972748 time: 0.3655s
Epoch 0014: val_loss 没有改善 0.448511，最佳值 0.442025，等待 1/15
y_pred: tensor([0.3178, 0.1389, 0.1204,  ..., 0.7842, 0.8312, 0.8906],
       grad_fn=<IndexBackward0>)
负样本数量： 13601
正样本数量： 8428
TP:  4297
TN:  13183
FP:  418
FN:  4131
batch idx: 0, loss: 0.461312 auc: 0.8239, acc: 0.7935, precision: 0.9113, recall: 0.5098, f1: 0.6539, time: 0.087s
y_pred: tensor([0.3125, 0.1435, 0.1861,  ..., 0.8970, 0.9348, 0.9318],
       grad_fn=<IndexBackward0>)
负样本数量： 13973
正样本数量： 7992
TP:  4265
TN:  13286
FP:  687
FN:  3727
batch idx: 1, loss: 0.462257 auc: 0.8176, acc: 0.7990, precision: 0.8613, recall: 0.5337, f1: 0.6590, time: 0.091s
y_pred: tensor([0.2952, 0.3176, 0.3150,  ..., 0.1698, 0.1583, 0.2488],
       grad_fn=<IndexBackward0>)
负样本数量： 12837
正样本数量： 7099
TP:  3313
TN:  12548
FP:  289
FN:  3786
batch idx: 2, loss: 0.460214 auc: 0.8153, acc: 0.7956, precision: 0.9198, recall: 0.4667, f1: 0.6192, time: 0.088s
First attempt - auc_train: 0.8238679885 acc_train: 0.7934994780
y_pred: tensor([0.4736, 0.5006, 0.5112,  ..., 0.9483, 0.9521, 0.9614])
负样本数量： 15671
正样本数量： 6997
TP:  3105
TN:  15259
FP:  412
FN:  3892
y_pred: tensor([0.1132, 0.0921, 0.0954,  ..., 0.1785, 0.1252, 0.1299])
负样本数量： 1895
正样本数量： 932
TP:  458
TN:  1787
FP:  108
FN:  474
First attempt - auc_val: 0.8197744930 acc_val: 0.8101288160
Epoch: 0015 loss_train: 0.4612610141 auc_train: 0.8189149308 acc_train: 0.7960464395 precision_train: 0.8974605788 recall_train: 0.5033974109 f1_train: 0.6440237494 loss_val: 0.4577427655 auc_val: 0.8190403997 acc_val: 0.8021284334 precision_val: 0.8460209924 recall_val: 0.4675889606 f1_val: 0.6010615130 time: 0.3662s
Epoch 0015: val_loss 没有改善 0.457743，最佳值 0.442025，等待 2/15
y_pred: tensor([0.3971, 0.4265, 0.1466,  ..., 0.1619, 0.1572, 0.2896],
       grad_fn=<IndexBackward0>)
负样本数量： 13897
正样本数量： 7823
TP:  3746
TN:  13630
FP:  267
FN:  4077
batch idx: 0, loss: 0.451224 auc: 0.8234, acc: 0.8000, precision: 0.9335, recall: 0.4788, f1: 0.6330, time: 0.090s
y_pred: tensor([0.5223, 0.4286, 0.3690,  ..., 0.4636, 0.6043, 0.7680],
       grad_fn=<IndexBackward0>)
负样本数量： 13714
正样本数量： 8082
TP:  4511
TN:  12863
FP:  851
FN:  3571
batch idx: 1, loss: 0.467651 auc: 0.8220, acc: 0.7971, precision: 0.8413, recall: 0.5582, f1: 0.6711, time: 0.090s
y_pred: tensor([0.1389, 0.2275, 0.2574,  ..., 0.9576, 0.9599, 0.9592],
       grad_fn=<IndexBackward0>)
负样本数量： 12800
正样本数量： 7614
TP:  3896
TN:  12328
FP:  472
FN:  3718
batch idx: 2, loss: 0.462769 auc: 0.8178, acc: 0.7947, precision: 0.8919, recall: 0.5117, f1: 0.6503, time: 0.090s
First attempt - auc_train: 0.8233989412 acc_train: 0.8000000000
y_pred: tensor([0.1055, 0.0960, 0.0937,  ..., 0.9578, 0.9408, 0.9528])
负样本数量： 15751
正样本数量： 7055
TP:  3148
TN:  15292
FP:  459
FN:  3907
y_pred: tensor([0.2930, 0.1401, 0.1063,  ..., 0.9493, 0.9515, 0.9539])
负样本数量： 1815
正样本数量： 874
TP:  395
TN:  1777
FP:  38
FN:  479
First attempt - auc_val: 0.8195916644 acc_val: 0.8085591511
Epoch: 0016 loss_train: 0.4605483015 auc_train: 0.8210768038 acc_train: 0.7972891464 precision_train: 0.8888993966 recall_train: 0.5162291164 f1_train: 0.6514576495 loss_val: 0.4389624000 auc_val: 0.8291380478 acc_val: 0.8081471843 precision_val: 0.8924938101 recall_val: 0.4490767215 f1_val: 0.5974729954 time: 0.3743s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0016: val_loss 改善从 0.438962 到 0.438962
y_pred: tensor([0.2880, 0.3147, 0.2544,  ..., 0.7541, 0.9082, 0.9355],
       grad_fn=<IndexBackward0>)
负样本数量： 13884
正样本数量： 8168
TP:  3901
TN:  13620
FP:  264
FN:  4267
batch idx: 0, loss: 0.453974 auc: 0.8260, acc: 0.7945, precision: 0.9366, recall: 0.4776, f1: 0.6326, time: 0.091s
y_pred: tensor([0.1047, 0.0965, 0.1451,  ..., 0.8942, 0.9382, 0.9484],
       grad_fn=<IndexBackward0>)
负样本数量： 14220
正样本数量： 8033
TP:  3973
TN:  13839
FP:  381
FN:  4060
batch idx: 1, loss: 0.452933 auc: 0.8240, acc: 0.8004, precision: 0.9125, recall: 0.4946, f1: 0.6415, time: 0.090s
y_pred: tensor([0.2697, 0.4649, 0.2141,  ..., 0.6896, 0.7271, 0.7948],
       grad_fn=<IndexBackward0>)
负样本数量： 12307
正样本数量： 7318
TP:  3707
TN:  11917
FP:  390
FN:  3611
batch idx: 2, loss: 0.459767 auc: 0.8178, acc: 0.7961, precision: 0.9048, recall: 0.5066, f1: 0.6495, time: 0.090s
First attempt - auc_train: 0.8259902966 acc_train: 0.7945311083
y_pred: tensor([0.3578, 0.3038, 0.3225,  ..., 0.9535, 0.9657, 0.9566])
负样本数量： 15602
正样本数量： 7015
TP:  3537
TN:  14867
FP:  735
FN:  3478
y_pred: tensor([0.2867, 0.3050, 0.3829,  ..., 0.9677, 0.9696, 0.9690])
负样本数量： 1964
正样本数量： 914
TP:  460
TN:  1868
FP:  96
FN:  454
First attempt - auc_val: 0.8243546869 acc_val: 0.8137241898
Epoch: 0017 loss_train: 0.4555579921 auc_train: 0.8225838421 acc_train: 0.7970299664 precision_train: 0.9179724335 recall_train: 0.4929131671 f1_train: 0.6411956463 loss_val: 0.4543763250 auc_val: 0.8188163198 acc_val: 0.8113096279 precision_val: 0.8276437838 recall_val: 0.5037437751 f1_val: 0.6262945331 time: 0.3722s
Epoch 0017: val_loss 没有改善 0.454376，最佳值 0.438962，等待 1/15
y_pred: tensor([0.2873, 0.1440, 0.2204,  ..., 0.9578, 0.9525, 0.9677],
       grad_fn=<IndexBackward0>)
负样本数量： 13995
正样本数量： 8251
TP:  4385
TN:  13468
FP:  527
FN:  3866
batch idx: 0, loss: 0.452547 auc: 0.8265, acc: 0.8025, precision: 0.8927, recall: 0.5315, f1: 0.6663, time: 0.089s
y_pred: tensor([0.1371, 0.1243, 0.1299,  ..., 0.9664, 0.9571, 0.9706],
       grad_fn=<IndexBackward0>)
负样本数量： 14021
正样本数量： 7948
TP:  4176
TN:  13457
FP:  564
FN:  3772
batch idx: 1, loss: 0.452433 auc: 0.8232, acc: 0.8026, precision: 0.8810, recall: 0.5254, f1: 0.6583, time: 0.091s
y_pred: tensor([0.1155, 0.1002, 0.1711,  ..., 0.5927, 0.6551, 0.7738],
       grad_fn=<IndexBackward0>)
负样本数量： 12395
正样本数量： 7320
TP:  3772
TN:  12011
FP:  384
FN:  3548
batch idx: 2, loss: 0.453467 auc: 0.8234, acc: 0.8006, precision: 0.9076, recall: 0.5153, f1: 0.6574, time: 0.089s
First attempt - auc_train: 0.8265208167 acc_train: 0.8025262969
y_pred: tensor([0.1570, 0.1435, 0.1204,  ..., 0.1622, 0.2584, 0.1613])
负样本数量： 15717
正样本数量： 6986
TP:  3236
TN:  15216
FP:  501
FN:  3750
y_pred: tensor([0.3762, 0.4185, 0.4361,  ..., 0.9660, 0.9641, 0.9420])
负样本数量： 1849
正样本数量： 943
TP:  470
TN:  1789
FP:  60
FN:  473
First attempt - auc_val: 0.8227549683 acc_val: 0.8127560234
Epoch: 0018 loss_train: 0.4528156221 auc_train: 0.8243548952 acc_train: 0.8019050759 precision_train: 0.8937759498 recall_train: 0.5240554928 f1_train: 0.6606310567 loss_val: 0.4405329823 auc_val: 0.8291612795 acc_val: 0.8109267223 precision_val: 0.8763638475 recall_val: 0.4808107352 f1_val: 0.6208579321 time: 0.3730s
Epoch 0018: val_loss 没有改善 0.440533，最佳值 0.438962，等待 2/15
y_pred: tensor([0.1087, 0.2139, 0.2336,  ..., 0.4582, 0.5640, 0.6687],
       grad_fn=<IndexBackward0>)
负样本数量： 13840
正样本数量： 8245
TP:  4138
TN:  13471
FP:  369
FN:  4107
batch idx: 0, loss: 0.456192 auc: 0.8205, acc: 0.7973, precision: 0.9181, recall: 0.5019, f1: 0.6490, time: 0.091s
y_pred: tensor([0.2656, 0.2738, 0.2766,  ..., 0.8794, 0.9108, 0.9334],
       grad_fn=<IndexBackward0>)
负样本数量： 13835
正样本数量： 8368
TP:  4229
TN:  13527
FP:  308
FN:  4139
batch idx: 1, loss: 0.447373 auc: 0.8332, acc: 0.7997, precision: 0.9321, recall: 0.5054, f1: 0.6554, time: 0.092s
y_pred: tensor([0.1291, 0.1129, 0.1905,  ..., 0.9573, 0.9709, 0.9682],
       grad_fn=<IndexBackward0>)
负样本数量： 12736
正样本数量： 6906
TP:  3415
TN:  12425
FP:  311
FN:  3491
batch idx: 2, loss: 0.448791 auc: 0.8193, acc: 0.8064, precision: 0.9165, recall: 0.4945, f1: 0.6424, time: 0.088s
First attempt - auc_train: 0.8205391076 acc_train: 0.7973285035
y_pred: tensor([0.2509, 0.1378, 0.1810,  ..., 0.9589, 0.9430, 0.9469])
负样本数量： 15520
正样本数量： 7019
TP:  3457
TN:  14922
FP:  598
FN:  3562
y_pred: tensor([0.2343, 0.4091, 0.3881,  ..., 0.2149, 0.2363, 0.2374])
负样本数量： 2046
正样本数量： 910
TP:  441
TN:  1986
FP:  60
FN:  469
First attempt - auc_val: 0.8252224770 acc_val: 0.8154310307
Epoch: 0019 loss_train: 0.4507852892 auc_train: 0.8243542692 acc_train: 0.8011584814 precision_train: 0.9222578545 recall_train: 0.5005850316 f1_train: 0.6489338062 loss_val: 0.4394364357 auc_val: 0.8224503241 acc_val: 0.8182364896 precision_val: 0.8663836322 recall_val: 0.4885678433 f1_val: 0.6247169515 time: 0.3717s
Epoch 0019: val_loss 没有改善 0.439436，最佳值 0.438962，等待 3/15
y_pred: tensor([0.4268, 0.5016, 0.1784,  ..., 0.3531, 0.4278, 0.4746],
       grad_fn=<IndexBackward0>)
负样本数量： 13456
正样本数量： 7967
TP:  4085
TN:  13136
FP:  320
FN:  3882
batch idx: 0, loss: 0.447494 auc: 0.8269, acc: 0.8039, precision: 0.9274, recall: 0.5127, f1: 0.6604, time: 0.089s
y_pred: tensor([0.2165, 0.3018, 0.2883,  ..., 0.8805, 0.9000, 0.9633],
       grad_fn=<IndexBackward0>)
负样本数量： 14194
正样本数量： 7918
TP:  4217
TN:  13513
FP:  681
FN:  3701
batch idx: 1, loss: 0.460319 auc: 0.8162, acc: 0.8018, precision: 0.8610, recall: 0.5326, f1: 0.6581, time: 0.092s
y_pred: tensor([0.2723, 0.4217, 0.4034,  ..., 0.9425, 0.9398, 0.9485],
       grad_fn=<IndexBackward0>)
负样本数量： 12761
正样本数量： 7634
TP:  4099
TN:  12312
FP:  449
FN:  3535
batch idx: 2, loss: 0.445288 auc: 0.8334, acc: 0.8047, precision: 0.9013, recall: 0.5369, f1: 0.6730, time: 0.088s
First attempt - auc_train: 0.8268662801 acc_train: 0.8038556691
y_pred: tensor([0.0964, 0.0872, 0.0841,  ..., 0.2122, 0.2182, 0.3481])
负样本数量： 15621
正样本数量： 6943
TP:  3269
TN:  15087
FP:  534
FN:  3674
y_pred: tensor([0.0871, 0.0987, 0.0851,  ..., 0.1487, 0.3065, 0.1509])
负样本数量： 1945
正样本数量： 986
TP:  490
TN:  1920
FP:  25
FN:  496
First attempt - auc_val: 0.8216822539 acc_val: 0.8135082432
Epoch: 0020 loss_train: 0.4510336220 auc_train: 0.8254827632 acc_train: 0.8034469119 precision_train: 0.8965314075 recall_train: 0.5274213479 f1_train: 0.6638019528 loss_val: 0.4257125407 auc_val: 0.8371962164 acc_val: 0.8178766054 precision_val: 0.9055204246 recall_val: 0.4838956686 f1_val: 0.6306552502 time: 0.3719s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0020: val_loss 改善从 0.425713 到 0.425713
y_pred: tensor([0.2447, 0.1370, 0.1128,  ..., 0.1458, 0.2969, 0.1535],
       grad_fn=<IndexBackward0>)
负样本数量： 14191
正样本数量： 7913
TP:  3950
TN:  13874
FP:  317
FN:  3963
batch idx: 0, loss: 0.444703 auc: 0.8217, acc: 0.8064, precision: 0.9257, recall: 0.4992, f1: 0.6486, time: 0.089s
y_pred: tensor([0.0952, 0.1347, 0.1768,  ..., 0.9542, 0.9576, 0.9618],
       grad_fn=<IndexBackward0>)
负样本数量： 13711
正样本数量： 8268
TP:  4058
TN:  13421
FP:  290
FN:  4210
batch idx: 1, loss: 0.455793 auc: 0.8253, acc: 0.7953, precision: 0.9333, recall: 0.4908, f1: 0.6433, time: 0.091s
y_pred: tensor([0.0972, 0.1614, 0.1765,  ..., 0.9575, 0.9599, 0.9693],
       grad_fn=<IndexBackward0>)
负样本数量： 12509
正样本数量： 7338
TP:  3739
TN:  12192
FP:  317
FN:  3599
batch idx: 2, loss: 0.444543 auc: 0.8325, acc: 0.8027, precision: 0.9218, recall: 0.5095, f1: 0.6563, time: 0.089s
First attempt - auc_train: 0.8217448485 acc_train: 0.8063698878
y_pred: tensor([0.2738, 0.1420, 0.1105,  ..., 0.9160, 0.9100, 0.9564])
负样本数量： 15619
正样本数量： 7002
TP:  3437
TN:  15055
FP:  564
FN:  3565
y_pred: tensor([0.4091, 0.1800, 0.2563,  ..., 0.1108, 0.1211, 0.1005])
负样本数量： 1947
正样本数量： 927
TP:  459
TN:  1878
FP:  69
FN:  468
First attempt - auc_val: 0.8264981008 acc_val: 0.8174704920
Epoch: 0021 loss_train: 0.4483463367 auc_train: 0.8265252837 acc_train: 0.8014398606 precision_train: 0.9269519261 recall_train: 0.4998419617 f1_train: 0.6494082302 loss_val: 0.4386874437 auc_val: 0.8281428737 acc_val: 0.8153114464 precision_val: 0.8641767115 recall_val: 0.4930026927 f1_val: 0.6278332713 time: 0.3712s
Epoch 0021: val_loss 没有改善 0.438687，最佳值 0.425713，等待 1/15
y_pred: tensor([0.1026, 0.0843, 0.0895,  ..., 0.5537, 0.1563, 0.1226],
       grad_fn=<IndexBackward0>)
负样本数量： 14359
正样本数量： 7930
TP:  4088
TN:  13949
FP:  410
FN:  3842
batch idx: 0, loss: 0.442265 auc: 0.8255, acc: 0.8092, precision: 0.9088, recall: 0.5155, f1: 0.6579, time: 0.092s
y_pred: tensor([0.2587, 0.2960, 0.2632,  ..., 0.9764, 0.9686, 0.9678],
       grad_fn=<IndexBackward0>)
负样本数量： 13733
正样本数量： 8146
TP:  4308
TN:  13246
FP:  487
FN:  3838
batch idx: 1, loss: 0.452605 auc: 0.8234, acc: 0.8023, precision: 0.8984, recall: 0.5288, f1: 0.6658, time: 0.096s
y_pred: tensor([0.1063, 0.1923, 0.1368,  ..., 0.9476, 0.9712, 0.9417],
       grad_fn=<IndexBackward0>)
负样本数量： 12319
正样本数量： 7443
TP:  3938
TN:  11961
FP:  358
FN:  3505
batch idx: 2, loss: 0.442976 auc: 0.8348, acc: 0.8045, precision: 0.9167, recall: 0.5291, f1: 0.6709, time: 0.091s
First attempt - auc_train: 0.8254552444 acc_train: 0.8092332541
y_pred: tensor([0.2468, 0.2525, 0.1504,  ..., 0.9548, 0.9621, 0.9712])
负样本数量： 15698
正样本数量： 7059
TP:  3477
TN:  15180
FP:  518
FN:  3582
y_pred: tensor([0.2746, 0.1420, 0.1110,  ..., 0.5129, 0.7926, 0.8781])
负样本数量： 1868
正样本数量： 870
TP:  413
TN:  1775
FP:  93
FN:  457
First attempt - auc_val: 0.8284165860 acc_val: 0.8198356550
Epoch: 0022 loss_train: 0.4459488690 auc_train: 0.8279124914 acc_train: 0.8053596496 precision_train: 0.9079836381 recall_train: 0.5244823223 f1_train: 0.6648620659 loss_val: 0.4520654231 auc_val: 0.8222971889 acc_val: 0.8094795514 precision_val: 0.8432717280 recall_val: 0.4836376648 f1_val: 0.6146921192 time: 0.3816s
Epoch 0022: val_loss 没有改善 0.452065，最佳值 0.425713，等待 2/15
y_pred: tensor([0.2605, 0.2607, 0.2540,  ..., 0.9645, 0.9730, 0.9662],
       grad_fn=<IndexBackward0>)
负样本数量： 13963
正样本数量： 7978
TP:  4121
TN:  13541
FP:  422
FN:  3857
batch idx: 0, loss: 0.447605 auc: 0.8264, acc: 0.8050, precision: 0.9071, recall: 0.5165, f1: 0.6583, time: 0.087s
y_pred: tensor([0.1421, 0.1481, 0.1407,  ..., 0.8417, 0.9097, 0.8945],
       grad_fn=<IndexBackward0>)
负样本数量： 13415
正样本数量： 8364
TP:  4407
TN:  13063
FP:  352
FN:  3957
batch idx: 1, loss: 0.444220 auc: 0.8326, acc: 0.8021, precision: 0.9260, recall: 0.5269, f1: 0.6716, time: 0.093s
y_pred: tensor([0.3577, 0.3743, 0.4108,  ..., 0.9289, 0.9519, 0.9515],
       grad_fn=<IndexBackward0>)
负样本数量： 13033
正样本数量： 7177
TP:  3545
TN:  12778
FP:  255
FN:  3632
batch idx: 2, loss: 0.440234 auc: 0.8262, acc: 0.8077, precision: 0.9329, recall: 0.4939, f1: 0.6459, time: 0.092s
First attempt - auc_train: 0.8264287837 acc_train: 0.8049769837
y_pred: tensor([0.3763, 0.3956, 0.4174,  ..., 0.1528, 0.2397, 0.2137])
负样本数量： 15597
正样本数量： 7033
TP:  3353
TN:  15121
FP:  476
FN:  3680
y_pred: tensor([0.2441, 0.2519, 0.1273,  ..., 0.1500, 0.2471, 0.3163])
负样本数量： 1969
正样本数量： 896
TP:  444
TN:  1889
FP:  80
FN:  452
First attempt - auc_val: 0.8292011954 acc_val: 0.8163499779
Epoch: 0023 loss_train: 0.4440195461 auc_train: 0.8284150850 acc_train: 0.8049317711 precision_train: 0.9220131525 recall_train: 0.5124618254 f1_train: 0.6585984335 loss_val: 0.4409694821 auc_val: 0.8234803658 acc_val: 0.8153303118 precision_val: 0.8615069009 recall_val: 0.4861440835 f1_val: 0.6213669052 time: 0.3745s
Epoch 0023: val_loss 没有改善 0.440969，最佳值 0.425713，等待 3/15
y_pred: tensor([0.2842, 0.2538, 0.1560,  ..., 0.1308, 0.1126, 0.1174],
       grad_fn=<IndexBackward0>)
负样本数量： 14134
正样本数量： 7784
TP:  3897
TN:  13789
FP:  345
FN:  3887
batch idx: 0, loss: 0.443470 auc: 0.8217, acc: 0.8069, precision: 0.9187, recall: 0.5006, f1: 0.6481, time: 0.091s
y_pred: tensor([0.3636, 0.1430, 0.2141,  ..., 0.9638, 0.9645, 0.9770],
       grad_fn=<IndexBackward0>)
负样本数量： 13481
正样本数量： 8400
TP:  4421
TN:  13124
FP:  357
FN:  3979
batch idx: 1, loss: 0.443547 auc: 0.8361, acc: 0.8018, precision: 0.9253, recall: 0.5263, f1: 0.6710, time: 0.089s
y_pred: tensor([0.0969, 0.0831, 0.0844,  ..., 0.1503, 0.2233, 0.2233],
       grad_fn=<IndexBackward0>)
负样本数量： 12796
正样本数量： 7335
TP:  3803
TN:  12441
FP:  355
FN:  3532
batch idx: 2, loss: 0.442233 auc: 0.8275, acc: 0.8069, precision: 0.9146, recall: 0.5185, f1: 0.6618, time: 0.088s
First attempt - auc_train: 0.8217009970 acc_train: 0.8069166895
y_pred: tensor([0.4581, 0.4777, 0.5004,  ..., 0.4589, 0.6415, 0.8278])
负样本数量： 15745
正样本数量： 7003
TP:  3512
TN:  15153
FP:  592
FN:  3491
y_pred: tensor([0.4184, 0.1830, 0.2554,  ..., 0.3836, 0.1762, 0.4916])
负样本数量： 1821
正样本数量： 926
TP:  439
TN:  1782
FP:  39
FN:  487
First attempt - auc_val: 0.8251030509 acc_val: 0.8205116933
Epoch: 0024 loss_train: 0.4430834552 auc_train: 0.8284499579 acc_train: 0.8052228695 precision_train: 0.9195251327 recall_train: 0.5151416471 f1_train: 0.6602855636 loss_val: 0.4315751642 auc_val: 0.8392360068 acc_val: 0.8145150385 precision_val: 0.8870802646 recall_val: 0.4877907154 f1_val: 0.6288750556 time: 0.3704s
Epoch 0024: val_loss 没有改善 0.431575，最佳值 0.425713，等待 4/15
y_pred: tensor([0.2786, 0.1415, 0.1986,  ..., 0.9430, 0.9732, 0.9725],
       grad_fn=<IndexBackward0>)
负样本数量： 13848
正样本数量： 7959
TP:  4214
TN:  13362
FP:  486
FN:  3745
batch idx: 0, loss: 0.446784 auc: 0.8265, acc: 0.8060, precision: 0.8966, recall: 0.5295, f1: 0.6658, time: 0.089s
y_pred: tensor([0.4258, 0.2881, 0.2787,  ..., 0.9242, 0.9412, 0.9492],
       grad_fn=<IndexBackward0>)
负样本数量： 14310
正样本数量： 8017
TP:  4099
TN:  13996
FP:  314
FN:  3918
batch idx: 1, loss: 0.436391 auc: 0.8296, acc: 0.8105, precision: 0.9288, recall: 0.5113, f1: 0.6595, time: 0.091s
y_pred: tensor([0.2852, 0.1462, 0.1240,  ..., 0.7873, 0.7615, 0.8606],
       grad_fn=<IndexBackward0>)
负样本数量： 12253
正样本数量： 7543
TP:  3857
TN:  12026
FP:  227
FN:  3686
batch idx: 2, loss: 0.440880 auc: 0.8340, acc: 0.8023, precision: 0.9444, recall: 0.5113, f1: 0.6635, time: 0.087s
First attempt - auc_train: 0.8265340172 acc_train: 0.8059797313
y_pred: tensor([0.1010, 0.0940, 0.0899,  ..., 0.7630, 0.7284, 0.8204])
负样本数量： 15632
正样本数量： 6970
TP:  3386
TN:  15123
FP:  509
FN:  3584
y_pred: tensor([0.1055, 0.1846, 0.1454,  ..., 0.9592, 0.9773, 0.9632])
负样本数量： 1934
正样本数量： 959
TP:  444
TN:  1892
FP:  42
FN:  515
First attempt - auc_val: 0.8288390973 acc_val: 0.8189098310
Epoch: 0025 loss_train: 0.4413517714 auc_train: 0.8300578576 acc_train: 0.8062557489 precision_train: 0.9232865241 recall_train: 0.5173623416 f1_train: 0.6629201748 loss_val: 0.4342746288 auc_val: 0.8297205451 acc_val: 0.8131880645 precision_val: 0.8914499437 recall_val: 0.4743892715 f1_val: 0.6189093260 time: 0.3694s
Epoch 0025: val_loss 没有改善 0.434275，最佳值 0.425713，等待 5/15
y_pred: tensor([0.3664, 0.4203, 0.1544,  ..., 0.9498, 0.3624, 0.4610],
       grad_fn=<IndexBackward0>)
负样本数量： 13745
正样本数量： 7888
TP:  4033
TN:  13437
FP:  308
FN:  3855
batch idx: 0, loss: 0.440843 auc: 0.8262, acc: 0.8076, precision: 0.9290, recall: 0.5113, f1: 0.6596, time: 0.087s
y_pred: tensor([0.4910, 0.5042, 0.5495,  ..., 0.3765, 0.4715, 0.4851],
       grad_fn=<IndexBackward0>)
负样本数量： 13984
正样本数量： 8350
TP:  4399
TN:  13628
FP:  356
FN:  3951
batch idx: 1, loss: 0.436841 auc: 0.8382, acc: 0.8072, precision: 0.9251, recall: 0.5268, f1: 0.6713, time: 0.091s
y_pred: tensor([0.4234, 0.1931, 0.1769,  ..., 0.9598, 0.9787, 0.9724],
       grad_fn=<IndexBackward0>)
负样本数量： 12682
正样本数量： 7281
TP:  3753
TN:  12352
FP:  330
FN:  3528
batch idx: 2, loss: 0.440351 auc: 0.8284, acc: 0.8067, precision: 0.9192, recall: 0.5155, f1: 0.6605, time: 0.088s
First attempt - auc_train: 0.8261854578 acc_train: 0.8075625202
y_pred: tensor([0.1012, 0.1593, 0.1229,  ..., 0.9749, 0.9735, 0.3829])
负样本数量： 15400
正样本数量： 7129
TP:  3605
TN:  14835
FP:  565
FN:  3524
y_pred: tensor([0.0885, 0.1054, 0.0905,  ..., 0.9038, 0.3806, 0.5723])
负样本数量： 2166
正样本数量： 800
TP:  369
TN:  2113
FP:  53
FN:  431
First attempt - auc_val: 0.8301167948 acc_val: 0.8185005992
Epoch: 0026 loss_train: 0.4393450220 auc_train: 0.8309281589 acc_train: 0.8071533347 precision_train: 0.9244523742 recall_train: 0.5178534944 f1_train: 0.6638111219 loss_val: 0.4257463515 auc_val: 0.8233139664 acc_val: 0.8276589308 precision_val: 0.8694579881 recall_val: 0.4834655106 f1_val: 0.6210187771 time: 0.3685s
Epoch 0026: val_loss 没有改善 0.425746，最佳值 0.425713，等待 6/15
y_pred: tensor([0.4915, 0.4555, 0.4941,  ..., 0.9664, 0.9568, 0.9748],
       grad_fn=<IndexBackward0>)
负样本数量： 13853
正样本数量： 8123
TP:  4253
TN:  13451
FP:  402
FN:  3870
batch idx: 0, loss: 0.447415 auc: 0.8219, acc: 0.8056, precision: 0.9136, recall: 0.5236, f1: 0.6657, time: 0.091s
y_pred: tensor([0.3392, 0.4868, 0.5223,  ..., 0.9786, 0.9777, 0.9805],
       grad_fn=<IndexBackward0>)
负样本数量： 14071
正样本数量： 8038
TP:  4161
TN:  13750
FP:  321
FN:  3877
batch idx: 1, loss: 0.432474 auc: 0.8344, acc: 0.8101, precision: 0.9284, recall: 0.5177, f1: 0.6647, time: 0.093s
y_pred: tensor([0.4697, 0.2682, 0.3972,  ..., 0.9747, 0.9660, 0.9654],
       grad_fn=<IndexBackward0>)
负样本数量： 12487
正样本数量： 7358
TP:  3791
TN:  12216
FP:  271
FN:  3567
batch idx: 2, loss: 0.433332 auc: 0.8398, acc: 0.8066, precision: 0.9333, recall: 0.5152, f1: 0.6639, time: 0.089s
First attempt - auc_train: 0.8219209448 acc_train: 0.8056061158
y_pred: tensor([0.3698, 0.1946, 0.2268,  ..., 0.0760, 0.0759, 0.0755])
负样本数量： 15551
正样本数量： 7015
TP:  3372
TN:  15108
FP:  443
FN:  3643
y_pred: tensor([0.1223, 0.1127, 0.2127,  ..., 0.9013, 0.9223, 0.9317])
负样本数量： 2015
正样本数量： 914
TP:  454
TN:  1943
FP:  72
FN:  460
First attempt - auc_val: 0.8313108324 acc_val: 0.8189311353
Epoch: 0027 loss_train: 0.4377404948 auc_train: 0.8320359582 acc_train: 0.8074432831 precision_train: 0.9251018433 recall_train: 0.5188208825 f1_train: 0.6647649358 loss_val: 0.4348308444 auc_val: 0.8261361651 acc_val: 0.8186495895 precision_val: 0.8734986470 recall_val: 0.4887009862 f1_val: 0.6266351185 time: 0.4343s
Epoch 0027: val_loss 没有改善 0.434831，最佳值 0.425713，等待 7/15
y_pred: tensor([0.2291, 0.3815, 0.3268,  ..., 0.3722, 0.4240, 0.4177],
       grad_fn=<IndexBackward0>)
负样本数量： 13743
正样本数量： 8238
TP:  4245
TN:  13433
FP:  310
FN:  3993
batch idx: 0, loss: 0.437924 auc: 0.8343, acc: 0.8042, precision: 0.9319, recall: 0.5153, f1: 0.6636, time: 0.095s
y_pred: tensor([0.0985, 0.0876, 0.2622,  ..., 0.9720, 0.9833, 0.9764],
       grad_fn=<IndexBackward0>)
负样本数量： 14210
正样本数量： 7804
TP:  4094
TN:  13863
FP:  347
FN:  3710
batch idx: 1, loss: 0.431293 auc: 0.8320, acc: 0.8157, precision: 0.9219, recall: 0.5246, f1: 0.6687, time: 0.097s
y_pred: tensor([0.1297, 0.1109, 0.2859,  ..., 0.7640, 0.8325, 0.9012],
       grad_fn=<IndexBackward0>)
负样本数量： 12458
正样本数量： 7477
TP:  3823
TN:  12220
FP:  238
FN:  3654
batch idx: 2, loss: 0.440199 auc: 0.8317, acc: 0.8048, precision: 0.9414, recall: 0.5113, f1: 0.6627, time: 0.109s
First attempt - auc_train: 0.8342852095 acc_train: 0.8042400255
y_pred: tensor([0.0993, 0.0915, 0.0857,  ..., 0.0975, 0.0946, 0.0910])
负样本数量： 15624
正样本数量： 7078
TP:  3500
TN:  15133
FP:  491
FN:  3578
y_pred: tensor([0.4570, 0.4412, 0.2669,  ..., 0.1546, 0.2653, 0.3404])
负样本数量： 1942
正样本数量： 851
TP:  406
TN:  1874
FP:  68
FN:  445
First attempt - auc_val: 0.8289040338 acc_val: 0.8207646903
Epoch: 0028 loss_train: 0.4364719192 auc_train: 0.8326672294 acc_train: 0.8082378997 precision_train: 0.9317337034 recall_train: 0.5170663555 f1_train: 0.6650017051 loss_val: 0.4278382510 auc_val: 0.8335573040 acc_val: 0.8185456105 precision_val: 0.8667566370 recall_val: 0.4857878752 f1_val: 0.6226134862 time: 0.4181s
Epoch 0028: val_loss 没有改善 0.427838，最佳值 0.425713，等待 8/15
y_pred: tensor([0.0955, 0.0882, 0.0809,  ..., 0.9761, 0.9572, 0.9728],
       grad_fn=<IndexBackward0>)
负样本数量： 13692
正样本数量： 7923
TP:  4155
TN:  13338
FP:  354
FN:  3768
batch idx: 0, loss: 0.433286 auc: 0.8370, acc: 0.8093, precision: 0.9215, recall: 0.5244, f1: 0.6684, time: 0.104s
y_pred: tensor([0.2740, 0.2755, 0.2565,  ..., 0.9751, 0.9632, 0.9742],
       grad_fn=<IndexBackward0>)
负样本数量： 13940
正样本数量： 8131
TP:  4295
TN:  13630
FP:  310
FN:  3836
batch idx: 1, loss: 0.432071 auc: 0.8322, acc: 0.8122, precision: 0.9327, recall: 0.5282, f1: 0.6745, time: 0.112s
y_pred: tensor([0.4563, 0.4181, 0.3094,  ..., 0.1548, 0.1277, 0.1262],
       grad_fn=<IndexBackward0>)
负样本数量： 12779
正样本数量： 7465
TP:  3763
TN:  12546
FP:  233
FN:  3702
batch idx: 2, loss: 0.436704 auc: 0.8325, acc: 0.8056, precision: 0.9417, recall: 0.5041, f1: 0.6567, time: 0.102s
First attempt - auc_train: 0.8370167651 acc_train: 0.8092990978
y_pred: tensor([0.2707, 0.1337, 0.1143,  ..., 0.9820, 0.9820, 0.9662])
负样本数量： 15567
正样本数量： 7057
TP:  3512
TN:  15044
FP:  523
FN:  3545
y_pred: tensor([0.1248, 0.1179, 0.1045,  ..., 0.1556, 0.1645, 0.1629])
负样本数量： 1999
正样本数量： 872
TP:  431
TN:  1953
FP:  46
FN:  441
First attempt - auc_val: 0.8283645067 acc_val: 0.8201909477
Epoch: 0029 loss_train: 0.4340203603 auc_train: 0.8339094954 acc_train: 0.8090240696 precision_train: 0.9319546373 recall_train: 0.5189112037 f1_train: 0.6665213654 loss_val: 0.4225447476 auc_val: 0.8360184582 acc_val: 0.8252818201 precision_val: 0.8869740400 recall_val: 0.4959639755 f1_val: 0.6361205172 time: 0.4293s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0029: val_loss 改善从 0.422545 到 0.422545
y_pred: tensor([0.0934, 0.0894, 0.0747,  ..., 0.3086, 0.3185, 0.3104],
       grad_fn=<IndexBackward0>)
负样本数量： 14137
正样本数量： 7966
TP:  4156
TN:  13795
FP:  342
FN:  3810
batch idx: 0, loss: 0.430631 auc: 0.8346, acc: 0.8122, precision: 0.9240, recall: 0.5217, f1: 0.6669, time: 0.096s
y_pred: tensor([0.2575, 0.1351, 0.1110,  ..., 0.1087, 0.1006, 0.0972],
       grad_fn=<IndexBackward0>)
负样本数量： 14005
正样本数量： 8124
TP:  4209
TN:  13716
FP:  289
FN:  3915
batch idx: 1, loss: 0.429509 auc: 0.8376, acc: 0.8100, precision: 0.9357, recall: 0.5181, f1: 0.6669, time: 0.098s
y_pred: tensor([0.2126, 0.2058, 0.2484,  ..., 0.9718, 0.9778, 0.9731],
       grad_fn=<IndexBackward0>)
负样本数量： 12269
正样本数量： 7429
TP:  3876
TN:  11986
FP:  283
FN:  3553
batch idx: 2, loss: 0.437371 auc: 0.8321, acc: 0.8053, precision: 0.9320, recall: 0.5217, f1: 0.6690, time: 0.094s
First attempt - auc_train: 0.8346189723 acc_train: 0.8121521965
y_pred: tensor([0.0940, 0.0867, 0.0807,  ..., 0.7816, 0.8550, 0.8962])
负样本数量： 15647
正样本数量： 7135
TP:  3516
TN:  15209
FP:  438
FN:  3619
y_pred: tensor([0.0958, 0.0877, 0.0763,  ..., 0.4621, 0.6448, 0.7056])
负样本数量： 1919
正样本数量： 794
TP:  385
TN:  1845
FP:  74
FN:  409
First attempt - auc_val: 0.8305844264 acc_val: 0.8219208147
Epoch: 0030 loss_train: 0.4325037201 auc_train: 0.8347554808 acc_train: 0.8091448868 precision_train: 0.9305567420 recall_train: 0.5205169879 f1_train: 0.6675930899 loss_val: 0.4292450696 auc_val: 0.8293817960 acc_val: 0.8219445577 precision_val: 0.8640030283 recall_val: 0.4888343551 f1_val: 0.6243335411 time: 0.3976s
Epoch 0030: val_loss 没有改善 0.429245，最佳值 0.422545，等待 1/15
y_pred: tensor([0.1257, 0.1172, 0.1328,  ..., 0.4178, 0.1706, 0.2339],
       grad_fn=<IndexBackward0>)
负样本数量： 13903
正样本数量： 7867
TP:  3926
TN:  13663
FP:  240
FN:  3941
batch idx: 0, loss: 0.433359 auc: 0.8336, acc: 0.8079, precision: 0.9424, recall: 0.4990, f1: 0.6525, time: 0.086s
y_pred: tensor([0.0946, 0.0831, 0.0813,  ..., 0.9252, 0.9718, 0.9681],
       grad_fn=<IndexBackward0>)
负样本数量： 13880
正样本数量： 7995
TP:  4268
TN:  13546
FP:  334
FN:  3727
batch idx: 1, loss: 0.426998 auc: 0.8366, acc: 0.8144, precision: 0.9274, recall: 0.5338, f1: 0.6776, time: 0.099s
y_pred: tensor([0.4663, 0.2534, 0.4316,  ..., 0.2587, 0.2816, 0.1905],
       grad_fn=<IndexBackward0>)
负样本数量： 12628
正样本数量： 7657
TP:  4096
TN:  12322
FP:  306
FN:  3561
batch idx: 2, loss: 0.432120 auc: 0.8366, acc: 0.8094, precision: 0.9305, recall: 0.5349, f1: 0.6793, time: 0.099s
First attempt - auc_train: 0.8336494174 acc_train: 0.8079467157
y_pred: tensor([0.0912, 0.1610, 0.1205,  ..., 0.0685, 0.0683, 0.0675])
负样本数量： 15634
正样本数量： 7053
TP:  3479
TN:  15187
FP:  447
FN:  3574
y_pred: tensor([0.2530, 0.2205, 0.2100,  ..., 0.9787, 0.9785, 0.9784])
负样本数量： 1932
正样本数量： 876
TP:  429
TN:  1870
FP:  62
FN:  447
First attempt - auc_val: 0.8307384905 acc_val: 0.8227619341
Epoch: 0031 loss_train: 0.4308259189 auc_train: 0.8356224144 acc_train: 0.8105558428 precision_train: 0.9334332616 recall_train: 0.5226052166 f1_train: 0.6698290505 loss_val: 0.4317738861 auc_val: 0.8285663486 acc_val: 0.8207470639 precision_val: 0.8799353726 recall_val: 0.4914956523 f1_val: 0.6307035717 time: 0.3910s
Epoch 0031: val_loss 没有改善 0.431774，最佳值 0.422545，等待 2/15
y_pred: tensor([0.0960, 0.1707, 0.1396,  ..., 0.9740, 0.9815, 0.9789],
       grad_fn=<IndexBackward0>)
负样本数量： 14056
正样本数量： 7954
TP:  4162
TN:  13780
FP:  276
FN:  3792
batch idx: 0, loss: 0.428192 auc: 0.8317, acc: 0.8152, precision: 0.9378, recall: 0.5233, f1: 0.6717, time: 0.097s
y_pred: tensor([0.3769, 0.3429, 0.3566,  ..., 0.9672, 0.9681, 0.9766],
       grad_fn=<IndexBackward0>)
负样本数量： 13985
正样本数量： 7697
TP:  3842
TN:  13694
FP:  291
FN:  3855
batch idx: 1, loss: 0.430327 auc: 0.8345, acc: 0.8088, precision: 0.9296, recall: 0.4992, f1: 0.6495, time: 0.097s
y_pred: tensor([0.1004, 0.0978, 0.0836,  ..., 0.9800, 0.9767, 0.9765],
       grad_fn=<IndexBackward0>)
负样本数量： 12370
正样本数量： 7868
TP:  4182
TN:  12160
FP:  210
FN:  3686
batch idx: 2, loss: 0.428268 auc: 0.8436, acc: 0.8075, precision: 0.9522, recall: 0.5315, f1: 0.6822, time: 0.095s
First attempt - auc_train: 0.8317380868 acc_train: 0.8151749205
y_pred: tensor([0.0958, 0.0874, 0.0765,  ..., 0.9799, 0.9857, 0.9811])
负样本数量： 15608
正样本数量： 6944
TP:  3451
TN:  15152
FP:  456
FN:  3493
y_pred: tensor([0.0927, 0.0884, 0.0811,  ..., 0.9890, 0.9787, 0.9754])
负样本数量： 1958
正样本数量： 985
TP:  512
TN:  1920
FP:  38
FN:  473
First attempt - auc_val: 0.8282686402 acc_val: 0.8248935793
Epoch: 0032 loss_train: 0.4289290408 auc_train: 0.8365997561 acc_train: 0.8104824190 precision_train: 0.9398622376 recall_train: 0.5179781114 f1_train: 0.6678257900 loss_val: 0.4182167202 auc_val: 0.8422169487 acc_val: 0.8256306157 precision_val: 0.9070977500 recall_val: 0.5083863804 f1_val: 0.6515856927 time: 0.3923s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0032: val_loss 改善从 0.418217 到 0.418217
y_pred: tensor([0.4870, 0.4903, 0.2542,  ..., 0.1978, 0.4805, 0.6782],
       grad_fn=<IndexBackward0>)
负样本数量： 13598
正样本数量： 7918
TP:  4156
TN:  13363
FP:  235
FN:  3762
batch idx: 0, loss: 0.424866 auc: 0.8403, acc: 0.8142, precision: 0.9465, recall: 0.5249, f1: 0.6753, time: 0.094s
y_pred: tensor([0.4577, 0.1827, 0.1479,  ..., 0.2967, 0.1896, 0.1703],
       grad_fn=<IndexBackward0>)
负样本数量： 14033
正样本数量： 7888
TP:  4133
TN:  13637
FP:  396
FN:  3755
batch idx: 1, loss: 0.431278 auc: 0.8324, acc: 0.8106, precision: 0.9126, recall: 0.5240, f1: 0.6657, time: 0.093s
y_pred: tensor([0.3078, 0.1183, 0.1095,  ..., 0.2215, 0.1587, 0.1471],
       grad_fn=<IndexBackward0>)
负样本数量： 12780
正样本数量： 7713
TP:  4103
TN:  12491
FP:  289
FN:  3610
batch idx: 2, loss: 0.429890 auc: 0.8371, acc: 0.8097, precision: 0.9342, recall: 0.5320, f1: 0.6779, time: 0.090s
First attempt - auc_train: 0.8402914790 acc_train: 0.8142312698
y_pred: tensor([0.3405, 0.3301, 0.3391,  ..., 0.9803, 0.9791, 0.9762])
负样本数量： 15454
正样本数量： 7060
TP:  3466
TN:  15030
FP:  424
FN:  3594
y_pred: tensor([0.1152, 0.1915, 0.1522,  ..., 0.0841, 0.0831, 0.1816])
负样本数量： 2112
正样本数量： 869
TP:  400
TN:  2074
FP:  38
FN:  469
First attempt - auc_val: 0.8298875563 acc_val: 0.8215332682
Epoch: 0033 loss_train: 0.4286778569 auc_train: 0.8365975110 acc_train: 0.8115364606 precision_train: 0.9310811540 recall_train: 0.5269331656 f1_train: 0.6729600650 loss_val: 0.4192049056 auc_val: 0.8305919620 acc_val: 0.8257280564 precision_val: 0.9021222899 recall_val: 0.4756170193 f1_val: 0.6225740568 time: 0.3823s
Epoch 0033: val_loss 没有改善 0.419205，最佳值 0.418217，等待 1/15
y_pred: tensor([0.0847, 0.0824, 0.0791,  ..., 0.9830, 0.9874, 0.9841],
       grad_fn=<IndexBackward0>)
负样本数量： 14144
正样本数量： 7866
TP:  3982
TN:  13937
FP:  207
FN:  3884
batch idx: 0, loss: 0.425622 auc: 0.8340, acc: 0.8141, precision: 0.9506, recall: 0.5062, f1: 0.6606, time: 0.092s
y_pred: tensor([0.2341, 0.4272, 0.3804,  ..., 0.9010, 0.9124, 0.9369],
       grad_fn=<IndexBackward0>)
负样本数量： 13853
正样本数量： 8263
TP:  4374
TN:  13588
FP:  265
FN:  3889
batch idx: 1, loss: 0.424207 auc: 0.8415, acc: 0.8122, precision: 0.9429, recall: 0.5293, f1: 0.6780, time: 0.092s
y_pred: tensor([0.0861, 0.1638, 0.1568,  ..., 0.9762, 0.9806, 0.9828],
       grad_fn=<IndexBackward0>)
负样本数量： 12414
正样本数量： 7390
TP:  3805
TN:  12178
FP:  236
FN:  3585
batch idx: 2, loss: 0.431217 auc: 0.8361, acc: 0.8071, precision: 0.9416, recall: 0.5149, f1: 0.6657, time: 0.092s
First attempt - auc_train: 0.8340080028 acc_train: 0.8141299409
y_pred: tensor([0.1212, 0.1074, 0.0956,  ..., 0.9818, 0.9790, 0.9738])
负样本数量： 15621
正样本数量： 7030
TP:  3531
TN:  15187
FP:  434
FN:  3499
y_pred: tensor([0.0923, 0.0818, 0.0753,  ..., 0.9915, 0.9903, 0.9861])
负样本数量： 1945
正样本数量： 899
TP:  452
TN:  1875
FP:  70
FN:  447
First attempt - auc_val: 0.8320066779 acc_val: 0.8263652819
Epoch: 0034 loss_train: 0.4270154734 auc_train: 0.8371969326 acc_train: 0.8111204346 precision_train: 0.9450196997 recall_train: 0.5168206719 f1_train: 0.6681355613 loss_val: 0.4321293384 auc_val: 0.8283420987 acc_val: 0.8222895326 precision_val: 0.8782213139 recall_val: 0.5025284139 f1_val: 0.6392318305 time: 0.3787s
Epoch 0034: val_loss 没有改善 0.432129，最佳值 0.418217，等待 2/15
y_pred: tensor([0.0923, 0.1975, 0.1860,  ..., 0.9813, 0.9843, 0.9834],
       grad_fn=<IndexBackward0>)
负样本数量： 13793
正样本数量： 8061
TP:  4221
TN:  13477
FP:  316
FN:  3840
batch idx: 0, loss: 0.432023 auc: 0.8329, acc: 0.8098, precision: 0.9304, recall: 0.5236, f1: 0.6701, time: 0.090s
y_pred: tensor([0.2456, 0.2542, 0.1257,  ..., 0.9581, 0.9628, 0.9693],
       grad_fn=<IndexBackward0>)
负样本数量： 13566
正样本数量： 8046
TP:  4241
TN:  13299
FP:  267
FN:  3805
batch idx: 1, loss: 0.422597 auc: 0.8454, acc: 0.8116, precision: 0.9408, recall: 0.5271, f1: 0.6756, time: 0.093s
y_pred: tensor([0.2545, 0.1325, 0.1065,  ..., 0.9822, 0.2663, 0.3753],
       grad_fn=<IndexBackward0>)
负样本数量： 13052
正样本数量： 7412
TP:  3918
TN:  12804
FP:  248
FN:  3494
batch idx: 2, loss: 0.423288 auc: 0.8356, acc: 0.8171, precision: 0.9405, recall: 0.5286, f1: 0.6768, time: 0.091s
First attempt - auc_train: 0.8329416046 acc_train: 0.8098288643
y_pred: tensor([0.0881, 0.0791, 0.0731,  ..., 0.0695, 0.0687, 0.0675])
负样本数量： 15431
正样本数量： 7133
TP:  3583
TN:  15009
FP:  422
FN:  3550
y_pred: tensor([0.0852, 0.0799, 0.0712,  ..., 0.2031, 0.1765, 0.4432])
负样本数量： 2135
正样本数量： 796
TP:  358
TN:  2058
FP:  77
FN:  438
First attempt - auc_val: 0.8329081937 acc_val: 0.8239673817
Epoch: 0035 loss_train: 0.4259693821 auc_train: 0.8380073923 acc_train: 0.8128524396 precision_train: 0.9371976294 recall_train: 0.5264429262 f1_train: 0.6741828084 loss_val: 0.4286312610 auc_val: 0.8239603047 acc_val: 0.8241297161 precision_val: 0.8588101081 recall_val: 0.4760309680 f1_val: 0.6125119777 time: 0.3801s
Epoch 0035: val_loss 没有改善 0.428631，最佳值 0.418217，等待 3/15
y_pred: tensor([0.3271, 0.1248, 0.3404,  ..., 0.9863, 0.9736, 0.9785],
       grad_fn=<IndexBackward0>)
负样本数量： 13945
正样本数量： 7726
TP:  3957
TN:  13730
FP:  215
FN:  3769
batch idx: 0, loss: 0.421119 auc: 0.8366, acc: 0.8162, precision: 0.9485, recall: 0.5122, f1: 0.6652, time: 0.089s
y_pred: tensor([0.1252, 0.2277, 0.1066,  ..., 0.9826, 0.9835, 0.9815],
       grad_fn=<IndexBackward0>)
负样本数量： 13455
正样本数量： 8238
TP:  4354
TN:  13180
FP:  275
FN:  3884
batch idx: 1, loss: 0.427803 auc: 0.8426, acc: 0.8083, precision: 0.9406, recall: 0.5285, f1: 0.6768, time: 0.092s
y_pred: tensor([0.1271, 0.1071, 0.1798,  ..., 0.9819, 0.9813, 0.9865],
       grad_fn=<IndexBackward0>)
负样本数量： 13011
正样本数量： 7555
TP:  3913
TN:  12779
FP:  232
FN:  3642
batch idx: 2, loss: 0.426921 auc: 0.8340, acc: 0.8116, precision: 0.9440, recall: 0.5179, f1: 0.6689, time: 0.091s
First attempt - auc_train: 0.8365944128 acc_train: 0.8161598450
y_pred: tensor([0.2682, 0.1229, 0.1026,  ..., 0.9808, 0.9833, 0.9779])
负样本数量： 15729
正样本数量： 7035
TP:  3486
TN:  15315
FP:  414
FN:  3549
y_pred: tensor([0.2420, 0.2123, 0.2122,  ..., 0.0711, 0.0729, 0.0712])
负样本数量： 1837
正样本数量： 894
TP:  466
TN:  1772
FP:  65
FN:  428
First attempt - auc_val: 0.8310128558 acc_val: 0.8259093305
Epoch: 0036 loss_train: 0.4252810975 auc_train: 0.8377299014 acc_train: 0.8120232868 precision_train: 0.9443622782 recall_train: 0.5195427311 f1_train: 0.6702709094 loss_val: 0.4281932414 auc_val: 0.8322979212 acc_val: 0.8226946872 precision_val: 0.8857178039 recall_val: 0.5083875922 f1_val: 0.6458104108 time: 0.3760s
Epoch 0036: val_loss 没有改善 0.428193，最佳值 0.418217，等待 4/15
y_pred: tensor([0.2613, 0.2705, 0.2592,  ..., 0.1599, 0.3031, 0.3825],
       grad_fn=<IndexBackward0>)
负样本数量： 14043
正样本数量： 8219
TP:  4297
TN:  13800
FP:  243
FN:  3922
batch idx: 0, loss: 0.427949 auc: 0.8327, acc: 0.8129, precision: 0.9465, recall: 0.5228, f1: 0.6736, time: 0.090s
y_pred: tensor([0.4498, 0.2547, 0.1447,  ..., 0.1861, 0.1718, 0.3186],
       grad_fn=<IndexBackward0>)
负样本数量： 13725
正样本数量： 7983
TP:  4219
TN:  13458
FP:  267
FN:  3764
batch idx: 1, loss: 0.422298 auc: 0.8413, acc: 0.8143, precision: 0.9405, recall: 0.5285, f1: 0.6767, time: 0.090s
y_pred: tensor([0.4554, 0.2729, 0.1471,  ..., 0.9902, 0.9852, 0.9859],
       grad_fn=<IndexBackward0>)
负样本数量： 12643
正样本数量： 7317
TP:  3896
TN:  12354
FP:  289
FN:  3421
batch idx: 2, loss: 0.421747 auc: 0.8421, acc: 0.8141, precision: 0.9309, recall: 0.5325, f1: 0.6774, time: 0.093s
First attempt - auc_train: 0.8327372551 acc_train: 0.8129098913
y_pred: tensor([0.2601, 0.3782, 0.1900,  ..., 0.0645, 0.0641, 0.0631])
负样本数量： 15367
正样本数量： 7178
TP:  3621
TN:  14960
FP:  407
FN:  3557
y_pred: tensor([0.0859, 0.0761, 0.0668,  ..., 0.1417, 0.3112, 0.3070])
负样本数量： 2199
正样本数量： 751
TP:  337
TN:  2136
FP:  63
FN:  414
First attempt - auc_val: 0.8369679943 acc_val: 0.8241738745
Epoch: 0037 loss_train: 0.4239979883 auc_train: 0.8386872626 acc_train: 0.8137820790 precision_train: 0.9393003720 recall_train: 0.5279232369 f1_train: 0.6759098069 loss_val: 0.4248900861 auc_val: 0.8137435541 acc_val: 0.8312394796 precision_val: 0.8707286495 recall_val: 0.4765965431 f1_val: 0.6159193451 time: 0.3798s
Epoch 0037: val_loss 没有改善 0.424890，最佳值 0.418217，等待 5/15
y_pred: tensor([0.2774, 0.1272, 0.0935,  ..., 0.4862, 0.6194, 0.5978],
       grad_fn=<IndexBackward0>)
负样本数量： 13560
正样本数量： 7904
TP:  4165
TN:  13312
FP:  248
FN:  3739
batch idx: 0, loss: 0.420686 auc: 0.8413, acc: 0.8142, precision: 0.9438, recall: 0.5269, f1: 0.6763, time: 0.086s
y_pred: tensor([0.2688, 0.1218, 0.2908,  ..., 0.9714, 0.9746, 0.9825],
       grad_fn=<IndexBackward0>)
负样本数量： 13858
正样本数量： 8316
TP:  4355
TN:  13660
FP:  198
FN:  3961
batch idx: 1, loss: 0.421955 auc: 0.8424, acc: 0.8124, precision: 0.9565, recall: 0.5237, f1: 0.6768, time: 0.088s
y_pred: tensor([0.3406, 0.3308, 0.1551,  ..., 0.2390, 0.2363, 0.3489],
       grad_fn=<IndexBackward0>)
负样本数量： 12993
正样本数量： 7299
TP:  3772
TN:  12739
FP:  254
FN:  3527
batch idx: 2, loss: 0.426134 auc: 0.8351, acc: 0.8137, precision: 0.9369, recall: 0.5168, f1: 0.6661, time: 0.087s
First attempt - auc_train: 0.8412847001 acc_train: 0.8142471114
y_pred: tensor([0.2568, 0.2285, 0.1289,  ..., 0.1902, 0.1768, 0.1638])
负样本数量： 15429
正样本数量： 7049
TP:  3499
TN:  15031
FP:  398
FN:  3550
y_pred: tensor([0.0892, 0.0788, 0.2178,  ..., 0.1006, 0.0956, 0.0880])
负样本数量： 2137
正样本数量： 880
TP:  460
TN:  2059
FP:  78
FN:  420
First attempt - auc_val: 0.8323639287 acc_val: 0.8243615980
Epoch: 0038 loss_train: 0.4229252736 auc_train: 0.8395980207 acc_train: 0.8134518380 precision_train: 0.9457415587 recall_train: 0.5224735917 f1_train: 0.6730860595 loss_val: 0.4209657162 auc_val: 0.8321980712 acc_val: 0.8296484821 precision_val: 0.8764443719 recall_val: 0.5095548692 f1_val: 0.6440607140 time: 0.3647s
Epoch 0038: val_loss 没有改善 0.420966，最佳值 0.418217，等待 6/15
y_pred: tensor([0.0914, 0.0815, 0.0767,  ..., 0.3018, 0.3167, 0.3487],
       grad_fn=<IndexBackward0>)
负样本数量： 13944
正样本数量： 7959
TP:  4126
TN:  13709
FP:  235
FN:  3833
batch idx: 0, loss: 0.418676 auc: 0.8432, acc: 0.8143, precision: 0.9461, recall: 0.5184, f1: 0.6698, time: 0.089s
y_pred: tensor([0.4584, 0.1707, 0.2905,  ..., 0.1886, 0.2509, 0.1392],
       grad_fn=<IndexBackward0>)
负样本数量： 13687
正样本数量： 8344
TP:  4491
TN:  13432
FP:  255
FN:  3853
batch idx: 1, loss: 0.424496 auc: 0.8385, acc: 0.8135, precision: 0.9463, recall: 0.5382, f1: 0.6862, time: 0.091s
y_pred: tensor([0.4233, 0.1411, 0.1194,  ..., 0.5997, 0.7217, 0.7906],
       grad_fn=<IndexBackward0>)
负样本数量： 12780
正样本数量： 7216
TP:  3785
TN:  12518
FP:  262
FN:  3431
batch idx: 2, loss: 0.421324 auc: 0.8393, acc: 0.8153, precision: 0.9353, recall: 0.5245, f1: 0.6721, time: 0.089s
First attempt - auc_train: 0.8431757246 acc_train: 0.8142720175
y_pred: tensor([0.1177, 0.1020, 0.0950,  ..., 0.1689, 0.2602, 0.1787])
负样本数量： 15285
正样本数量： 7181
TP:  3635
TN:  14868
FP:  417
FN:  3546
y_pred: tensor([0.3083, 0.2994, 0.2818,  ..., 0.5011, 0.1868, 0.3509])
负样本数量： 2281
正样本数量： 748
TP:  339
TN:  2219
FP:  62
FN:  409
First attempt - auc_val: 0.8341409155 acc_val: 0.8236001068
Epoch: 0039 loss_train: 0.4214985768 auc_train: 0.8403334750 acc_train: 0.8143735176 precision_train: 0.9425481691 recall_train: 0.5270555747 f1_train: 0.6760300239 loss_val: 0.4169276953 auc_val: 0.8230686537 acc_val: 0.8340516216 precision_val: 0.8712371958 recall_val: 0.4797027323 f1_val: 0.6186392713 time: 0.3716s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0039: val_loss 改善从 0.416928 到 0.416928
y_pred: tensor([0.3501, 0.3191, 0.2383,  ..., 0.9879, 0.9749, 0.9849],
       grad_fn=<IndexBackward0>)
负样本数量： 14166
正样本数量： 8179
TP:  4313
TN:  13899
FP:  267
FN:  3866
batch idx: 0, loss: 0.420534 auc: 0.8410, acc: 0.8150, precision: 0.9417, recall: 0.5273, f1: 0.6761, time: 0.093s
y_pred: tensor([0.0839, 0.0859, 0.0681,  ..., 0.9826, 0.9898, 0.9873],
       grad_fn=<IndexBackward0>)
负样本数量： 13726
正样本数量： 8157
TP:  4313
TN:  13496
FP:  230
FN:  3844
batch idx: 1, loss: 0.419823 auc: 0.8428, acc: 0.8138, precision: 0.9494, recall: 0.5287, f1: 0.6792, time: 0.092s
y_pred: tensor([0.3457, 0.3569, 0.3418,  ..., 0.9845, 0.9846, 0.9816],
       grad_fn=<IndexBackward0>)
负样本数量： 12519
正样本数量： 7183
TP:  3710
TN:  12325
FP:  194
FN:  3473
batch idx: 2, loss: 0.424648 auc: 0.8348, acc: 0.8139, precision: 0.9503, recall: 0.5165, f1: 0.6693, time: 0.090s
First attempt - auc_train: 0.8409680705 acc_train: 0.8150369210
y_pred: tensor([0.4586, 0.4320, 0.4243,  ..., 0.3708, 0.5586, 0.6397])
负样本数量： 15645
正样本数量： 7012
TP:  3500
TN:  15239
FP:  406
FN:  3512
y_pred: tensor([0.2400, 0.2165, 0.1949,  ..., 0.9727, 0.9736, 0.9745])
负样本数量： 1921
正样本数量： 917
TP:  459
TN:  1863
FP:  58
FN:  458
First attempt - auc_val: 0.8315107854 acc_val: 0.8270733107
Epoch: 0040 loss_train: 0.4216683904 auc_train: 0.8395453184 acc_train: 0.8142472568 precision_train: 0.9471276984 recall_train: 0.5241905595 f1_train: 0.6748455561 loss_val: 0.4242249131 auc_val: 0.8349332848 acc_val: 0.8226275644 precision_val: 0.8919358305 recall_val: 0.4998447901 f1_val: 0.6406552153 time: 0.3766s
Epoch 0040: val_loss 没有改善 0.424225，最佳值 0.416928，等待 1/15
y_pred: tensor([0.2633, 0.1239, 0.2504,  ..., 0.9649, 0.9797, 0.9830],
       grad_fn=<IndexBackward0>)
负样本数量： 13602
正样本数量： 8256
TP:  4414
TN:  13344
FP:  258
FN:  3842
batch idx: 0, loss: 0.423032 auc: 0.8414, acc: 0.8124, precision: 0.9448, recall: 0.5346, f1: 0.6829, time: 0.091s
y_pred: tensor([0.2613, 0.1241, 0.1035,  ..., 0.3575, 0.3494, 0.4030],
       grad_fn=<IndexBackward0>)
负样本数量： 13856
正样本数量： 7862
TP:  4115
TN:  13612
FP:  244
FN:  3747
batch idx: 1, loss: 0.417819 auc: 0.8412, acc: 0.8162, precision: 0.9440, recall: 0.5234, f1: 0.6734, time: 0.094s
y_pred: tensor([0.4689, 0.4298, 0.4220,  ..., 0.9889, 0.9796, 0.9827],
       grad_fn=<IndexBackward0>)
负样本数量： 12953
正样本数量： 7401
TP:  3864
TN:  12734
FP:  219
FN:  3537
batch idx: 2, loss: 0.420599 auc: 0.8387, acc: 0.8155, precision: 0.9464, recall: 0.5221, f1: 0.6729, time: 0.089s
First attempt - auc_train: 0.8413648842 acc_train: 0.8124256565
y_pred: tensor([0.0810, 0.0723, 0.0662,  ..., 0.2744, 0.2369, 0.2030])
负样本数量： 15531
正样本数量： 6984
TP:  3457
TN:  15131
FP:  400
FN:  3527
y_pred: tensor([0.1212, 0.2498, 0.2570,  ..., 0.9739, 0.9829, 0.9829])
负样本数量： 2035
正样本数量： 945
TP:  471
TN:  1987
FP:  48
FN:  474
First attempt - auc_val: 0.8306716160 acc_val: 0.8255829447
Epoch: 0041 loss_train: 0.4204831918 auc_train: 0.8404217531 acc_train: 0.8147090949 precision_train: 0.9450547414 recall_train: 0.5267122654 f1_train: 0.6764087165 loss_val: 0.4177543819 auc_val: 0.8364565391 acc_val: 0.8252075797 precision_val: 0.9019034531 recall_val: 0.4967006218 f1_val: 0.6406033334 time: 0.3737s
Epoch 0041: val_loss 没有改善 0.417754，最佳值 0.416928，等待 2/15
y_pred: tensor([0.0848, 0.0820, 0.0682,  ..., 0.2004, 0.1919, 0.2404],
       grad_fn=<IndexBackward0>)
负样本数量： 14058
正样本数量： 7550
TP:  3936
TN:  13868
FP:  190
FN:  3614
batch idx: 0, loss: 0.408785 auc: 0.8438, acc: 0.8240, precision: 0.9540, recall: 0.5213, f1: 0.6742, time: 0.090s
y_pred: tensor([0.4289, 0.4245, 0.4159,  ..., 0.2345, 0.5258, 0.6465],
       grad_fn=<IndexBackward0>)
负样本数量： 13745
正样本数量： 8331
TP:  4410
TN:  13514
FP:  231
FN:  3921
batch idx: 1, loss: 0.422911 auc: 0.8410, acc: 0.8119, precision: 0.9502, recall: 0.5293, f1: 0.6799, time: 0.095s
y_pred: tensor([0.2731, 0.4119, 0.3036,  ..., 0.9739, 0.9858, 0.9823],
       grad_fn=<IndexBackward0>)
负样本数量： 12608
正样本数量： 7638
TP:  3969
TN:  12400
FP:  208
FN:  3669
batch idx: 2, loss: 0.426932 auc: 0.8381, acc: 0.8085, precision: 0.9502, recall: 0.5196, f1: 0.6719, time: 0.092s
First attempt - auc_train: 0.8438059826 acc_train: 0.8239540911
y_pred: tensor([0.0825, 0.0733, 0.2106,  ..., 0.9866, 0.9904, 0.9868])
负样本数量： 15510
正样本数量： 7078
TP:  3630
TN:  15043
FP:  467
FN:  3448
y_pred: tensor([0.2757, 0.1213, 0.0954,  ..., 0.9869, 0.9808, 0.9909])
负样本数量： 2056
正样本数量： 851
TP:  401
TN:  2002
FP:  54
FN:  450
First attempt - auc_val: 0.8323138059 acc_val: 0.8266778821
Epoch: 0042 loss_train: 0.4195427398 auc_train: 0.8409833692 acc_train: 0.8147939749 precision_train: 0.9514600990 recall_train: 0.5234371232 f1_train: 0.6753290989 loss_val: 0.4249570817 auc_val: 0.8283713611 acc_val: 0.8266516345 precision_val: 0.8836664190 recall_val: 0.4920335400 f1_val: 0.6318766252 time: 0.3768s
Epoch 0042: val_loss 没有改善 0.424957，最佳值 0.416928，等待 3/15
y_pred: tensor([0.2833, 0.1227, 0.2397,  ..., 0.9764, 0.9901, 0.9874],
       grad_fn=<IndexBackward0>)
负样本数量： 14016
正样本数量： 7845
TP:  4130
TN:  13701
FP:  315
FN:  3715
batch idx: 0, loss: 0.419242 auc: 0.8402, acc: 0.8157, precision: 0.9291, recall: 0.5264, f1: 0.6721, time: 0.087s
y_pred: tensor([0.1268, 0.1085, 0.1051,  ..., 0.2498, 0.2232, 0.2276],
       grad_fn=<IndexBackward0>)
负样本数量： 13708
正样本数量： 8057
TP:  4286
TN:  13427
FP:  281
FN:  3771
batch idx: 1, loss: 0.421537 auc: 0.8392, acc: 0.8138, precision: 0.9385, recall: 0.5320, f1: 0.6790, time: 0.090s
y_pred: tensor([0.0800, 0.1922, 0.3500,  ..., 0.0808, 0.1920, 0.2483],
       grad_fn=<IndexBackward0>)
负样本数量： 12687
正样本数量： 7617
TP:  4116
TN:  12468
FP:  219
FN:  3501
batch idx: 2, loss: 0.415203 auc: 0.8459, acc: 0.8168, precision: 0.9495, recall: 0.5404, f1: 0.6888, time: 0.088s
First attempt - auc_train: 0.8401647093 acc_train: 0.8156534468
y_pred: tensor([0.4586, 0.4260, 0.2337,  ..., 0.9870, 0.9909, 0.9827])
负样本数量： 15535
正样本数量： 7114
TP:  3525
TN:  15171
FP:  364
FN:  3589
y_pred: tensor([0.2706, 0.2329, 0.1998,  ..., 0.9806, 0.9881, 0.9769])
负样本数量： 2031
正样本数量： 815
TP:  373
TN:  1976
FP:  55
FN:  442
First attempt - auc_val: 0.8325905012 acc_val: 0.8254669080
Epoch: 0043 loss_train: 0.4186606805 auc_train: 0.8417315381 acc_train: 0.8154226199 precision_train: 0.9390288238 recall_train: 0.5329266597 f1_train: 0.6799567441 loss_val: 0.4218572974 auc_val: 0.8276315019 acc_val: 0.8254179234 precision_val: 0.8889490007 recall_val: 0.4765852695 f1_val: 0.6204476231 time: 0.3667s
Epoch 0043: val_loss 没有改善 0.421857，最佳值 0.416928，等待 4/15
y_pred: tensor([0.2625, 0.1161, 0.1994,  ..., 0.3537, 0.3778, 0.4134],
       grad_fn=<IndexBackward0>)
负样本数量： 13922
正样本数量： 8262
TP:  4345
TN:  13756
FP:  166
FN:  3917
batch idx: 0, loss: 0.417244 auc: 0.8426, acc: 0.8159, precision: 0.9632, recall: 0.5259, f1: 0.6803, time: 0.089s
y_pred: tensor([0.2592, 0.2528, 0.1215,  ..., 0.9751, 0.9834, 0.9891],
       grad_fn=<IndexBackward0>)
负样本数量： 13795
正样本数量： 7922
TP:  4132
TN:  13582
FP:  213
FN:  3790
batch idx: 1, loss: 0.417069 auc: 0.8416, acc: 0.8157, precision: 0.9510, recall: 0.5216, f1: 0.6737, time: 0.091s
y_pred: tensor([0.4782, 0.2560, 0.1284,  ..., 0.9873, 0.9859, 0.9838],
       grad_fn=<IndexBackward0>)
负样本数量： 12694
正样本数量： 7335
TP:  3872
TN:  12442
FP:  252
FN:  3463
batch idx: 2, loss: 0.418557 auc: 0.8422, acc: 0.8145, precision: 0.9389, recall: 0.5279, f1: 0.6758, time: 0.090s
First attempt - auc_train: 0.8426395351 acc_train: 0.8159484313
y_pred: tensor([0.1193, 0.2122, 0.1753,  ..., 0.9873, 0.9829, 0.9846])
负样本数量： 15605
正样本数量： 7048
TP:  3528
TN:  15178
FP:  427
FN:  3520
y_pred: tensor([0.2574, 0.2219, 0.2025,  ..., 0.2045, 0.5362, 0.7664])
负样本数量： 1961
正样本数量： 881
TP:  469
TN:  1921
FP:  40
FN:  412
First attempt - auc_val: 0.8297807255 acc_val: 0.8257625922
Epoch: 0044 loss_train: 0.4176232517 auc_train: 0.8421465557 acc_train: 0.8153805784 precision_train: 0.9510244924 recall_train: 0.5251224014 f1_train: 0.6766064571 loss_val: 0.4094250500 auc_val: 0.8397355707 acc_val: 0.8333598323 precision_val: 0.9067249683 recall_val: 0.5164585698 f1_val: 0.6580498974 time: 0.3719s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-54-40//checkpoints/best_model.pt
Epoch 0044: val_loss 改善从 0.409425 到 0.409425
y_pred: tensor([0.3748, 0.2916, 0.4497,  ..., 0.9876, 0.9868, 0.9736],
       grad_fn=<IndexBackward0>)
负样本数量： 14230
正样本数量： 7926
TP:  4204
TN:  13975
FP:  255
FN:  3722
batch idx: 0, loss: 0.411656 auc: 0.8444, acc: 0.8205, precision: 0.9428, recall: 0.5304, f1: 0.6789, time: 0.090s
y_pred: tensor([0.4697, 0.4341, 0.2337,  ..., 0.9090, 0.9475, 0.9602],
       grad_fn=<IndexBackward0>)
负样本数量： 13721
正样本数量： 8335
TP:  4423
TN:  13539
FP:  182
FN:  3912
batch idx: 1, loss: 0.415239 auc: 0.8480, acc: 0.8144, precision: 0.9605, recall: 0.5307, f1: 0.6836, time: 0.095s
y_pred: tensor([0.1310, 0.1071, 0.0937,  ..., 0.9868, 0.9883, 0.9862],
       grad_fn=<IndexBackward0>)
负样本数量： 12460
正样本数量： 7258
TP:  3829
TN:  12218
FP:  242
FN:  3429
batch idx: 2, loss: 0.423129 auc: 0.8358, acc: 0.8138, precision: 0.9406, recall: 0.5276, f1: 0.6760, time: 0.091s
First attempt - auc_train: 0.8444065929 acc_train: 0.8205000903
y_pred: tensor([0.3857, 0.3373, 0.3197,  ..., 0.3156, 0.3552, 0.4018])
负样本数量： 15557
正样本数量： 7048
TP:  3532
TN:  15195
FP:  362
FN:  3516
y_pred: tensor([0.3969, 0.2124, 0.3509,  ..., 0.9912, 0.9913, 0.9911])
负样本数量： 2009
正样本数量： 881
TP:  435
TN:  1925
FP:  84
FN:  446
First attempt - auc_val: 0.8310431379 acc_val: 0.8284450343
Epoch: 0045 loss_train: 0.4166748126 auc_train: 0.8427121217 acc_train: 0.8162355320 precision_train: 0.9479483925 recall_train: 0.5295386425 f1_train: 0.6794889269 loss_val: 0.4311794341 auc_val: 0.8325168269 acc_val: 0.8225270154 precision_val: 0.8725933777 recall_val: 0.4974460840 f1_val: 0.6335071938 time: 0.3786s
Epoch 0045: val_loss 没有改善 0.431179，最佳值 0.409425，等待 1/15
y_pred: tensor([0.4510, 0.2467, 0.1401,  ..., 0.9890, 0.9837, 0.9845],
       grad_fn=<IndexBackward0>)
负样本数量： 13587
正样本数量： 8069
TP:  4352
TN:  13402
FP:  185
FN:  3717
batch idx: 0, loss: 0.408514 auc: 0.8508, acc: 0.8198, precision: 0.9592, recall: 0.5393, f1: 0.6905, time: 0.092s
y_pred: tensor([0.0801, 0.0769, 0.0592,  ..., 0.9840, 0.9801, 0.9908],
       grad_fn=<IndexBackward0>)
负样本数量： 13905
正样本数量： 8107
TP:  4243
TN:  13670
FP:  235
FN:  3864
batch idx: 1, loss: 0.421022 auc: 0.8389, acc: 0.8138, precision: 0.9475, recall: 0.5234, f1: 0.6743, time: 0.095s
y_pred: tensor([0.3676, 0.0952, 0.0829,  ..., 0.9874, 0.9918, 0.9838],
       grad_fn=<IndexBackward0>)
负样本数量： 12919
正样本数量： 7343
TP:  3883
TN:  12665
FP:  254
FN:  3460
batch idx: 2, loss: 0.417583 auc: 0.8407, acc: 0.8167, precision: 0.9386, recall: 0.5288, f1: 0.6765, time: 0.091s
First attempt - auc_train: 0.8507588232 acc_train: 0.8198189878
y_pred: tensor([0.0781, 0.0693, 0.0631,  ..., 0.2195, 0.1225, 0.2798])
负样本数量： 15714
正样本数量： 6904
TP:  3412
TN:  15318
FP:  396
FN:  3492
y_pred: tensor([0.0663, 0.0653, 0.0599,  ..., 0.6899, 0.7826, 0.8578])
负样本数量： 1852
正样本数量： 1025
TP:  529
TN:  1826
FP:  26
FN:  496
First attempt - auc_val: 0.8291458849 acc_val: 0.8281015121
Epoch: 0046 loss_train: 0.4157062074 auc_train: 0.8434667830 acc_train: 0.8167678643 precision_train: 0.9484494080 recall_train: 0.5305086418 f1_train: 0.6804134965 loss_val: 0.4164990783 auc_val: 0.8376520132 acc_val: 0.8233312566 precision_val: 0.9245807783 recall_val: 0.5051519091 f1_val: 0.6533314111 time: 0.3809s
Epoch 0046: val_loss 没有改善 0.416499，最佳值 0.409425，等待 2/15
y_pred: tensor([0.0821, 0.0745, 0.0666,  ..., 0.7987, 0.8805, 0.9627],
       grad_fn=<IndexBackward0>)
负样本数量： 13201
正样本数量： 8591
TP:  4652
TN:  12969
FP:  232
FN:  3939
batch idx: 0, loss: 0.421129 auc: 0.8479, acc: 0.8086, precision: 0.9525, recall: 0.5415, f1: 0.6905, time: 0.093s
y_pred: tensor([0.2637, 0.1070, 0.0807,  ..., 0.9725, 0.9852, 0.9882],
       grad_fn=<IndexBackward0>)
负样本数量： 14306
正样本数量： 7650
TP:  3904
TN:  14128
FP:  178
FN:  3746
batch idx: 1, loss: 0.412783 auc: 0.8374, acc: 0.8213, precision: 0.9564, recall: 0.5103, f1: 0.6655, time: 0.093s
y_pred: tensor([0.3519, 0.0993, 0.2099,  ..., 0.9873, 0.9868, 0.9909],
       grad_fn=<IndexBackward0>)
负样本数量： 12904
正样本数量： 7278
TP:  3828
TN:  12722
FP:  182
FN:  3450
batch idx: 2, loss: 0.409644 auc: 0.8457, acc: 0.8200, precision: 0.9546, recall: 0.5260, f1: 0.6782, time: 0.089s
First attempt - auc_train: 0.8479250879 acc_train: 0.8085994860
y_pred: tensor([0.2789, 0.1100, 0.2044,  ..., 0.9898, 0.9852, 0.9873])
负样本数量： 15549
正样本数量： 7043
TP:  3493
TN:  15185
FP:  364
FN:  3550
y_pred: tensor([0.3193, 0.2771, 0.1133,  ..., 0.0756, 0.0783, 0.0782])
负样本数量： 2017
正样本数量： 886
TP:  489
TN:  1952
FP:  65
FN:  397
First attempt - auc_val: 0.8286119982 acc_val: 0.8267528329
Epoch: 0047 loss_train: 0.4145185749 auc_train: 0.8436605000 acc_train: 0.8166386883 precision_train: 0.9545017811 recall_train: 0.5259307952 f1_train: 0.6780787924 loss_val: 0.4116814882 auc_val: 0.8400426271 acc_val: 0.8338035608 precision_val: 0.8941488072 recall_val: 0.5239360824 f1_val: 0.6600420489 time: 0.3778s
Epoch 0047: val_loss 没有改善 0.411681，最佳值 0.409425，等待 3/15
y_pred: tensor([0.0735, 0.0744, 0.0638,  ..., 0.9814, 0.9883, 0.9923],
       grad_fn=<IndexBackward0>)
负样本数量： 13787
正样本数量： 8219
TP:  4438
TN:  13561
FP:  226
FN:  3781
batch idx: 0, loss: 0.411543 auc: 0.8471, acc: 0.8179, precision: 0.9515, recall: 0.5400, f1: 0.6890, time: 0.090s
y_pred: tensor([0.4679, 0.2293, 0.1311,  ..., 0.9678, 0.9619, 0.9800],
       grad_fn=<IndexBackward0>)
负样本数量： 14151
正样本数量： 7972
TP:  4169
TN:  13968
FP:  183
FN:  3803
batch idx: 1, loss: 0.412334 auc: 0.8436, acc: 0.8198, precision: 0.9580, recall: 0.5230, f1: 0.6766, time: 0.090s
y_pred: tensor([0.1149, 0.1565, 0.0960,  ..., 0.9888, 0.9821, 0.9854],
       grad_fn=<IndexBackward0>)
负样本数量： 12473
正样本数量： 7328
TP:  3841
TN:  12276
FP:  197
FN:  3487
batch idx: 2, loss: 0.416967 auc: 0.8434, acc: 0.8139, precision: 0.9512, recall: 0.5242, f1: 0.6759, time: 0.089s
First attempt - auc_train: 0.8471320960 acc_train: 0.8179132964
y_pred: tensor([0.0769, 0.0686, 0.0599,  ..., 0.8350, 0.9303, 0.9566])
负样本数量： 15430
正样本数量： 7027
TP:  3543
TN:  15042
FP:  388
FN:  3484
y_pred: tensor([0.2242, 0.1784, 0.1755,  ..., 0.1355, 0.1678, 0.1817])
负样本数量： 2136
正样本数量： 902
TP:  440
TN:  2098
FP:  38
FN:  462
First attempt - auc_val: 0.8302721260 acc_val: 0.8275816004
Epoch: 0048 loss_train: 0.4136150082 auc_train: 0.8446952269 acc_train: 0.8172292026 precision_train: 0.9535691930 recall_train: 0.5290258799 f1_train: 0.6804704761 loss_val: 0.4145226181 auc_val: 0.8326506944 acc_val: 0.8314998193 precision_val: 0.9108997359 recall_val: 0.4960014856 f1_val: 0.6421660041 time: 0.3709s
Epoch 0048: val_loss 没有改善 0.414523，最佳值 0.409425，等待 4/15
y_pred: tensor([0.3917, 0.3434, 0.3555,  ..., 0.9882, 0.9922, 0.9901],
       grad_fn=<IndexBackward0>)
负样本数量： 14248
正样本数量： 7893
TP:  4063
TN:  13999
FP:  249
FN:  3830
batch idx: 0, loss: 0.418502 auc: 0.8378, acc: 0.8158, precision: 0.9423, recall: 0.5148, f1: 0.6658, time: 0.095s
y_pred: tensor([0.1164, 0.1777, 0.1002,  ..., 0.2322, 0.2921, 0.2754],
       grad_fn=<IndexBackward0>)
负样本数量： 13897
正样本数量： 8114
TP:  4304
TN:  13720
FP:  177
FN:  3810
batch idx: 1, loss: 0.412169 auc: 0.8450, acc: 0.8189, precision: 0.9605, recall: 0.5304, f1: 0.6834, time: 0.093s
y_pred: tensor([0.2804, 0.1219, 0.0978,  ..., 0.9783, 0.9887, 0.9909],
       grad_fn=<IndexBackward0>)
负样本数量： 12266
正样本数量： 7512
TP:  4076
TN:  12106
FP:  160
FN:  3436
batch idx: 2, loss: 0.408164 auc: 0.8521, acc: 0.8182, precision: 0.9622, recall: 0.5426, f1: 0.6939, time: 0.090s
First attempt - auc_train: 0.8377858577 acc_train: 0.8157716454
y_pred: tensor([0.1288, 0.2943, 0.3014,  ..., 0.9883, 0.9918, 0.9876])
负样本数量： 15590
正样本数量： 6949
TP:  3525
TN:  15154
FP:  436
FN:  3424
y_pred: tensor([0.4351, 0.1799, 0.3011,  ..., 0.9937, 0.9893, 0.9896])
负样本数量： 1976
正样本数量： 980
TP:  521
TN:  1898
FP:  78
FN:  459
First attempt - auc_val: 0.8296106121 acc_val: 0.8287412929
Epoch: 0049 loss_train: 0.4129451911 auc_train: 0.8449633752 acc_train: 0.8176055864 precision_train: 0.9549941934 recall_train: 0.5292665452 f1_train: 0.6810479551 loss_val: 0.4228402823 auc_val: 0.8368140539 acc_val: 0.8235384408 precision_val: 0.8798548789 recall_val: 0.5194499429 f1_val: 0.6530537433 time: 0.3795s
Epoch 0049: val_loss 没有改善 0.422840，最佳值 0.409425，等待 5/15

=== 完成所有epoch训练 ===
最佳epoch: 44
最佳验证损失: 0.409425
总训练时间: 21.44秒
Optimization Finished!
Best Epoch: 0044
y_pred: tensor([0.2786, 0.4251, 0.3044,  ..., 0.9885, 0.9846, 0.9857])
负样本数量： 16001
正样本数量： 6304
TP:  2911
TN:  15460
FP:  541
FN:  3393
y_pred: tensor([0.0565, 0.0504, 0.0465, 0.1492, 0.1476, 0.1767, 0.1158, 0.1710, 0.1185,
        0.1936, 0.2157, 0.1634, 0.1359, 0.1206, 0.1084, 0.2909, 0.1938, 0.1994,
        0.1861, 0.1584, 0.1449, 0.1403, 0.3144, 0.1918, 0.2807, 0.2532, 0.1580,
        0.1937, 0.2459, 0.2880, 0.3308, 0.4303, 0.5090, 0.5727, 0.6178, 0.2561,
        0.3184, 0.3681, 0.4757, 0.5770, 0.7609, 0.8610, 0.9022, 0.3628, 0.6874,
        0.8858, 0.9622, 0.9795, 0.9841, 0.1647, 0.1431, 0.1292, 0.1260, 0.0831,
        0.1944, 0.1986, 0.2117, 0.2148, 0.2423, 0.4068, 0.2493, 0.2878, 0.1672,
        0.2864, 0.2121, 0.1974, 0.3211, 0.4173, 0.4397, 0.4640, 0.5223, 0.5659,
        0.2929, 0.2199, 0.2995, 0.1852, 0.3287, 0.4047, 0.5241, 0.6846, 0.8513,
        0.9188, 0.9390, 0.4099, 0.2033, 0.5029, 0.6832, 0.8759, 0.9098, 0.9498,
        0.9808, 0.9876, 0.9728, 0.9768, 0.9689, 0.9656, 0.9617, 0.9808, 0.0565,
        0.0504, 0.0465, 0.0443, 0.0429, 0.0514, 0.0493, 0.0512, 0.0496, 0.0540,
        0.0520, 0.0521, 0.0521, 0.0517, 0.0505, 0.0503, 0.1076, 0.3154, 0.1480,
        0.1400, 0.1344, 0.1275, 0.1208, 0.1139, 0.1106, 0.0995, 0.0823, 0.1052,
        0.1002, 0.0981, 0.0989, 0.1047, 0.1011, 0.0950, 0.0952, 0.0968, 0.0950,
        0.0934, 0.0872, 0.0810, 0.0889, 0.0873, 0.0807, 0.0778, 0.0820, 0.0753,
        0.0780, 0.0764, 0.0754, 0.0801, 0.0674, 0.0601, 0.0559, 0.0532, 0.0588,
        0.0557, 0.0567, 0.0548, 0.2303, 0.1549, 0.2265, 0.1788, 0.1632, 0.1561,
        0.2679, 0.2829, 0.3583, 0.2252, 0.2762, 0.2244, 0.1755, 0.1823, 0.2980,
        0.3254, 0.2979, 0.2459, 0.3565, 0.3838, 0.1663, 0.2369, 0.1982, 0.2928,
        0.2817, 0.3019, 0.3359, 0.3716, 0.4230, 0.4613, 0.4569, 0.4917, 0.5544,
        0.7321, 0.8092, 0.8972, 0.9328, 0.9641, 0.9752, 0.9746, 0.3387, 0.3038,
        0.1278, 0.1404, 0.2787, 0.2499, 0.2871, 0.3398, 0.2961, 0.1979, 0.2925,
        0.3323, 0.2193, 0.3064, 0.3216, 0.3350, 0.3796, 0.2920, 0.4033, 0.4116,
        0.4383, 0.6613, 0.8142, 0.8685, 0.9254, 0.9311, 0.9610, 0.9761, 0.9776,
        0.9818, 0.9755, 0.9762, 0.9813])
负样本数量： 159
正样本数量： 70
TP:  36
TN:  151
FP:  8
FN:  34
--------------------------------
--------Testing-----------------
--------------------------------
loss_test: 0.4357380718 auc_test: 0.8181118299 acc_test: 0.8201104380 precision_test: 0.8307305383 recall_test: 0.4880280094 f1_test: 0.6141699575 auc_max: 0.8307277628 acc_max: 0.8236269895 auc_std_test: 0.0126159329 acc_std_test: 0.0035165515 first_attempt_auc_test: 0.8054958970 first_attempt_acc_test: 0.8236269895
../model/expCEKT2025-08-02 12-54-40/
