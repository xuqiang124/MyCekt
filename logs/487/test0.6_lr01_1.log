/Users/I764812/myCode/MyCekt/code/train_demo_1.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embeddings_tensor = torch.tensor(embeddings, dtype=torch.long)
=== GPU信息 ===
PyTorch版本: 2.7.1
CUDA可用: False
CUDA不可用，将使用CPU训练
==================================================
使用CPU训练
Namespace(no_cuda=False, seed=42, data_dir='../data', save_dir='../model', graph_save_dir='graphs', load_dir='', hid_dim=32, emb_dim=32, attn_dim=32, vae_encoder_dim=32, vae_decoder_dim=32, edge_types=2, dropout=0, bias=True, binary=True, result_type=12, temp=0.5, hard=False, no_factor=False, prior=False, var=1, epochs=50, batch_size=512, train_ratio=0.6, val_ratio=0.2, shuffle=True, lr=0.001, lr_decay=50, gamma=0.5, test=False, test_model_dir='logs/expDKT', weight_method='senet', amp=False, gpu_id=0, cuda=False, factor=True)
从pkl文件加载数据集...../data/487
从pkl文件加载数据集...../data/487
训练集大小: 2153
验证集大小: 868
测试集大小: 847
模型初始化完成
start training!
EarlyStopping: 监控 val_loss (最小值)，耐心值 15，最小变化阈值 0.001
开始训练，最大epoch数: 50
提前停止配置已启用，监控验证损失
y_pred: tensor([0.3981, 0.4369, 0.4525,  ..., 0.4064, 0.4750, 0.3971],
       grad_fn=<IndexBackward0>)
负样本数量： 14384
正样本数量： 8599
TP:  0
TN:  14384
FP:  0
FN:  8599
batch idx: 0, loss: 0.655712 auc: 0.6150, acc: 0.6259, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.126s
y_pred: tensor([0.0697, 0.0449, 0.0398,  ..., 0.0439, 0.0440, 0.0447],
       grad_fn=<IndexBackward0>)
负样本数量： 14129
正样本数量： 9038
TP:  0
TN:  14129
FP:  0
FN:  9038
batch idx: 1, loss: 1.151388 auc: 0.6991, acc: 0.6099, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.101s
y_pred: tensor([0.1684, 0.1488, 0.1311,  ..., 0.2722, 0.3375, 0.2679],
       grad_fn=<IndexBackward0>)
负样本数量： 14413
正样本数量： 8529
TP:  0
TN:  14413
FP:  0
FN:  8529
batch idx: 2, loss: 0.618321 auc: 0.8057, acc: 0.6282, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.099s
y_pred: tensor([0.4527, 0.4180, 0.4171,  ..., 0.7442, 0.7693, 0.7801],
       grad_fn=<IndexBackward0>)
负样本数量： 13994
正样本数量： 8888
TP:  7864
TN:  8562
FP:  5432
FN:  1024
batch idx: 3, loss: 0.648023 auc: 0.8438, acc: 0.7179, precision: 0.5915, recall: 0.8848, f1: 0.7090, time: 0.116s
y_pred: tensor([0.4078, 0.5980, 0.6959,  ..., 0.7869, 0.7962, 0.7851],
       grad_fn=<IndexBackward0>)
负样本数量： 3067
正样本数量： 1738
TP:  1476
TN:  1921
FP:  1146
FN:  262
batch idx: 4, loss: 0.647290 auc: 0.8280, acc: 0.7070, precision: 0.5629, recall: 0.8493, f1: 0.6771, time: 0.073s
First attempt - auc_train: 0.6149910190 acc_train: 0.6258538920
y_pred: tensor([0.2803, 0.2254, 0.2040,  ..., 0.1896, 0.1906, 0.4232])
负样本数量： 14312
正样本数量： 9485
TP:  7207
TN:  11542
FP:  2770
FN:  2278
y_pred: tensor([0.3032, 0.2352, 0.4205,  ..., 0.6950, 0.6980, 0.6977])
负样本数量： 9529
正样本数量： 6671
TP:  5050
TN:  7524
FP:  2005
FN:  1621
First attempt - auc_val: 0.8614205913 acc_val: 0.7878724209
Epoch: 0000 loss_train: 0.7441467524 auc_train: 0.7583035727 acc_train: 0.6577590332 precision_train: 0.2308770278 recall_train: 0.3468080985 f1_train: 0.2772087330 loss_val: 0.5164650083 auc_val: 0.8568468655 acc_val: 0.7820226302 precision_val: 0.7190829127 recall_val: 0.7584196287 f1_val: 0.7382262820 time: 0.6673s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0000: val_loss 改善从 0.516465 到 0.516465
y_pred: tensor([0.2973, 0.4643, 0.5700,  ..., 0.7176, 0.7065, 0.7264],
       grad_fn=<IndexBackward0>)
负样本数量： 14376
正样本数量： 8826
TP:  6653
TN:  11273
FP:  3103
FN:  2173
batch idx: 0, loss: 0.520838 auc: 0.8477, acc: 0.7726, precision: 0.6819, recall: 0.7538, f1: 0.7161, time: 0.100s
y_pred: tensor([0.1953, 0.1610, 0.1273,  ..., 0.1593, 0.2233, 0.1572],
       grad_fn=<IndexBackward0>)
负样本数量： 14163
正样本数量： 8793
TP:  164
TN:  14150
FP:  13
FN:  8629
batch idx: 1, loss: 0.511478 auc: 0.8507, acc: 0.6235, precision: 0.9266, recall: 0.0187, f1: 0.0366, time: 0.103s
y_pred: tensor([0.4300, 0.4863, 0.5186,  ..., 0.5767, 0.5998, 0.6068],
       grad_fn=<IndexBackward0>)
负样本数量： 14586
正样本数量： 8552
TP:  2206
TN:  14405
FP:  181
FN:  6346
batch idx: 2, loss: 0.498740 auc: 0.8468, acc: 0.7179, precision: 0.9242, recall: 0.2580, f1: 0.4033, time: 0.101s
y_pred: tensor([0.1490, 0.1048, 0.0942,  ..., 0.6194, 0.6310, 0.6438],
       grad_fn=<IndexBackward0>)
负样本数量： 13748
正样本数量： 8872
TP:  5429
TN:  12277
FP:  1471
FN:  3443
batch idx: 3, loss: 0.489680 auc: 0.8497, acc: 0.7828, precision: 0.7868, recall: 0.6119, f1: 0.6884, time: 0.102s
y_pred: tensor([0.5545, 0.6453, 0.7291,  ..., 0.7589, 0.7630, 0.7820],
       grad_fn=<IndexBackward0>)
负样本数量： 3114
正样本数量： 1749
TP:  1183
TN:  2621
FP:  493
FN:  566
batch idx: 4, loss: 0.480141 auc: 0.8439, acc: 0.7822, precision: 0.7058, recall: 0.6764, f1: 0.6908, time: 0.068s
First attempt - auc_train: 0.8476508153 acc_train: 0.7726058098
y_pred: tensor([0.1166, 0.0826, 0.2161,  ..., 0.8185, 0.8057, 0.7906])
负样本数量： 13927
正样本数量： 9322
TP:  6849
TN:  11580
FP:  2347
FN:  2473
y_pred: tensor([0.1435, 0.1010, 0.2469,  ..., 0.7968, 0.7996, 0.8049])
负样本数量： 9914
正样本数量： 6834
TP:  5009
TN:  8133
FP:  1781
FN:  1825
First attempt - auc_val: 0.8668064486 acc_val: 0.7926792550
Epoch: 0001 loss_train: 0.5001753867 auc_train: 0.8477499646 acc_train: 0.7358096476 precision_train: 0.8050648886 recall_train: 0.4637419649 f1_train: 0.5070402623 loss_val: 0.4752402306 auc_val: 0.8628307206 acc_val: 0.7886849822 precision_val: 0.7412414215 recall_val: 0.7338332317 f1_val: 0.7375163677 time: 0.6133s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0001: val_loss 改善从 0.475240 到 0.475240
y_pred: tensor([0.5636, 0.6255, 0.1641,  ..., 0.7997, 0.8089, 0.7839],
       grad_fn=<IndexBackward0>)
负样本数量： 14296
正样本数量： 8404
TP:  6071
TN:  11533
FP:  2763
FN:  2333
batch idx: 0, loss: 0.489763 auc: 0.8480, acc: 0.7755, precision: 0.6872, recall: 0.7224, f1: 0.7044, time: 0.090s
y_pred: tensor([0.1409, 0.0885, 0.0783,  ..., 0.7395, 0.7731, 0.7898],
       grad_fn=<IndexBackward0>)
负样本数量： 14236
正样本数量： 8905
TP:  6044
TN:  12051
FP:  2185
FN:  2861
batch idx: 1, loss: 0.473778 auc: 0.8554, acc: 0.7819, precision: 0.7345, recall: 0.6787, f1: 0.7055, time: 0.096s
y_pred: tensor([0.1503, 0.2764, 0.4051,  ..., 0.5736, 0.6214, 0.6446],
       grad_fn=<IndexBackward0>)
负样本数量： 14276
正样本数量： 8886
TP:  5406
TN:  12842
FP:  1434
FN:  3480
batch idx: 2, loss: 0.464663 auc: 0.8558, acc: 0.7878, precision: 0.7904, recall: 0.6084, f1: 0.6875, time: 0.097s
y_pred: tensor([0.5431, 0.6203, 0.6681,  ..., 0.0710, 0.0684, 0.0689],
       grad_fn=<IndexBackward0>)
负样本数量： 14445
正样本数量： 8760
TP:  4631
TN:  13527
FP:  918
FN:  4129
batch idx: 3, loss: 0.471155 auc: 0.8472, acc: 0.7825, precision: 0.8346, recall: 0.5287, f1: 0.6473, time: 0.098s
y_pred: tensor([0.1876, 0.1338, 0.2305,  ..., 0.6788, 0.7137, 0.7570],
       grad_fn=<IndexBackward0>)
负样本数量： 2734
正样本数量： 1837
TP:  1004
TN:  2571
FP:  163
FN:  833
batch idx: 4, loss: 0.466572 auc: 0.8576, acc: 0.7821, precision: 0.8603, recall: 0.5465, f1: 0.6684, time: 0.071s
First attempt - auc_train: 0.8480279063 acc_train: 0.7755066079
y_pred: tensor([0.6208, 0.2572, 0.4112,  ..., 0.8957, 0.9039, 0.9037])
负样本数量： 14114
正样本数量： 9614
TP:  6344
TN:  12748
FP:  1366
FN:  3270
y_pred: tensor([0.6205, 0.6946, 0.7290,  ..., 0.8213, 0.8214, 0.8474])
负样本数量： 9727
正样本数量： 6542
TP:  4230
TN:  8657
FP:  1070
FN:  2312
First attempt - auc_val: 0.8705544909 acc_val: 0.8046190155
Epoch: 0002 loss_train: 0.4731863499 auc_train: 0.8527681825 acc_train: 0.7819805142 precision_train: 0.7813896144 recall_train: 0.6169365769 f1_train: 0.6826245493 loss_val: 0.4514496624 auc_val: 0.8628736517 acc_val: 0.7983694991 precision_val: 0.8104703522 recall_val: 0.6532311390 f1_val: 0.7234003582 time: 0.5944s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0002: val_loss 改善从 0.451450 到 0.451450
y_pred: tensor([0.5839, 0.7186, 0.6272,  ..., 0.7753, 0.7944, 0.8029],
       grad_fn=<IndexBackward0>)
负样本数量： 14520
正样本数量： 8585
TP:  5361
TN:  12816
FP:  1704
FN:  3224
batch idx: 0, loss: 0.461039 auc: 0.8515, acc: 0.7867, precision: 0.7588, recall: 0.6245, f1: 0.6851, time: 0.092s
y_pred: tensor([0.2073, 0.3661, 0.1624,  ..., 0.8387, 0.8759, 0.8778],
       grad_fn=<IndexBackward0>)
负样本数量： 14495
正样本数量： 8860
TP:  5823
TN:  12288
FP:  2207
FN:  3037
batch idx: 1, loss: 0.472479 auc: 0.8481, acc: 0.7755, precision: 0.7252, recall: 0.6572, f1: 0.6895, time: 0.091s
y_pred: tensor([0.1973, 0.1322, 0.1140,  ..., 0.8991, 0.8901, 0.8832],
       grad_fn=<IndexBackward0>)
负样本数量： 14242
正样本数量： 8649
TP:  5396
TN:  12676
FP:  1566
FN:  3253
batch idx: 2, loss: 0.454008 auc: 0.8571, acc: 0.7895, precision: 0.7751, recall: 0.6239, f1: 0.6913, time: 0.094s
y_pred: tensor([0.1814, 0.1247, 0.1107,  ..., 0.9125, 0.8935, 0.8952],
       grad_fn=<IndexBackward0>)
负样本数量： 13758
正样本数量： 8811
TP:  5446
TN:  12367
FP:  1391
FN:  3365
batch idx: 3, loss: 0.453442 auc: 0.8570, acc: 0.7893, precision: 0.7965, recall: 0.6181, f1: 0.6961, time: 0.094s
y_pred: tensor([0.6007, 0.6579, 0.6993,  ..., 0.4456, 0.4879, 0.1976],
       grad_fn=<IndexBackward0>)
负样本数量： 2972
正样本数量： 1887
TP:  1150
TN:  2758
FP:  214
FN:  737
batch idx: 4, loss: 0.434655 auc: 0.8680, acc: 0.8043, precision: 0.8431, recall: 0.6094, f1: 0.7075, time: 0.068s
First attempt - auc_train: 0.8515241564 acc_train: 0.7867128327
y_pred: tensor([0.6242, 0.6594, 0.6933,  ..., 0.6524, 0.6538, 0.6920])
负样本数量： 14147
正样本数量： 9554
TP:  5618
TN:  13174
FP:  973
FN:  3936
y_pred: tensor([0.5492, 0.1605, 0.3604,  ..., 0.1231, 0.1037, 0.0960])
负样本数量： 9694
正样本数量： 6602
TP:  3757
TN:  9153
FP:  541
FN:  2845
First attempt - auc_val: 0.8668075528 acc_val: 0.7928779376
Epoch: 0003 loss_train: 0.4551244676 auc_train: 0.8563356922 acc_train: 0.7890416471 precision_train: 0.7797376082 recall_train: 0.6266191771 f1_train: 0.6938955353 loss_val: 0.4439138770 auc_val: 0.8657014975 acc_val: 0.7925484435 precision_val: 0.8632509756 recall_val: 0.5785479683 f1_val: 0.6926504073 time: 0.5829s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0003: val_loss 改善从 0.443914 到 0.443914
y_pred: tensor([0.1346, 0.0844, 0.1998,  ..., 0.9020, 0.8907, 0.9180],
       grad_fn=<IndexBackward0>)
负样本数量： 14352
正样本数量： 8759
TP:  4683
TN:  13414
FP:  938
FN:  4076
batch idx: 0, loss: 0.453690 auc: 0.8548, acc: 0.7830, precision: 0.8331, recall: 0.5347, f1: 0.6513, time: 0.093s
y_pred: tensor([0.1406, 0.0874, 0.0821,  ..., 0.0720, 0.0685, 0.0708],
       grad_fn=<IndexBackward0>)
负样本数量： 14107
正样本数量： 8592
TP:  4856
TN:  13016
FP:  1091
FN:  3736
batch idx: 1, loss: 0.451666 auc: 0.8552, acc: 0.7873, precision: 0.8165, recall: 0.5652, f1: 0.6680, time: 0.092s
y_pred: tensor([0.6232, 0.1777, 0.2969,  ..., 0.4781, 0.5683, 0.6175],
       grad_fn=<IndexBackward0>)
负样本数量： 14197
正样本数量： 8901
TP:  5348
TN:  12949
FP:  1248
FN:  3553
batch idx: 2, loss: 0.445691 auc: 0.8599, acc: 0.7921, precision: 0.8108, recall: 0.6008, f1: 0.6902, time: 0.095s
y_pred: tensor([0.1239, 0.0877, 0.0794,  ..., 0.8901, 0.9046, 0.9224],
       grad_fn=<IndexBackward0>)
负样本数量： 14502
正样本数量： 8696
TP:  5412
TN:  13056
FP:  1446
FN:  3284
batch idx: 3, loss: 0.442335 auc: 0.8624, acc: 0.7961, precision: 0.7892, recall: 0.6224, f1: 0.6959, time: 0.096s
y_pred: tensor([0.5693, 0.6414, 0.7009,  ..., 0.7744, 0.8078, 0.8430],
       grad_fn=<IndexBackward0>)
负样本数量： 2829
正样本数量： 1844
TP:  1069
TN:  2603
FP:  226
FN:  775
batch idx: 4, loss: 0.447695 auc: 0.8617, acc: 0.7858, precision: 0.8255, recall: 0.5797, f1: 0.6811, time: 0.119s
First attempt - auc_train: 0.8548332887 acc_train: 0.7830470339
y_pred: tensor([0.1381, 0.2702, 0.3258,  ..., 0.9142, 0.9258, 0.9392])
负样本数量： 14165
正样本数量： 9277
TP:  5433
TN:  13337
FP:  828
FN:  3844
y_pred: tensor([0.1548, 0.1057, 0.0955,  ..., 0.6186, 0.5985, 0.6439])
负样本数量： 9676
正样本数量： 6879
TP:  4064
TN:  8987
FP:  689
FN:  2815
First attempt - auc_val: 0.8720047884 acc_val: 0.8006995990
Epoch: 0004 loss_train: 0.4482152164 auc_train: 0.8588048124 acc_train: 0.7888869651 precision_train: 0.8150200677 recall_train: 0.5805462921 f1_train: 0.6773045201 loss_val: 0.4368210286 auc_val: 0.8692491283 acc_val: 0.7945207448 precision_val: 0.8613958390 recall_val: 0.5882127271 f1_val: 0.6990399186 time: 0.8617s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0004: val_loss 改善从 0.436821 到 0.436821
y_pred: tensor([0.1125, 0.0828, 0.0771,  ..., 0.9210, 0.5079, 0.5931],
       grad_fn=<IndexBackward0>)
负样本数量： 14313
正样本数量： 8619
TP:  4624
TN:  13512
FP:  801
FN:  3995
batch idx: 0, loss: 0.435458 auc: 0.8653, acc: 0.7909, precision: 0.8524, recall: 0.5365, f1: 0.6585, time: 0.127s
y_pred: tensor([0.5542, 0.6210, 0.6591,  ..., 0.0722, 0.1229, 0.3640],
       grad_fn=<IndexBackward0>)
负样本数量： 14308
正样本数量： 8814
TP:  5083
TN:  13289
FP:  1019
FN:  3731
batch idx: 1, loss: 0.435697 auc: 0.8652, acc: 0.7946, precision: 0.8330, recall: 0.5767, f1: 0.6816, time: 0.108s
y_pred: tensor([0.6386, 0.6535, 0.1660,  ..., 0.9329, 0.9340, 0.9282],
       grad_fn=<IndexBackward0>)
负样本数量： 14717
正样本数量： 8655
TP:  5100
TN:  13509
FP:  1208
FN:  3555
batch idx: 2, loss: 0.440038 auc: 0.8598, acc: 0.7962, precision: 0.8085, recall: 0.5893, f1: 0.6817, time: 0.101s
y_pred: tensor([0.6476, 0.6874, 0.7361,  ..., 0.9538, 0.9533, 0.9557],
       grad_fn=<IndexBackward0>)
负样本数量： 13650
正样本数量： 9016
TP:  5322
TN:  12690
FP:  960
FN:  3694
batch idx: 3, loss: 0.435967 auc: 0.8676, acc: 0.7947, precision: 0.8472, recall: 0.5903, f1: 0.6958, time: 0.099s
y_pred: tensor([0.1376, 0.3148, 0.1400,  ..., 0.9291, 0.9393, 0.9393],
       grad_fn=<IndexBackward0>)
负样本数量： 2999
正样本数量： 1688
TP:  914
TN:  2785
FP:  214
FN:  774
batch idx: 4, loss: 0.449042 auc: 0.8491, acc: 0.7892, precision: 0.8103, recall: 0.5415, f1: 0.6491, time: 0.076s
First attempt - auc_train: 0.8653112247 acc_train: 0.7908599337
y_pred: tensor([0.1349, 0.0922, 0.0848,  ..., 0.5356, 0.5744, 0.5798])
负样本数量： 13845
正样本数量： 9894
TP:  6177
TN:  12846
FP:  999
FN:  3717
y_pred: tensor([0.1525, 0.1010, 0.0916,  ..., 0.4195, 0.4794, 0.5175])
负样本数量： 9996
正样本数量： 6262
TP:  3748
TN:  9370
FP:  626
FN:  2514
First attempt - auc_val: 0.8735286963 acc_val: 0.8013395678
Epoch: 0005 loss_train: 0.4392403066 auc_train: 0.8613913845 acc_train: 0.7931023260 precision_train: 0.8302638126 recall_train: 0.5668386434 f1_train: 0.6733316598 loss_val: 0.4265319705 auc_val: 0.8733540032 acc_val: 0.8041019404 precision_val: 0.8588337631 recall_val: 0.6114242946 f1_val: 0.7142510332 time: 0.6663s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0005: val_loss 改善从 0.426532 到 0.426532
y_pred: tensor([0.1372, 0.0919, 0.0821,  ..., 0.0748, 0.0777, 0.0757],
       grad_fn=<IndexBackward0>)
负样本数量： 13978
正样本数量： 8781
TP:  5108
TN:  13079
FP:  899
FN:  3673
batch idx: 0, loss: 0.426912 auc: 0.8709, acc: 0.7991, precision: 0.8503, recall: 0.5817, f1: 0.6908, time: 0.100s
y_pred: tensor([0.1714, 0.1154, 0.1124,  ..., 0.9164, 0.9392, 0.9464],
       grad_fn=<IndexBackward0>)
负样本数量： 14626
正样本数量： 8594
TP:  4855
TN:  13753
FP:  873
FN:  3739
batch idx: 1, loss: 0.424610 auc: 0.8692, acc: 0.8014, precision: 0.8476, recall: 0.5649, f1: 0.6780, time: 0.105s
y_pred: tensor([0.1180, 0.0714, 0.0749,  ..., 0.9587, 0.9458, 0.9463],
       grad_fn=<IndexBackward0>)
负样本数量： 14385
正样本数量： 8576
TP:  5290
TN:  13257
FP:  1128
FN:  3286
batch idx: 2, loss: 0.429246 auc: 0.8665, acc: 0.8078, precision: 0.8242, recall: 0.6168, f1: 0.7056, time: 0.119s
y_pred: tensor([0.5877, 0.5880, 0.1502,  ..., 0.9443, 0.9216, 0.9230],
       grad_fn=<IndexBackward0>)
负样本数量： 14135
正样本数量： 9016
TP:  5045
TN:  13368
FP:  767
FN:  3971
batch idx: 3, loss: 0.431457 auc: 0.8676, acc: 0.7953, precision: 0.8680, recall: 0.5596, f1: 0.6805, time: 0.105s
y_pred: tensor([0.5265, 0.5287, 0.1786,  ..., 0.9337, 0.9466, 0.9337],
       grad_fn=<IndexBackward0>)
负样本数量： 2863
正样本数量： 1825
TP:  1041
TN:  2704
FP:  159
FN:  784
batch idx: 4, loss: 0.427960 auc: 0.8696, acc: 0.7988, precision: 0.8675, recall: 0.5704, f1: 0.6883, time: 0.075s
First attempt - auc_train: 0.8708697542 acc_train: 0.7991124390
y_pred: tensor([0.4672, 0.6469, 0.2293,  ..., 0.0744, 0.2736, 0.4564])
负样本数量： 14180
正样本数量： 9714
TP:  5821
TN:  13492
FP:  688
FN:  3893
y_pred: tensor([0.1216, 0.0798, 0.0728,  ..., 0.9068, 0.9512, 0.9408])
负样本数量： 9661
正样本数量： 6442
TP:  3816
TN:  9080
FP:  581
FN:  2626
First attempt - auc_val: 0.8806113412 acc_val: 0.8082782288
Epoch: 0006 loss_train: 0.4280368149 auc_train: 0.8687395380 acc_train: 0.8004886568 precision_train: 0.8515416044 recall_train: 0.5786897916 f1_train: 0.6886315527 loss_val: 0.4201025814 auc_val: 0.8754642806 acc_val: 0.8045613960 precision_val: 0.8810823264 recall_val: 0.5958004166 f1_val: 0.7108735622 time: 0.6600s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0006: val_loss 改善从 0.420103 到 0.420103
y_pred: tensor([0.5679, 0.6144, 0.6350,  ..., 0.8859, 0.9017, 0.9250],
       grad_fn=<IndexBackward0>)
负样本数量： 14160
正样本数量： 8418
TP:  4613
TN:  13576
FP:  584
FN:  3805
batch idx: 0, loss: 0.419890 auc: 0.8709, acc: 0.8056, precision: 0.8876, recall: 0.5480, f1: 0.6776, time: 0.139s
y_pred: tensor([0.5617, 0.1420, 0.0870,  ..., 0.9406, 0.9526, 0.9478],
       grad_fn=<IndexBackward0>)
负样本数量： 14542
正样本数量： 8900
TP:  5781
TN:  13147
FP:  1395
FN:  3119
batch idx: 1, loss: 0.430318 auc: 0.8689, acc: 0.8074, precision: 0.8056, recall: 0.6496, f1: 0.7192, time: 0.122s
y_pred: tensor([0.1311, 0.0898, 0.0750,  ..., 0.4733, 0.1867, 0.5073],
       grad_fn=<IndexBackward0>)
负样本数量： 14499
正样本数量： 8515
TP:  5049
TN:  13643
FP:  856
FN:  3466
batch idx: 2, loss: 0.415651 auc: 0.8716, acc: 0.8122, precision: 0.8550, recall: 0.5930, f1: 0.7003, time: 0.113s
y_pred: tensor([0.1681, 0.1054, 0.0897,  ..., 0.6858, 0.7567, 0.7900],
       grad_fn=<IndexBackward0>)
负样本数量： 14025
正样本数量： 9061
TP:  4271
TN:  13778
FP:  247
FN:  4790
batch idx: 3, loss: 0.437096 auc: 0.8729, acc: 0.7818, precision: 0.9453, recall: 0.4714, f1: 0.6291, time: 0.101s
y_pred: tensor([0.1303, 0.0873, 0.0780,  ..., 0.9526, 0.9559, 0.9422],
       grad_fn=<IndexBackward0>)
负样本数量： 2761
正样本数量： 1898
TP:  1349
TN:  2398
FP:  363
FN:  549
batch idx: 4, loss: 0.445452 auc: 0.8710, acc: 0.8042, precision: 0.7880, recall: 0.7107, f1: 0.7474, time: 0.072s
First attempt - auc_train: 0.8708701835 acc_train: 0.8056072283
y_pred: tensor([0.5468, 0.1507, 0.0860,  ..., 0.9561, 0.9440, 0.9441])
负样本数量： 14280
正样本数量： 9225
TP:  6131
TN:  13088
FP:  1192
FN:  3094
y_pred: tensor([0.1455, 0.0931, 0.2767,  ..., 0.9552, 0.9458, 0.9447])
负样本数量： 9561
正样本数量： 6931
TP:  4723
TN:  8632
FP:  929
FN:  2208
First attempt - auc_val: 0.8782703916 acc_val: 0.8176558179
Epoch: 0007 loss_train: 0.4296815217 auc_train: 0.8710462289 acc_train: 0.8022627587 precision_train: 0.8563129338 recall_train: 0.5945211006 f1_train: 0.6947098221 loss_val: 0.4179009348 auc_val: 0.8774189186 acc_val: 0.8137211905 precision_val: 0.8364292925 recall_val: 0.6730191485 f1_val: 0.7458456367 time: 0.6968s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0007: val_loss 改善从 0.417901 到 0.417901
y_pred: tensor([0.5021, 0.4922, 0.1321,  ..., 0.7439, 0.6005, 0.6887],
       grad_fn=<IndexBackward0>)
负样本数量： 14421
正样本数量： 8835
TP:  5680
TN:  13380
FP:  1041
FN:  3155
batch idx: 0, loss: 0.410224 auc: 0.8776, acc: 0.8196, precision: 0.8451, recall: 0.6429, f1: 0.7303, time: 0.091s
y_pred: tensor([0.1552, 0.0947, 0.0789,  ..., 0.9363, 0.9525, 0.9204],
       grad_fn=<IndexBackward0>)
负样本数量： 14531
正样本数量： 8519
TP:  4175
TN:  14204
FP:  327
FN:  4344
batch idx: 1, loss: 0.423800 auc: 0.8694, acc: 0.7974, precision: 0.9274, recall: 0.4901, f1: 0.6413, time: 0.094s
y_pred: tensor([0.5561, 0.5250, 0.1785,  ..., 0.9484, 0.9435, 0.9442],
       grad_fn=<IndexBackward0>)
负样本数量： 14496
正样本数量： 8357
TP:  4826
TN:  13691
FP:  805
FN:  3531
batch idx: 2, loss: 0.417777 auc: 0.8676, acc: 0.8103, precision: 0.8570, recall: 0.5775, f1: 0.6900, time: 0.094s
y_pred: tensor([0.5905, 0.6438, 0.5593,  ..., 0.6734, 0.7329, 0.7604],
       grad_fn=<IndexBackward0>)
负样本数量： 13613
正样本数量： 9389
TP:  6078
TN:  12621
FP:  992
FN:  3311
batch idx: 3, loss: 0.411433 auc: 0.8795, acc: 0.8129, precision: 0.8597, recall: 0.6474, f1: 0.7386, time: 0.096s
y_pred: tensor([0.5150, 0.1795, 0.0939,  ..., 0.9544, 0.9599, 0.9641],
       grad_fn=<IndexBackward0>)
负样本数量： 2926
正样本数量： 1692
TP:  996
TN:  2784
FP:  142
FN:  696
batch idx: 4, loss: 0.408435 auc: 0.8715, acc: 0.8185, precision: 0.8752, recall: 0.5887, f1: 0.7039, time: 0.068s
First attempt - auc_train: 0.8775791623 acc_train: 0.8195734434
y_pred: tensor([0.5480, 0.5600, 0.5738,  ..., 0.7015, 0.7917, 0.7694])
负样本数量： 13514
正样本数量： 10082
TP:  6362
TN:  12821
FP:  693
FN:  3720
y_pred: tensor([0.1544, 0.0964, 0.0874,  ..., 0.9525, 0.9517, 0.9593])
负样本数量： 10327
正样本数量： 6074
TP:  3614
TN:  9760
FP:  567
FN:  2460
First attempt - auc_val: 0.8856602844 acc_val: 0.8129767757
Epoch: 0008 loss_train: 0.4143334389 auc_train: 0.8731026319 acc_train: 0.8117316213 precision_train: 0.8728855675 recall_train: 0.5892928574 f1_train: 0.7008012146 loss_val: 0.4092311412 auc_val: 0.8780477047 acc_val: 0.8142074294 precision_val: 0.8830791517 recall_val: 0.6130103255 f1_val: 0.7236569650 time: 0.5853s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0008: val_loss 改善从 0.409231 到 0.409231
y_pred: tensor([0.5271, 0.5354, 0.5685,  ..., 0.8133, 0.7996, 0.8059],
       grad_fn=<IndexBackward0>)
负样本数量： 14603
正样本数量： 8608
TP:  4980
TN:  13914
FP:  689
FN:  3628
batch idx: 0, loss: 0.407250 auc: 0.8753, acc: 0.8140, precision: 0.8785, recall: 0.5785, f1: 0.6976, time: 0.092s
y_pred: tensor([0.1096, 0.0649, 0.0618,  ..., 0.0619, 0.0659, 0.0695],
       grad_fn=<IndexBackward0>)
负样本数量： 13995
正样本数量： 9254
TP:  5578
TN:  13296
FP:  699
FN:  3676
batch idx: 1, loss: 0.406398 auc: 0.8813, acc: 0.8118, precision: 0.8886, recall: 0.6028, f1: 0.7183, time: 0.099s
y_pred: tensor([0.1262, 0.0864, 0.0832,  ..., 0.8575, 0.9159, 0.9434],
       grad_fn=<IndexBackward0>)
负样本数量： 14117
正样本数量： 8608
TP:  5010
TN:  13379
FP:  738
FN:  3598
batch idx: 2, loss: 0.414060 auc: 0.8707, acc: 0.8092, precision: 0.8716, recall: 0.5820, f1: 0.6980, time: 0.098s
y_pred: tensor([0.5252, 0.5739, 0.5967,  ..., 0.0753, 0.0865, 0.0821],
       grad_fn=<IndexBackward0>)
负样本数量： 14260
正样本数量： 8659
TP:  5537
TN:  13316
FP:  944
FN:  3122
batch idx: 3, loss: 0.400227 auc: 0.8797, acc: 0.8226, precision: 0.8543, recall: 0.6395, f1: 0.7314, time: 0.114s
y_pred: tensor([0.1330, 0.0834, 0.0843,  ..., 0.0780, 0.2203, 0.2353],
       grad_fn=<IndexBackward0>)
负样本数量： 3012
正样本数量： 1663
TP:  892
TN:  2862
FP:  150
FN:  771
batch idx: 4, loss: 0.422666 auc: 0.8609, acc: 0.8030, precision: 0.8560, recall: 0.5364, f1: 0.6595, time: 0.070s
First attempt - auc_train: 0.8752895166 acc_train: 0.8140105984
y_pred: tensor([0.5380, 0.5503, 0.5679,  ..., 0.9552, 0.9554, 0.9717])
负样本数量： 14501
正样本数量： 9213
TP:  5463
TN:  13897
FP:  604
FN:  3750
y_pred: tensor([0.1899, 0.1250, 0.1125,  ..., 0.5917, 0.6863, 0.8150])
负样本数量： 9340
正样本数量： 6943
TP:  4204
TN:  8939
FP:  401
FN:  2739
First attempt - auc_val: 0.8813150379 acc_val: 0.8163953783
Epoch: 0009 loss_train: 0.4101202130 auc_train: 0.8735897519 acc_train: 0.8121229285 precision_train: 0.8698199854 recall_train: 0.5878290035 f1_train: 0.7009712373 loss_val: 0.4065780491 auc_val: 0.8812380484 acc_val: 0.8117781104 precision_val: 0.9066828844 recall_val: 0.5992342024 f1_val: 0.7215719002 time: 0.6207s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0009: val_loss 改善从 0.406578 到 0.406578
y_pred: tensor([0.4484, 0.1393, 0.0733,  ..., 0.0827, 0.0808, 0.0777],
       grad_fn=<IndexBackward0>)
负样本数量： 14307
正样本数量： 9175
TP:  5236
TN:  13824
FP:  483
FN:  3939
batch idx: 0, loss: 0.404038 auc: 0.8806, acc: 0.8117, precision: 0.9155, recall: 0.5707, f1: 0.7031, time: 0.111s
y_pred: tensor([0.1653, 0.1137, 0.1048,  ..., 0.5324, 0.6404, 0.6145],
       grad_fn=<IndexBackward0>)
负样本数量： 14407
正样本数量： 8695
TP:  5323
TN:  13492
FP:  915
FN:  3372
batch idx: 1, loss: 0.409385 auc: 0.8735, acc: 0.8144, precision: 0.8533, recall: 0.6122, f1: 0.7129, time: 0.095s
y_pred: tensor([0.1812, 0.1193, 0.1089,  ..., 0.4386, 0.1583, 0.1025],
       grad_fn=<IndexBackward0>)
负样本数量： 14138
正样本数量： 8707
TP:  5446
TN:  13304
FP:  834
FN:  3261
batch idx: 2, loss: 0.398449 auc: 0.8804, acc: 0.8207, precision: 0.8672, recall: 0.6255, f1: 0.7268, time: 0.095s
y_pred: tensor([0.1934, 0.1220, 0.1086,  ..., 0.9677, 0.9634, 0.9673],
       grad_fn=<IndexBackward0>)
负样本数量： 14210
正样本数量： 8382
TP:  5164
TN:  13429
FP:  781
FN:  3218
batch idx: 3, loss: 0.400977 auc: 0.8767, acc: 0.8230, precision: 0.8686, recall: 0.6161, f1: 0.7209, time: 0.096s
y_pred: tensor([0.4402, 0.4421, 0.4464,  ..., 0.6817, 0.7731, 0.8439],
       grad_fn=<IndexBackward0>)
负样本数量： 2925
正样本数量： 1833
TP:  1040
TN:  2812
FP:  113
FN:  793
batch idx: 4, loss: 0.404391 auc: 0.8814, acc: 0.8096, precision: 0.9020, recall: 0.5674, f1: 0.6966, time: 0.070s
First attempt - auc_train: 0.8806320147 acc_train: 0.8116855464
y_pred: tensor([0.5963, 0.1900, 0.1171,  ..., 0.9775, 0.9775, 0.9771])
负样本数量： 14014
正样本数量： 9558
TP:  5958
TN:  13355
FP:  659
FN:  3600
y_pred: tensor([0.5249, 0.5184, 0.2048,  ..., 0.2987, 0.2638, 0.1311])
负样本数量： 9827
正样本数量： 6598
TP:  3934
TN:  9390
FP:  437
FN:  2664
First attempt - auc_val: 0.8840892315 acc_val: 0.8193195316
Epoch: 0010 loss_train: 0.4034480155 auc_train: 0.8785270240 acc_train: 0.8158880036 precision_train: 0.8813368791 recall_train: 0.5983607674 f1_train: 0.7120487079 loss_val: 0.4026128203 auc_val: 0.8820187864 acc_val: 0.8152609835 precision_val: 0.9002154590 recall_val: 0.6097967255 f1_val: 0.7269933097 time: 0.6096s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0010: val_loss 改善从 0.402613 到 0.402613
y_pred: tensor([0.1129, 0.0647, 0.0614,  ..., 0.9718, 0.9752, 0.9594],
       grad_fn=<IndexBackward0>)
负样本数量： 14840
正样本数量： 8563
TP:  4906
TN:  14289
FP:  551
FN:  3657
batch idx: 0, loss: 0.396607 auc: 0.8783, acc: 0.8202, precision: 0.8990, recall: 0.5729, f1: 0.6999, time: 0.096s
y_pred: tensor([0.1413, 0.2877, 0.1324,  ..., 0.0728, 0.0792, 0.4340],
       grad_fn=<IndexBackward0>)
负样本数量： 14003
正样本数量： 9102
TP:  5446
TN:  13282
FP:  721
FN:  3656
batch idx: 1, loss: 0.410045 auc: 0.8753, acc: 0.8106, precision: 0.8831, recall: 0.5983, f1: 0.7133, time: 0.096s
y_pred: tensor([0.1225, 0.0734, 0.0713,  ..., 0.7676, 0.8219, 0.8416],
       grad_fn=<IndexBackward0>)
负样本数量： 14286
正样本数量： 8759
TP:  5417
TN:  13664
FP:  622
FN:  3342
batch idx: 2, loss: 0.387266 auc: 0.8854, acc: 0.8280, precision: 0.8970, recall: 0.6184, f1: 0.7321, time: 0.095s
y_pred: tensor([0.4424, 0.1256, 0.0678,  ..., 0.5116, 0.5128, 0.6204],
       grad_fn=<IndexBackward0>)
负样本数量： 14054
正样本数量： 8415
TP:  5106
TN:  13302
FP:  752
FN:  3309
batch idx: 3, loss: 0.399928 auc: 0.8773, acc: 0.8193, precision: 0.8716, recall: 0.6068, f1: 0.7155, time: 0.099s
y_pred: tensor([0.5908, 0.6157, 0.6196,  ..., 0.9758, 0.9776, 0.9758],
       grad_fn=<IndexBackward0>)
负样本数量： 2804
正样本数量： 1953
TP:  1199
TN:  2700
FP:  104
FN:  754
batch idx: 4, loss: 0.386753 auc: 0.8900, acc: 0.8196, precision: 0.9202, recall: 0.6139, f1: 0.7365, time: 0.072s
First attempt - auc_train: 0.8783016625 acc_train: 0.8201939922
y_pred: tensor([0.1848, 0.1213, 0.3056,  ..., 0.9538, 0.9606, 0.9556])
负样本数量： 14022
正样本数量： 9479
TP:  6026
TN:  13216
FP:  806
FN:  3453
y_pred: tensor([0.1769, 0.1317, 0.1271,  ..., 0.9762, 0.9683, 0.9761])
负样本数量： 9819
正样本数量： 6677
TP:  4160
TN:  9393
FP:  426
FN:  2517
First attempt - auc_val: 0.8815798088 acc_val: 0.8187736692
Epoch: 0011 loss_train: 0.3961197853 auc_train: 0.8812520210 acc_train: 0.8195279025 precision_train: 0.8941863437 recall_train: 0.6020821180 f1_train: 0.7194574652 loss_val: 0.3976143897 auc_val: 0.8840604695 acc_val: 0.8201833913 precision_val: 0.8945671762 recall_val: 0.6293776822 f1_val: 0.7387949058 time: 0.6051s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0011: val_loss 改善从 0.397614 到 0.397614
y_pred: tensor([0.1110, 0.0759, 0.0705,  ..., 0.9702, 0.9677, 0.9605],
       grad_fn=<IndexBackward0>)
负样本数量： 14227
正样本数量： 8667
TP:  5247
TN:  13495
FP:  732
FN:  3420
batch idx: 0, loss: 0.397500 auc: 0.8794, acc: 0.8186, precision: 0.8776, recall: 0.6054, f1: 0.7165, time: 0.094s
y_pred: tensor([0.5028, 0.5752, 0.6743,  ..., 0.9767, 0.9674, 0.9658],
       grad_fn=<IndexBackward0>)
负样本数量： 13838
正样本数量： 9083
TP:  5329
TN:  13345
FP:  493
FN:  3754
batch idx: 1, loss: 0.398943 auc: 0.8807, acc: 0.8147, precision: 0.9153, recall: 0.5867, f1: 0.7151, time: 0.096s
y_pred: tensor([0.1044, 0.0678, 0.2189,  ..., 0.8270, 0.8695, 0.9130],
       grad_fn=<IndexBackward0>)
负样本数量： 14300
正样本数量： 8675
TP:  5090
TN:  13738
FP:  562
FN:  3585
batch idx: 2, loss: 0.392093 auc: 0.8827, acc: 0.8195, precision: 0.9006, recall: 0.5867, f1: 0.7105, time: 0.097s
y_pred: tensor([0.1525, 0.0922, 0.0831,  ..., 0.3566, 0.3909, 0.1869],
       grad_fn=<IndexBackward0>)
负样本数量： 14735
正样本数量： 8527
TP:  5506
TN:  13711
FP:  1024
FN:  3021
batch idx: 3, loss: 0.400081 auc: 0.8791, acc: 0.8261, precision: 0.8432, recall: 0.6457, f1: 0.7314, time: 0.098s
y_pred: tensor([0.1071, 0.0601, 0.0646,  ..., 0.7767, 0.8346, 0.8807],
       grad_fn=<IndexBackward0>)
负样本数量： 2887
正样本数量： 1840
TP:  1124
TN:  2741
FP:  146
FN:  716
batch idx: 4, loss: 0.399155 auc: 0.8780, acc: 0.8176, precision: 0.8850, recall: 0.6109, f1: 0.7228, time: 0.070s
First attempt - auc_train: 0.8793560346 acc_train: 0.8186424391
y_pred: tensor([0.1120, 0.0710, 0.0647,  ..., 0.0917, 0.0925, 0.0930])
负样本数量： 14464
正样本数量： 9245
TP:  5215
TN:  14074
FP:  390
FN:  4030
y_pred: tensor([0.1592, 0.1030, 0.1846,  ..., 0.0718, 0.0729, 0.0694])
负样本数量： 9377
正样本数量： 6911
TP:  4078
TN:  9015
FP:  362
FN:  2833
First attempt - auc_val: 0.8815590233 acc_val: 0.8135729048
Epoch: 0012 loss_train: 0.3975543141 auc_train: 0.8799773859 acc_train: 0.8193215750 precision_train: 0.8843367071 recall_train: 0.6070853837 f1_train: 0.7192603954 loss_val: 0.4056965262 auc_val: 0.8827030150 acc_val: 0.8087081125 precision_val: 0.9244438685 recall_val: 0.5770812460 f1_val: 0.7104419522 time: 0.6014s
Epoch 0012: val_loss 没有改善 0.405697，最佳值 0.397614，等待 1/15
y_pred: tensor([0.6084, 0.2219, 0.2992,  ..., 0.0967, 0.0911, 0.0941],
       grad_fn=<IndexBackward0>)
负样本数量： 14228
正样本数量： 8818
TP:  4906
TN:  13904
FP:  324
FN:  3912
batch idx: 0, loss: 0.393546 auc: 0.8861, acc: 0.8162, precision: 0.9380, recall: 0.5564, f1: 0.6985, time: 0.096s
y_pred: tensor([0.6014, 0.6295, 0.7609,  ..., 0.4594, 0.4771, 0.5320],
       grad_fn=<IndexBackward0>)
负样本数量： 14097
正样本数量： 8754
TP:  5461
TN:  13329
FP:  768
FN:  3293
batch idx: 1, loss: 0.395109 auc: 0.8803, acc: 0.8223, precision: 0.8767, recall: 0.6238, f1: 0.7290, time: 0.097s
y_pred: tensor([0.4587, 0.1295, 0.0704,  ..., 0.0833, 0.5103, 0.5711],
       grad_fn=<IndexBackward0>)
负样本数量： 14496
正样本数量： 8635
TP:  5469
TN:  13613
FP:  883
FN:  3166
batch idx: 2, loss: 0.402364 auc: 0.8754, acc: 0.8250, precision: 0.8610, recall: 0.6334, f1: 0.7298, time: 0.097s
y_pred: tensor([0.5107, 0.5069, 0.5186,  ..., 0.0893, 0.0851, 0.0942],
       grad_fn=<IndexBackward0>)
负样本数量： 14272
正样本数量： 8561
TP:  4933
TN:  13819
FP:  453
FN:  3628
batch idx: 3, loss: 0.386908 auc: 0.8855, acc: 0.8213, precision: 0.9159, recall: 0.5762, f1: 0.7074, time: 0.095s
y_pred: tensor([0.5119, 0.1880, 0.2639,  ..., 0.0709, 0.2796, 0.1442],
       grad_fn=<IndexBackward0>)
负样本数量： 2894
正样本数量： 2024
TP:  1168
TN:  2764
FP:  130
FN:  856
batch idx: 4, loss: 0.423151 auc: 0.8705, acc: 0.7995, precision: 0.8998, recall: 0.5771, f1: 0.7032, time: 0.069s
First attempt - auc_train: 0.8861331470 acc_train: 0.8161936996
y_pred: tensor([0.1152, 0.0791, 0.0739,  ..., 0.9731, 0.9802, 0.9727])
负样本数量： 14085
正样本数量： 9503
TP:  5829
TN:  13536
FP:  549
FN:  3674
y_pred: tensor([0.5813, 0.5209, 0.5478,  ..., 0.0714, 0.2700, 0.1320])
负样本数量： 9756
正样本数量： 6653
TP:  4059
TN:  9328
FP:  428
FN:  2594
First attempt - auc_val: 0.8854332942 acc_val: 0.8209682890
Epoch: 0013 loss_train: 0.4002154350 auc_train: 0.8795502688 acc_train: 0.8168420349 precision_train: 0.8982966165 recall_train: 0.5933673117 f1_train: 0.7135675086 loss_val: 0.3940003067 auc_val: 0.8846615063 acc_val: 0.8184005318 precision_val: 0.9092680936 recall_val: 0.6117429766 f1_val: 0.7314050348 time: 0.6063s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0013: val_loss 改善从 0.394000 到 0.394000
y_pred: tensor([0.1220, 0.0794, 0.0775,  ..., 0.9692, 0.9575, 0.9664],
       grad_fn=<IndexBackward0>)
负样本数量： 14154
正样本数量： 8586
TP:  4876
TN:  13716
FP:  438
FN:  3710
batch idx: 0, loss: 0.395938 auc: 0.8788, acc: 0.8176, precision: 0.9176, recall: 0.5679, f1: 0.7016, time: 0.105s
y_pred: tensor([0.5340, 0.1239, 0.0764,  ..., 0.4914, 0.4530, 0.5136],
       grad_fn=<IndexBackward0>)
负样本数量： 13787
正样本数量： 8481
TP:  5305
TN:  13144
FP:  643
FN:  3176
batch idx: 1, loss: 0.388317 auc: 0.8841, acc: 0.8285, precision: 0.8919, recall: 0.6255, f1: 0.7353, time: 0.098s
y_pred: tensor([0.1008, 0.0727, 0.0721,  ..., 0.4539, 0.5956, 0.6156],
       grad_fn=<IndexBackward0>)
负样本数量： 14565
正样本数量： 8842
TP:  5291
TN:  13938
FP:  627
FN:  3551
batch idx: 2, loss: 0.390416 auc: 0.8813, acc: 0.8215, precision: 0.8941, recall: 0.5984, f1: 0.7169, time: 0.100s
y_pred: tensor([0.1197, 0.0849, 0.2765,  ..., 0.9696, 0.9762, 0.9798],
       grad_fn=<IndexBackward0>)
负样本数量： 14599
正样本数量： 8912
TP:  5145
TN:  14200
FP:  399
FN:  3767
batch idx: 3, loss: 0.385736 auc: 0.8857, acc: 0.8228, precision: 0.9280, recall: 0.5773, f1: 0.7118, time: 0.109s
y_pred: tensor([0.1718, 0.3818, 0.4107,  ..., 0.0611, 0.0597, 0.0635],
       grad_fn=<IndexBackward0>)
负样本数量： 2882
正样本数量： 1971
TP:  1184
TN:  2770
FP:  112
FN:  787
batch idx: 4, loss: 0.399722 auc: 0.8767, acc: 0.8148, precision: 0.9136, recall: 0.6007, f1: 0.7248, time: 0.075s
First attempt - auc_train: 0.8787585421 acc_train: 0.8175901495
y_pred: tensor([0.4978, 0.5223, 0.5376,  ..., 0.9751, 0.9785, 0.1353])
负样本数量： 13905
正样本数量： 9679
TP:  6117
TN:  13258
FP:  647
FN:  3562
y_pred: tensor([0.1176, 0.0827, 0.0749,  ..., 0.9842, 0.9862, 0.9857])
负样本数量： 9936
正样本数量： 6477
TP:  3992
TN:  9470
FP:  466
FN:  2485
First attempt - auc_val: 0.8856356984 acc_val: 0.8215315468
Epoch: 0014 loss_train: 0.3920260549 auc_train: 0.8813250248 acc_train: 0.8210309873 precision_train: 0.9090270488 recall_train: 0.5939665823 f1_train: 0.7180968515 loss_val: 0.3906822652 auc_val: 0.8855361390 acc_val: 0.8208675220 precision_val: 0.8999076803 recall_val: 0.6241607492 f1_val: 0.7370787074 time: 0.6479s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0014: val_loss 改善从 0.390682 到 0.390682
y_pred: tensor([0.1965, 0.3085, 0.2512,  ..., 0.9800, 0.9823, 0.9779],
       grad_fn=<IndexBackward0>)
负样本数量： 14369
正样本数量： 8755
TP:  5250
TN:  13750
FP:  619
FN:  3505
batch idx: 0, loss: 0.392283 auc: 0.8796, acc: 0.8217, precision: 0.8945, recall: 0.5997, f1: 0.7180, time: 0.093s
y_pred: tensor([0.1962, 0.1351, 0.1111,  ..., 0.4766, 0.4959, 0.5576],
       grad_fn=<IndexBackward0>)
负样本数量： 14571
正样本数量： 8206
TP:  4682
TN:  14109
FP:  462
FN:  3524
batch idx: 1, loss: 0.391139 auc: 0.8747, acc: 0.8250, precision: 0.9102, recall: 0.5706, f1: 0.7014, time: 0.094s
y_pred: tensor([0.1220, 0.0768, 0.0736,  ..., 0.1596, 0.5530, 0.2044],
       grad_fn=<IndexBackward0>)
负样本数量： 14294
正样本数量： 8764
TP:  5090
TN:  13854
FP:  440
FN:  3674
batch idx: 2, loss: 0.386986 auc: 0.8836, acc: 0.8216, precision: 0.9204, recall: 0.5808, f1: 0.7122, time: 0.097s
y_pred: tensor([0.5033, 0.5100, 0.5479,  ..., 0.9616, 0.9754, 0.9761],
       grad_fn=<IndexBackward0>)
负样本数量： 13699
正样本数量： 9343
TP:  5944
TN:  13134
FP:  565
FN:  3399
batch idx: 3, loss: 0.379176 auc: 0.8926, acc: 0.8280, precision: 0.9132, recall: 0.6362, f1: 0.7499, time: 0.096s
y_pred: tensor([0.1213, 0.0867, 0.2551,  ..., 0.9781, 0.9813, 0.9758],
       grad_fn=<IndexBackward0>)
负样本数量： 3054
正样本数量： 1724
TP:  1022
TN:  2966
FP:  88
FN:  702
batch idx: 4, loss: 0.373475 auc: 0.8861, acc: 0.8347, precision: 0.9207, recall: 0.5928, f1: 0.7212, time: 0.070s
First attempt - auc_train: 0.8796433753 acc_train: 0.8216571527
y_pred: tensor([0.6170, 0.6480, 0.2358,  ..., 0.3628, 0.3790, 0.3926])
负样本数量： 14083
正样本数量： 9534
TP:  5872
TN:  13560
FP:  523
FN:  3662
y_pred: tensor([0.5022, 0.5075, 0.1903,  ..., 0.4113, 0.5302, 0.6642])
负样本数量： 9758
正样本数量： 6622
TP:  4153
TN:  9341
FP:  417
FN:  2469
First attempt - auc_val: 0.8859755652 acc_val: 0.8227971377
Epoch: 0015 loss_train: 0.3846118748 auc_train: 0.8833426782 acc_train: 0.8261723186 precision_train: 0.9118138077 recall_train: 0.5960012289 f1_train: 0.7205573883 loss_val: 0.3873678744 auc_val: 0.8868250852 acc_val: 0.8233033307 precision_val: 0.9134850463 recall_val: 0.6215264519 f1_val: 0.7397044419 time: 0.5974s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0015: val_loss 改善从 0.387368 到 0.387368
y_pred: tensor([0.1882, 0.1353, 0.1149,  ..., 0.9539, 0.9681, 0.9712],
       grad_fn=<IndexBackward0>)
负样本数量： 14343
正样本数量： 8390
TP:  4868
TN:  13930
FP:  413
FN:  3522
batch idx: 0, loss: 0.383838 auc: 0.8822, acc: 0.8269, precision: 0.9218, recall: 0.5802, f1: 0.7122, time: 0.094s
y_pred: tensor([0.1221, 0.2826, 0.1203,  ..., 0.2600, 0.2572, 0.2595],
       grad_fn=<IndexBackward0>)
负样本数量： 14257
正样本数量： 8795
TP:  5313
TN:  13801
FP:  456
FN:  3482
batch idx: 1, loss: 0.380122 auc: 0.8860, acc: 0.8292, precision: 0.9210, recall: 0.6041, f1: 0.7296, time: 0.094s
y_pred: tensor([0.6175, 0.7613, 0.7520,  ..., 0.0840, 0.2784, 0.1417],
       grad_fn=<IndexBackward0>)
负样本数量： 14735
正样本数量： 8752
TP:  5137
TN:  14256
FP:  479
FN:  3615
batch idx: 2, loss: 0.387391 auc: 0.8805, acc: 0.8257, precision: 0.9147, recall: 0.5870, f1: 0.7151, time: 0.094s
y_pred: tensor([0.1824, 0.3282, 0.2539,  ..., 0.9723, 0.9835, 0.9806],
       grad_fn=<IndexBackward0>)
负样本数量： 13842
正样本数量： 9098
TP:  5388
TN:  13461
FP:  381
FN:  3710
batch idx: 3, loss: 0.384730 auc: 0.8856, acc: 0.8217, precision: 0.9340, recall: 0.5922, f1: 0.7248, time: 0.095s
y_pred: tensor([0.5516, 0.1499, 0.0933,  ..., 0.9635, 0.9836, 0.9857],
       grad_fn=<IndexBackward0>)
负样本数量： 2810
正样本数量： 1757
TP:  1083
TN:  2712
FP:  98
FN:  674
batch idx: 4, loss: 0.374767 auc: 0.8917, acc: 0.8310, precision: 0.9170, recall: 0.6164, f1: 0.7372, time: 0.070s
First attempt - auc_train: 0.8821503839 acc_train: 0.8269036203
y_pred: tensor([0.1158, 0.0827, 0.0748,  ..., 0.9861, 0.9845, 0.9795])
负样本数量： 13976
正样本数量： 9654
TP:  6118
TN:  13299
FP:  677
FN:  3536
y_pred: tensor([0.1154, 0.0836, 0.0757,  ..., 0.3125, 0.3190, 0.1314])
负样本数量： 9865
正样本数量： 6502
TP:  4183
TN:  9402
FP:  463
FN:  2319
First attempt - auc_val: 0.8874676463 acc_val: 0.8217096911
Epoch: 0016 loss_train: 0.3821695626 auc_train: 0.8852057190 acc_train: 0.8268779442 precision_train: 0.9216873527 recall_train: 0.5959737953 f1_train: 0.7237791893 loss_val: 0.3866555095 auc_val: 0.8873370351 acc_val: 0.8258667598 precision_val: 0.9003561499 recall_val: 0.6385337316 f1_val: 0.7471617593 time: 0.5911s
Best model so far, saving...
Epoch 0016: val_loss 没有改善 0.386656，最佳值 0.387368，等待 1/15
y_pred: tensor([0.1172, 0.0852, 0.0735,  ..., 0.1480, 0.0788, 0.3686],
       grad_fn=<IndexBackward0>)
负样本数量： 14057
正样本数量： 8906
TP:  5686
TN:  13450
FP:  607
FN:  3220
batch idx: 0, loss: 0.377040 auc: 0.8897, acc: 0.8333, precision: 0.9035, recall: 0.6384, f1: 0.7482, time: 0.093s
y_pred: tensor([0.1149, 0.2655, 0.1857,  ..., 0.9830, 0.9838, 0.9846],
       grad_fn=<IndexBackward0>)
负样本数量： 14550
正样本数量： 8533
TP:  4043
TN:  14351
FP:  199
FN:  4490
batch idx: 1, loss: 0.410778 auc: 0.8777, acc: 0.7969, precision: 0.9531, recall: 0.4738, f1: 0.6330, time: 0.094s
y_pred: tensor([0.5784, 0.6233, 0.6490,  ..., 0.1092, 0.0762, 0.0858],
       grad_fn=<IndexBackward0>)
负样本数量： 14487
正样本数量： 8715
TP:  5588
TN:  13650
FP:  837
FN:  3127
batch idx: 2, loss: 0.392460 auc: 0.8836, acc: 0.8292, precision: 0.8697, recall: 0.6412, f1: 0.7382, time: 0.096s
y_pred: tensor([0.0991, 0.0728, 0.0665,  ..., 0.7478, 0.8920, 0.9400],
       grad_fn=<IndexBackward0>)
负样本数量： 14064
正样本数量： 8984
TP:  5733
TN:  13296
FP:  768
FN:  3251
batch idx: 3, loss: 0.392863 auc: 0.8841, acc: 0.8256, precision: 0.8819, recall: 0.6381, f1: 0.7405, time: 0.095s
y_pred: tensor([0.6082, 0.6191, 0.6274,  ..., 0.0662, 0.0643, 0.0633],
       grad_fn=<IndexBackward0>)
负样本数量： 2829
正样本数量： 1654
TP:  900
TN:  2759
FP:  70
FN:  754
batch idx: 4, loss: 0.391639 auc: 0.8849, acc: 0.8162, precision: 0.9278, recall: 0.5441, f1: 0.6860, time: 0.069s
First attempt - auc_train: 0.8897186603 acc_train: 0.8333405914
y_pred: tensor([0.2116, 0.1463, 0.2775,  ..., 0.0739, 0.0742, 0.0718])
负样本数量： 13691
正样本数量： 9834
TP:  5461
TN:  13362
FP:  329
FN:  4373
y_pred: tensor([0.5889, 0.5131, 0.1820,  ..., 0.6467, 0.7445, 0.7607])
负样本数量： 10150
正样本数量： 6322
TP:  3267
TN:  9998
FP:  152
FN:  3055
First attempt - auc_val: 0.8895266233 acc_val: 0.8001275239
Epoch: 0017 loss_train: 0.3929560840 auc_train: 0.8840195410 acc_train: 0.8202352078 precision_train: 0.9072117585 recall_train: 0.5871433595 f1_train: 0.7091546483 loss_val: 0.4051129073 auc_val: 0.8834484685 acc_val: 0.8027167488 precision_val: 0.9493602246 recall_val: 0.5360425647 f1_val: 0.6849128803 time: 0.5953s
Epoch 0017: val_loss 没有改善 0.405113，最佳值 0.387368，等待 2/15
y_pred: tensor([0.1217, 0.0773, 0.0758,  ..., 0.2015, 0.2022, 0.2097],
       grad_fn=<IndexBackward0>)
负样本数量： 13872
正样本数量： 8612
TP:  4493
TN:  13724
FP:  148
FN:  4119
batch idx: 0, loss: 0.398222 auc: 0.8839, acc: 0.8102, precision: 0.9681, recall: 0.5217, f1: 0.6780, time: 0.092s
y_pred: tensor([0.1036, 0.0720, 0.0606,  ..., 0.9820, 0.9832, 0.9839],
       grad_fn=<IndexBackward0>)
负样本数量： 14474
正样本数量： 8796
TP:  5329
TN:  14043
FP:  431
FN:  3467
batch idx: 1, loss: 0.378300 auc: 0.8858, acc: 0.8325, precision: 0.9252, recall: 0.6058, f1: 0.7322, time: 0.095s
y_pred: tensor([0.4897, 0.5027, 0.1850,  ..., 0.9827, 0.9902, 0.9773],
       grad_fn=<IndexBackward0>)
负样本数量： 14173
正样本数量： 8586
TP:  5558
TN:  13243
FP:  930
FN:  3028
batch idx: 2, loss: 0.400574 auc: 0.8818, acc: 0.8261, precision: 0.8567, recall: 0.6473, f1: 0.7374, time: 0.095s
y_pred: tensor([0.0974, 0.0728, 0.0620,  ..., 0.9827, 0.9777, 0.9829],
       grad_fn=<IndexBackward0>)
负样本数量： 14365
正样本数量： 8891
TP:  5543
TN:  13727
FP:  638
FN:  3348
batch idx: 3, loss: 0.382575 auc: 0.8852, acc: 0.8286, precision: 0.8968, recall: 0.6234, f1: 0.7355, time: 0.094s
y_pred: tensor([0.5104, 0.5078, 0.5077,  ..., 0.9812, 0.9809, 0.9821],
       grad_fn=<IndexBackward0>)
负样本数量： 3103
正样本数量： 1907
TP:  1056
TN:  3042
FP:  61
FN:  851
batch idx: 4, loss: 0.381017 auc: 0.8888, acc: 0.8180, precision: 0.9454, recall: 0.5537, f1: 0.6984, time: 0.069s
First attempt - auc_train: 0.8839046925 acc_train: 0.8102206013
y_pred: tensor([0.5637, 0.5933, 0.4734,  ..., 0.4227, 0.5128, 0.6235])
负样本数量： 14051
正样本数量： 9627
TP:  5417
TN:  13745
FP:  306
FN:  4210
y_pred: tensor([0.2108, 0.3028, 0.2281,  ..., 0.9751, 0.9865, 0.9839])
负样本数量： 9790
正样本数量： 6529
TP:  3654
TN:  9619
FP:  171
FN:  2875
First attempt - auc_val: 0.8853501938 acc_val: 0.8092744320
Epoch: 0018 loss_train: 0.3881375194 auc_train: 0.8851094617 acc_train: 0.8230734008 precision_train: 0.9184224542 recall_train: 0.5904158196 f1_train: 0.7163238578 loss_val: 0.3959252089 auc_val: 0.8858222031 acc_val: 0.8113104190 precision_val: 0.9509128285 recall_val: 0.5611725939 f1_val: 0.7058061118 time: 0.5940s
Epoch 0018: val_loss 没有改善 0.395925，最佳值 0.387368，等待 3/15
y_pred: tensor([0.1141, 0.1114, 0.4097,  ..., 0.9812, 0.9877, 0.9780],
       grad_fn=<IndexBackward0>)
负样本数量： 14316
正样本数量： 8579
TP:  4654
TN:  14149
FP:  167
FN:  3925
batch idx: 0, loss: 0.384131 auc: 0.8874, acc: 0.8213, precision: 0.9654, recall: 0.5425, f1: 0.6946, time: 0.094s
y_pred: tensor([0.1158, 0.0803, 0.0622,  ..., 0.1974, 0.2838, 0.2545],
       grad_fn=<IndexBackward0>)
负样本数量： 14350
正样本数量： 8928
TP:  5118
TN:  14110
FP:  240
FN:  3810
batch idx: 1, loss: 0.378144 auc: 0.8896, acc: 0.8260, precision: 0.9552, recall: 0.5733, f1: 0.7165, time: 0.093s
y_pred: tensor([0.1966, 0.3766, 0.3915,  ..., 0.8353, 0.9006, 0.9079],
       grad_fn=<IndexBackward0>)
负样本数量： 14740
正样本数量： 8692
TP:  5295
TN:  14184
FP:  556
FN:  3397
batch idx: 2, loss: 0.376747 auc: 0.8880, acc: 0.8313, precision: 0.9050, recall: 0.6092, f1: 0.7282, time: 0.096s
y_pred: tensor([0.1208, 0.0770, 0.0699,  ..., 0.9774, 0.9791, 0.9824],
       grad_fn=<IndexBackward0>)
负样本数量： 13757
正样本数量： 8910
TP:  5650
TN:  12989
FP:  768
FN:  3260
batch idx: 3, loss: 0.401552 auc: 0.8779, acc: 0.8223, precision: 0.8803, recall: 0.6341, f1: 0.7372, time: 0.096s
y_pred: tensor([0.1200, 0.0875, 0.0750,  ..., 0.9844, 0.9825, 0.9897],
       grad_fn=<IndexBackward0>)
负样本数量： 2824
正样本数量： 1683
TP:  1022
TN:  2639
FP:  185
FN:  661
batch idx: 4, loss: 0.426452 auc: 0.8674, acc: 0.8123, precision: 0.8467, recall: 0.6072, f1: 0.7073, time: 0.071s
First attempt - auc_train: 0.8873549463 acc_train: 0.8212710199
y_pred: tensor([0.5742, 0.5789, 0.5894,  ..., 0.2603, 0.2756, 0.2788])
负样本数量： 13941
正样本数量： 9541
TP:  5273
TN:  13707
FP:  234
FN:  4268
y_pred: tensor([0.1072, 0.0754, 0.0680,  ..., 0.7708, 0.7005, 0.8417])
负样本数量： 9900
正样本数量： 6615
TP:  3602
TN:  9737
FP:  163
FN:  3013
First attempt - auc_val: 0.8854420633 acc_val: 0.8082786815
Epoch: 0019 loss_train: 0.3934054613 auc_train: 0.8820478641 acc_train: 0.8226349600 precision_train: 0.9105209073 recall_train: 0.5932577882 f1_train: 0.7167594593 loss_val: 0.3961021751 auc_val: 0.8861093975 acc_val: 0.8079843302 precision_val: 0.9571075663 recall_val: 0.5485937328 f1_val: 0.6974255024 time: 0.5995s
Epoch 0019: val_loss 没有改善 0.396102，最佳值 0.387368，等待 4/15
y_pred: tensor([0.1974, 0.1661, 0.1389,  ..., 0.8583, 0.7787, 0.8589],
       grad_fn=<IndexBackward0>)
负样本数量： 14473
正样本数量： 8931
TP:  4824
TN:  14329
FP:  144
FN:  4107
batch idx: 0, loss: 0.385172 auc: 0.8893, acc: 0.8184, precision: 0.9710, recall: 0.5401, f1: 0.6942, time: 0.094s
y_pred: tensor([0.4526, 0.4645, 0.2183,  ..., 0.9854, 0.9749, 0.9847],
       grad_fn=<IndexBackward0>)
负样本数量： 14188
正样本数量： 9085
TP:  4893
TN:  14052
FP:  136
FN:  4192
batch idx: 1, loss: 0.385617 auc: 0.8931, acc: 0.8140, precision: 0.9730, recall: 0.5386, f1: 0.6934, time: 0.099s
y_pred: tensor([0.5379, 0.4289, 0.1782,  ..., 0.9825, 0.9850, 0.9861],
       grad_fn=<IndexBackward0>)
负样本数量： 13743
正样本数量： 8638
TP:  4664
TN:  13574
FP:  169
FN:  3974
batch idx: 2, loss: 0.391414 auc: 0.8836, acc: 0.8149, precision: 0.9650, recall: 0.5399, f1: 0.6925, time: 0.100s
y_pred: tensor([0.2009, 0.1320, 0.1215,  ..., 0.9189, 0.9153, 0.9449],
       grad_fn=<IndexBackward0>)
负样本数量： 14638
正样本数量： 8524
TP:  4750
TN:  14291
FP:  347
FN:  3774
batch idx: 3, loss: 0.386079 auc: 0.8806, acc: 0.8221, precision: 0.9319, recall: 0.5573, f1: 0.6975, time: 0.099s
y_pred: tensor([0.1154, 0.0768, 0.0629,  ..., 0.9744, 0.5017, 0.4907],
       grad_fn=<IndexBackward0>)
负样本数量： 2945
正样本数量： 1614
TP:  933
TN:  2820
FP:  125
FN:  681
batch idx: 4, loss: 0.401259 auc: 0.8732, acc: 0.8232, precision: 0.8819, recall: 0.5781, f1: 0.6984, time: 0.072s
First attempt - auc_train: 0.8893091467 acc_train: 0.8183643822
y_pred: tensor([0.5985, 0.6103, 0.6307,  ..., 0.9628, 0.9809, 0.9776])
负样本数量： 13856
正样本数量： 9714
TP:  6247
TN:  13276
FP:  580
FN:  3467
y_pred: tensor([0.1125, 0.0825, 0.0711,  ..., 0.4803, 0.7564, 0.8180])
负样本数量： 9985
正样本数量： 6442
TP:  3944
TN:  9584
FP:  401
FN:  2498
First attempt - auc_val: 0.8914295153 acc_val: 0.8282986848
Epoch: 0020 loss_train: 0.3899080694 auc_train: 0.8839541155 acc_train: 0.8185143101 precision_train: 0.9445553408 recall_train: 0.5507955983 f1_train: 0.6951521961 loss_val: 0.3897050619 auc_val: 0.8861618067 acc_val: 0.8259104674 precision_val: 0.9113766111 recall_val: 0.6276623350 f1_val: 0.7432929035 time: 0.6232s
Epoch 0020: val_loss 没有改善 0.389705，最佳值 0.387368，等待 5/15
y_pred: tensor([0.1152, 0.0872, 0.0933,  ..., 0.6793, 0.6787, 0.6999],
       grad_fn=<IndexBackward0>)
负样本数量： 14528
正样本数量： 8304
TP:  4880
TN:  14064
FP:  464
FN:  3424
batch idx: 0, loss: 0.379412 auc: 0.8845, acc: 0.8297, precision: 0.9132, recall: 0.5877, f1: 0.7151, time: 0.092s
y_pred: tensor([0.2048, 0.1364, 0.1242,  ..., 0.4852, 0.4078, 0.5178],
       grad_fn=<IndexBackward0>)
负样本数量： 14206
正样本数量： 8774
TP:  5433
TN:  13701
FP:  505
FN:  3341
batch idx: 1, loss: 0.375580 auc: 0.8878, acc: 0.8326, precision: 0.9150, recall: 0.6192, f1: 0.7386, time: 0.097s
y_pred: tensor([0.2018, 0.1533, 0.1327,  ..., 0.4839, 0.5131, 0.5059],
       grad_fn=<IndexBackward0>)
负样本数量： 14057
正样本数量： 8979
TP:  5474
TN:  13651
FP:  406
FN:  3505
batch idx: 2, loss: 0.375573 auc: 0.8906, acc: 0.8302, precision: 0.9310, recall: 0.6096, f1: 0.7368, time: 0.109s
y_pred: tensor([0.1986, 0.1398, 0.3986,  ..., 0.0627, 0.0643, 0.0663],
       grad_fn=<IndexBackward0>)
负样本数量： 14270
正样本数量： 8874
TP:  5167
TN:  13884
FP:  386
FN:  3707
batch idx: 3, loss: 0.385429 auc: 0.8821, acc: 0.8232, precision: 0.9305, recall: 0.5823, f1: 0.7163, time: 0.097s
y_pred: tensor([0.1147, 0.0784, 0.0673,  ..., 0.9887, 0.9886, 0.9856],
       grad_fn=<IndexBackward0>)
负样本数量： 2926
正样本数量： 1861
TP:  1051
TN:  2865
FP:  61
FN:  810
batch idx: 4, loss: 0.391026 auc: 0.8824, acc: 0.8180, precision: 0.9451, recall: 0.5648, f1: 0.7070, time: 0.069s
First attempt - auc_train: 0.8844960804 acc_train: 0.8297126840
y_pred: tensor([0.1166, 0.0821, 0.0694,  ..., 0.9779, 0.9845, 0.9793])
负样本数量： 14024
正样本数量： 9563
TP:  5467
TN:  13783
FP:  241
FN:  4096
y_pred: tensor([0.5769, 0.5830, 0.5912,  ..., 0.9665, 0.9796, 0.9846])
负样本数量： 9817
正样本数量： 6593
TP:  3828
TN:  9585
FP:  232
FN:  2765
First attempt - auc_val: 0.8890295003 acc_val: 0.8161275279
Epoch: 0021 loss_train: 0.3814039469 auc_train: 0.8854750112 acc_train: 0.8267543223 precision_train: 0.9269424946 recall_train: 0.5927084219 f1_train: 0.7227644264 loss_val: 0.3880583197 auc_val: 0.8869850841 acc_val: 0.8167474934 precision_val: 0.9503178496 recall_val: 0.5761491655 f1_val: 0.7173342198 time: 0.6232s
Epoch 0021: val_loss 没有改善 0.388058，最佳值 0.387368，等待 6/15
y_pred: tensor([0.2059, 0.1554, 0.1304,  ..., 0.9721, 0.9661, 0.9821],
       grad_fn=<IndexBackward0>)
负样本数量： 13903
正样本数量： 9108
TP:  5091
TN:  13725
FP:  178
FN:  4017
batch idx: 0, loss: 0.386388 auc: 0.8882, acc: 0.8177, precision: 0.9662, recall: 0.5590, f1: 0.7082, time: 0.099s
y_pred: tensor([0.2005, 0.1415, 0.1292,  ..., 0.9805, 0.9770, 0.9872],
       grad_fn=<IndexBackward0>)
负样本数量： 14396
正样本数量： 8436
TP:  4684
TN:  14196
FP:  200
FN:  3752
batch idx: 1, loss: 0.374272 auc: 0.8890, acc: 0.8269, precision: 0.9590, recall: 0.5552, f1: 0.7033, time: 0.102s
y_pred: tensor([0.1136, 0.0815, 0.0717,  ..., 0.8648, 0.8883, 0.9279],
       grad_fn=<IndexBackward0>)
负样本数量： 14632
正样本数量： 8209
TP:  4688
TN:  14377
FP:  255
FN:  3521
batch idx: 2, loss: 0.371292 auc: 0.8861, acc: 0.8347, precision: 0.9484, recall: 0.5711, f1: 0.7129, time: 0.097s
y_pred: tensor([0.2128, 0.3631, 0.3681,  ..., 0.7538, 0.9037, 0.9623],
       grad_fn=<IndexBackward0>)
负样本数量： 13877
正样本数量： 9328
TP:  5616
TN:  13494
FP:  383
FN:  3712
batch idx: 3, loss: 0.381494 auc: 0.8874, acc: 0.8235, precision: 0.9362, recall: 0.6021, f1: 0.7328, time: 0.098s
y_pred: tensor([0.1203, 0.0761, 0.0678,  ..., 0.9885, 0.9778, 0.9880],
       grad_fn=<IndexBackward0>)
负样本数量： 3179
正样本数量： 1711
TP:  1008
TN:  3031
FP:  148
FN:  703
batch idx: 4, loss: 0.392576 auc: 0.8730, acc: 0.8260, precision: 0.8720, recall: 0.5891, f1: 0.7032, time: 0.071s
First attempt - auc_train: 0.8881855284 acc_train: 0.8176958846
y_pred: tensor([0.5631, 0.4794, 0.1670,  ..., 0.9804, 0.9860, 0.9745])
负样本数量： 13956
正样本数量： 9784
TP:  6225
TN:  13362
FP:  594
FN:  3559
y_pred: tensor([0.2021, 0.1513, 0.1382,  ..., 0.5806, 0.6124, 0.6380])
负样本数量： 9885
正样本数量： 6372
TP:  3953
TN:  9467
FP:  418
FN:  2419
First attempt - auc_val: 0.8898224031 acc_val: 0.8250631845
Epoch: 0022 loss_train: 0.3812041581 auc_train: 0.8847433416 acc_train: 0.8257579024 precision_train: 0.9363615395 recall_train: 0.5752933223 f1_train: 0.7120823333 loss_val: 0.3864264339 auc_val: 0.8874098743 acc_val: 0.8252768712 precision_val: 0.9086300813 recall_val: 0.6283066079 f1_val: 0.7428927736 time: 0.6135s
Best model so far, saving...
Epoch 0022: val_loss 没有改善 0.386426，最佳值 0.387368，等待 7/15
y_pred: tensor([0.2060, 0.1587, 0.1386,  ..., 0.9854, 0.9895, 0.9803],
       grad_fn=<IndexBackward0>)
负样本数量： 14595
正样本数量： 8669
TP:  5230
TN:  14112
FP:  483
FN:  3439
batch idx: 0, loss: 0.377154 auc: 0.8867, acc: 0.8314, precision: 0.9155, recall: 0.6033, f1: 0.7273, time: 0.098s
y_pred: tensor([0.1142, 0.0784, 0.0638,  ..., 0.1593, 0.1241, 0.6266],
       grad_fn=<IndexBackward0>)
负样本数量： 14153
正样本数量： 9129
TP:  5543
TN:  13650
FP:  503
FN:  3586
batch idx: 1, loss: 0.387601 auc: 0.8832, acc: 0.8244, precision: 0.9168, recall: 0.6072, f1: 0.7305, time: 0.096s
y_pred: tensor([0.5756, 0.4883, 0.1655,  ..., 0.9778, 0.9843, 0.9784],
       grad_fn=<IndexBackward0>)
负样本数量： 14092
正样本数量： 8843
TP:  5175
TN:  13826
FP:  266
FN:  3668
batch idx: 2, loss: 0.371950 auc: 0.8913, acc: 0.8285, precision: 0.9511, recall: 0.5852, f1: 0.7246, time: 0.096s
y_pred: tensor([0.1326, 0.0978, 0.2251,  ..., 0.0553, 0.0497, 0.2086],
       grad_fn=<IndexBackward0>)
负样本数量： 14215
正样本数量： 8339
TP:  4727
TN:  14018
FP:  197
FN:  3612
batch idx: 3, loss: 0.371597 auc: 0.8888, acc: 0.8311, precision: 0.9600, recall: 0.5669, f1: 0.7128, time: 0.094s
y_pred: tensor([0.2058, 0.3338, 0.3169,  ..., 0.9887, 0.9829, 0.9859],
       grad_fn=<IndexBackward0>)
负样本数量： 2932
正样本数量： 1812
TP:  989
TN:  2907
FP:  25
FN:  823
batch idx: 4, loss: 0.381574 auc: 0.8860, acc: 0.8212, precision: 0.9753, recall: 0.5458, f1: 0.6999, time: 0.069s
First attempt - auc_train: 0.8866876303 acc_train: 0.8314133425
y_pred: tensor([0.2000, 0.1491, 0.1344,  ..., 0.9788, 0.9884, 0.9838])
负样本数量： 13715
正样本数量： 9643
TP:  5774
TN:  13402
FP:  313
FN:  3869
y_pred: tensor([0.2006, 0.1493, 0.1340,  ..., 0.9860, 0.9836, 0.9870])
负样本数量： 10126
正样本数量： 6513
TP:  3794
TN:  9869
FP:  257
FN:  2719
First attempt - auc_val: 0.8895860189 acc_val: 0.8209606987
Epoch: 0023 loss_train: 0.3779752851 auc_train: 0.8871786836 acc_train: 0.8273240386 precision_train: 0.9437418897 recall_train: 0.5816707842 f1_train: 0.7190335842 loss_val: 0.3844538480 auc_val: 0.8871086395 acc_val: 0.8210518981 precision_val: 0.9425689065 recall_val: 0.5906517838 f1_val: 0.7262135579 time: 0.6015s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0023: val_loss 改善从 0.384454 到 0.384454
y_pred: tensor([0.5281, 0.5333, 0.5601,  ..., 0.9824, 0.9813, 0.9869],
       grad_fn=<IndexBackward0>)
负样本数量： 14577
正样本数量： 8633
TP:  5108
TN:  14318
FP:  259
FN:  3525
batch idx: 0, loss: 0.363600 auc: 0.8923, acc: 0.8370, precision: 0.9517, recall: 0.5917, f1: 0.7297, time: 0.095s
y_pred: tensor([0.4289, 0.3397, 0.1512,  ..., 0.9892, 0.9899, 0.9902],
       grad_fn=<IndexBackward0>)
负样本数量： 14179
正样本数量： 8876
TP:  5282
TN:  13857
FP:  322
FN:  3594
batch idx: 1, loss: 0.379390 auc: 0.8856, acc: 0.8301, precision: 0.9425, recall: 0.5951, f1: 0.7296, time: 0.096s
y_pred: tensor([0.5318, 0.4413, 0.4696,  ..., 0.1720, 0.1682, 0.1696],
       grad_fn=<IndexBackward0>)
负样本数量： 13408
正样本数量： 9032
TP:  5496
TN:  12966
FP:  442
FN:  3536
batch idx: 2, loss: 0.383154 auc: 0.8872, acc: 0.8227, precision: 0.9256, recall: 0.6085, f1: 0.7343, time: 0.095s
y_pred: tensor([0.2126, 0.2980, 0.2322,  ..., 0.9835, 0.9833, 0.9851],
       grad_fn=<IndexBackward0>)
负样本数量： 14881
正样本数量： 8285
TP:  4803
TN:  14442
FP:  439
FN:  3482
batch idx: 3, loss: 0.376239 auc: 0.8834, acc: 0.8307, precision: 0.9163, recall: 0.5797, f1: 0.7101, time: 0.093s
y_pred: tensor([0.0973, 0.0706, 0.0672,  ..., 0.9895, 0.9881, 0.9767],
       grad_fn=<IndexBackward0>)
负样本数量： 2942
正样本数量： 1966
TP:  1222
TN:  2877
FP:  65
FN:  744
batch idx: 4, loss: 0.362329 auc: 0.8971, acc: 0.8352, precision: 0.9495, recall: 0.6216, f1: 0.7513, time: 0.069s
First attempt - auc_train: 0.8923271692 acc_train: 0.8369668246
y_pred: tensor([0.1129, 0.0820, 0.0706,  ..., 0.1208, 0.1202, 0.1178])
负样本数量： 14174
正样本数量： 9062
TP:  5396
TN:  13823
FP:  351
FN:  3666
y_pred: tensor([0.1221, 0.0939, 0.0872,  ..., 0.0946, 0.0951, 0.0917])
负样本数量： 9667
正样本数量： 7094
TP:  4372
TN:  9350
FP:  317
FN:  2722
First attempt - auc_val: 0.8890331307 acc_val: 0.8271217077
Epoch: 0024 loss_train: 0.3729425013 auc_train: 0.8891047970 acc_train: 0.8311499614 precision_train: 0.9371191242 recall_train: 0.5993126153 f1_train: 0.7309965210 loss_val: 0.3832767606 auc_val: 0.8876831215 acc_val: 0.8229039718 precision_val: 0.9356598116 recall_val: 0.6058745016 f1_val: 0.7354160445 time: 0.5961s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0024: val_loss 改善从 0.383277 到 0.383277
y_pred: tensor([0.4414, 0.2129, 0.1099,  ..., 0.9815, 0.9809, 0.9758],
       grad_fn=<IndexBackward0>)
负样本数量： 14920
正样本数量： 8167
TP:  4659
TN:  14610
FP:  310
FN:  3508
batch idx: 0, loss: 0.370350 auc: 0.8846, acc: 0.8346, precision: 0.9376, recall: 0.5705, f1: 0.7093, time: 0.266s
y_pred: tensor([0.1993, 0.1567, 0.1343,  ..., 0.0654, 0.0582, 0.0632],
       grad_fn=<IndexBackward0>)
负样本数量： 13946
正样本数量： 8617
TP:  4978
TN:  13680
FP:  266
FN:  3639
batch idx: 1, loss: 0.375165 auc: 0.8876, acc: 0.8269, precision: 0.9493, recall: 0.5777, f1: 0.7183, time: 0.275s
y_pred: tensor([0.7035, 0.6198, 0.1357,  ..., 0.9789, 0.9740, 0.9843],
       grad_fn=<IndexBackward0>)
负样本数量： 14344
正样本数量： 8591
TP:  4961
TN:  14097
FP:  247
FN:  3630
batch idx: 2, loss: 0.378183 auc: 0.8823, acc: 0.8310, precision: 0.9526, recall: 0.5775, f1: 0.7190, time: 0.160s
y_pred: tensor([0.2204, 0.1519, 0.1418,  ..., 0.9838, 0.9819, 0.9870],
       grad_fn=<IndexBackward0>)
负样本数量： 13822
正样本数量： 9473
TP:  5566
TN:  13625
FP:  197
FN:  3907
batch idx: 3, loss: 0.373950 auc: 0.8960, acc: 0.8238, precision: 0.9658, recall: 0.5876, f1: 0.7306, time: 0.125s
y_pred: tensor([0.1001, 0.2869, 0.1784,  ..., 0.9893, 0.9824, 0.9834],
       grad_fn=<IndexBackward0>)
负样本数量： 2955
正样本数量： 1944
TP:  1185
TN:  2886
FP:  69
FN:  759
batch idx: 4, loss: 0.371629 auc: 0.8956, acc: 0.8310, precision: 0.9450, recall: 0.6096, f1: 0.7411, time: 0.087s
First attempt - auc_train: 0.8845689315 acc_train: 0.8346255468
y_pred: tensor([0.1215, 0.0929, 0.2987,  ..., 0.2212, 0.2257, 0.1513])
负样本数量： 13740
正样本数量： 9719
TP:  6096
TN:  13270
FP:  470
FN:  3623
y_pred: tensor([0.1984, 0.1522, 0.1372,  ..., 0.9861, 0.9881, 0.9906])
负样本数量： 10101
正样本数量： 6437
TP:  3890
TN:  9814
FP:  287
FN:  2547
First attempt - auc_val: 0.8877124191 acc_val: 0.8255253847
Epoch: 0025 loss_train: 0.3738552332 auc_train: 0.8892145433 acc_train: 0.8294644826 precision_train: 0.9500508041 recall_train: 0.5845518225 f1_train: 0.7236772809 loss_val: 0.3811202198 auc_val: 0.8887722169 acc_val: 0.8270812315 precision_val: 0.9298547643 recall_val: 0.6157719026 f1_val: 0.7408292869 time: 1.0859s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0025: val_loss 改善从 0.381120 到 0.381120
y_pred: tensor([0.1256, 0.0875, 0.0865,  ..., 0.9733, 0.9886, 0.9857],
       grad_fn=<IndexBackward0>)
负样本数量： 13795
正样本数量： 9032
TP:  5532
TN:  13378
FP:  417
FN:  3500
batch idx: 0, loss: 0.372498 auc: 0.8923, acc: 0.8284, precision: 0.9299, recall: 0.6125, f1: 0.7385, time: 0.115s
y_pred: tensor([0.1997, 0.1625, 0.1359,  ..., 0.1085, 0.1047, 0.1979],
       grad_fn=<IndexBackward0>)
负样本数量： 14411
正样本数量： 8741
TP:  5239
TN:  14014
FP:  397
FN:  3502
batch idx: 1, loss: 0.375587 auc: 0.8856, acc: 0.8316, precision: 0.9296, recall: 0.5994, f1: 0.7288, time: 0.122s
y_pred: tensor([0.1624, 0.3081, 0.1595,  ..., 0.6813, 0.8425, 0.9378],
       grad_fn=<IndexBackward0>)
负样本数量： 14927
正样本数量： 7916
TP:  4470
TN:  14542
FP:  385
FN:  3446
batch idx: 2, loss: 0.377135 auc: 0.8790, acc: 0.8323, precision: 0.9207, recall: 0.5647, f1: 0.7000, time: 0.122s
y_pred: tensor([0.0899, 0.2350, 0.2133,  ..., 0.2122, 0.1533, 0.0973],
       grad_fn=<IndexBackward0>)
负样本数量： 13858
正样本数量： 9224
TP:  5588
TN:  13560
FP:  298
FN:  3636
batch idx: 3, loss: 0.369896 auc: 0.8947, acc: 0.8296, precision: 0.9494, recall: 0.6058, f1: 0.7396, time: 0.135s
y_pred: tensor([0.1189, 0.0820, 0.0626,  ..., 0.9881, 0.9846, 0.9857],
       grad_fn=<IndexBackward0>)
负样本数量： 2996
正样本数量： 1879
TP:  1083
TN:  2951
FP:  45
FN:  796
batch idx: 4, loss: 0.374580 auc: 0.8884, acc: 0.8275, precision: 0.9601, recall: 0.5764, f1: 0.7203, time: 0.101s
First attempt - auc_train: 0.8922722632 acc_train: 0.8284049590
y_pred: tensor([0.4523, 0.1739, 0.1096,  ..., 0.9203, 0.9761, 0.9762])
负样本数量： 13840
正样本数量： 9661
TP:  5721
TN:  13508
FP:  332
FN:  3940
y_pred: tensor([0.4529, 0.1682, 0.2544,  ..., 0.9824, 0.9766, 0.9897])
负样本数量： 10001
正样本数量： 6495
TP:  3928
TN:  9755
FP:  246
FN:  2567
First attempt - auc_val: 0.8880024185 acc_val: 0.8182205013
Epoch: 0026 loss_train: 0.3739390552 auc_train: 0.8879751869 acc_train: 0.8298675007 precision_train: 0.9379284478 recall_train: 0.5917417476 f1_train: 0.7254647588 loss_val: 0.3797879815 auc_val: 0.8889669552 acc_val: 0.8238471565 precision_val: 0.9431074463 recall_val: 0.5984738127 f1_val: 0.7322397188 time: 0.8008s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0026: val_loss 改善从 0.379788 到 0.379788
y_pred: tensor([0.0859, 0.0649, 0.0632,  ..., 0.9824, 0.9865, 0.9913],
       grad_fn=<IndexBackward0>)
负样本数量： 14042
正样本数量： 8845
TP:  5176
TN:  13793
FP:  249
FN:  3669
batch idx: 0, loss: 0.377911 auc: 0.8859, acc: 0.8288, precision: 0.9541, recall: 0.5852, f1: 0.7254, time: 0.222s
y_pred: tensor([0.1869, 0.1374, 0.2787,  ..., 0.9825, 0.9812, 0.9763],
       grad_fn=<IndexBackward0>)
负样本数量： 14247
正样本数量： 8812
TP:  5247
TN:  13967
FP:  280
FN:  3565
batch idx: 1, loss: 0.367423 auc: 0.8924, acc: 0.8333, precision: 0.9493, recall: 0.5954, f1: 0.7319, time: 0.105s
y_pred: tensor([0.1745, 0.3302, 0.2764,  ..., 0.0661, 0.0650, 0.0644],
       grad_fn=<IndexBackward0>)
负样本数量： 14692
正样本数量： 8646
TP:  5105
TN:  14305
FP:  387
FN:  3541
batch idx: 2, loss: 0.371900 auc: 0.8862, acc: 0.8317, precision: 0.9295, recall: 0.5904, f1: 0.7222, time: 0.103s
y_pred: tensor([0.4957, 0.1663, 0.3011,  ..., 0.9353, 0.9748, 0.3764],
       grad_fn=<IndexBackward0>)
负样本数量： 14190
正样本数量： 8766
TP:  5339
TN:  13772
FP:  418
FN:  3427
batch idx: 3, loss: 0.372321 auc: 0.8891, acc: 0.8325, precision: 0.9274, recall: 0.6091, f1: 0.7352, time: 0.106s
y_pred: tensor([0.3303, 0.1327, 0.2876,  ..., 0.0700, 0.0661, 0.0579],
       grad_fn=<IndexBackward0>)
负样本数量： 2816
正样本数量： 1723
TP:  1041
TN:  2743
FP:  73
FN:  682
batch idx: 4, loss: 0.363304 auc: 0.8975, acc: 0.8337, precision: 0.9345, recall: 0.6042, f1: 0.7339, time: 0.097s
First attempt - auc_train: 0.8858865300 acc_train: 0.8288111155
y_pred: tensor([0.2053, 0.1539, 0.2998,  ..., 0.9825, 0.9818, 0.9759])
负样本数量： 14207
正样本数量： 9534
TP:  5628
TN:  13896
FP:  311
FN:  3906
y_pred: tensor([0.1145, 0.0787, 0.0654,  ..., 0.9791, 0.9843, 0.9839])
负样本数量： 9634
正样本数量： 6622
TP:  3947
TN:  9411
FP:  223
FN:  2675
First attempt - auc_val: 0.8856872956 acc_val: 0.8223747947
Epoch: 0027 loss_train: 0.3705715895 auc_train: 0.8902332616 acc_train: 0.8319850426 precision_train: 0.9389675944 recall_train: 0.5968620684 f1_train: 0.7297153476 loss_val: 0.3810394406 auc_val: 0.8888818246 acc_val: 0.8220510784 precision_val: 0.9470785318 recall_val: 0.5931759307 f1_val: 0.7294642460 time: 0.8020s
Epoch 0027: val_loss 没有改善 0.381039，最佳值 0.379788，等待 1/15
y_pred: tensor([0.2136, 0.3400, 0.3135,  ..., 0.9866, 0.9902, 0.9880],
       grad_fn=<IndexBackward0>)
负样本数量： 14025
正样本数量： 9141
TP:  5433
TN:  13818
FP:  207
FN:  3708
batch idx: 0, loss: 0.364435 auc: 0.8967, acc: 0.8310, precision: 0.9633, recall: 0.5944, f1: 0.7351, time: 0.093s
y_pred: tensor([0.4773, 0.4873, 0.4892,  ..., 0.8109, 0.8952, 0.9347],
       grad_fn=<IndexBackward0>)
负样本数量： 14065
正样本数量： 9077
TP:  5319
TN:  13790
FP:  275
FN:  3758
batch idx: 1, loss: 0.379321 auc: 0.8862, acc: 0.8257, precision: 0.9508, recall: 0.5860, f1: 0.7251, time: 0.095s
y_pred: tensor([0.1102, 0.0798, 0.0613,  ..., 0.2558, 0.1399, 0.4272],
       grad_fn=<IndexBackward0>)
负样本数量： 14790
正样本数量： 8105
TP:  4653
TN:  14530
FP:  260
FN:  3452
batch idx: 2, loss: 0.369050 auc: 0.8844, acc: 0.8379, precision: 0.9471, recall: 0.5741, f1: 0.7149, time: 0.098s
y_pred: tensor([0.6339, 0.5186, 0.6462,  ..., 0.9910, 0.9909, 0.9882],
       grad_fn=<IndexBackward0>)
负样本数量： 14334
正样本数量： 8617
TP:  5067
TN:  14055
FP:  279
FN:  3550
batch idx: 3, loss: 0.372115 auc: 0.8879, acc: 0.8332, precision: 0.9478, recall: 0.5880, f1: 0.7258, time: 0.094s
y_pred: tensor([0.0997, 0.0767, 0.2732,  ..., 0.9830, 0.9889, 0.9883],
       grad_fn=<IndexBackward0>)
负样本数量： 2773
正样本数量： 1852
TP:  1158
TN:  2680
FP:  93
FN:  694
batch idx: 4, loss: 0.366551 auc: 0.8950, acc: 0.8298, precision: 0.9257, recall: 0.6253, f1: 0.7464, time: 0.069s
First attempt - auc_train: 0.8966645353 acc_train: 0.8310023310
y_pred: tensor([0.1974, 0.3573, 0.3500,  ..., 0.9883, 0.9782, 0.9840])
负样本数量： 14089
正样本数量： 9481
TP:  5878
TN:  13634
FP:  455
FN:  3603
y_pred: tensor([0.1079, 0.0740, 0.0604,  ..., 0.9840, 0.9827, 0.9782])
负样本数量： 9752
正样本数量： 6675
TP:  4101
TN:  9445
FP:  307
FN:  2574
First attempt - auc_val: 0.8903803138 acc_val: 0.8278319898
Epoch: 0028 loss_train: 0.3702944100 auc_train: 0.8900399982 acc_train: 0.8315206247 precision_train: 0.9469376312 recall_train: 0.5935450766 f1_train: 0.7294485960 loss_val: 0.3816933185 auc_val: 0.8884580586 acc_val: 0.8262249984 precision_val: 0.9292540077 recall_val: 0.6171794091 f1_val: 0.7417221318 time: 0.6023s
Epoch 0028: val_loss 没有改善 0.381693，最佳值 0.379788，等待 2/15
y_pred: tensor([0.5873, 0.5095, 0.4328,  ..., 0.9909, 0.9879, 0.9929],
       grad_fn=<IndexBackward0>)
负样本数量： 14712
正样本数量： 8569
TP:  5109
TN:  14341
FP:  371
FN:  3460
batch idx: 0, loss: 0.370409 auc: 0.8864, acc: 0.8354, precision: 0.9323, recall: 0.5962, f1: 0.7273, time: 0.097s
y_pred: tensor([0.1082, 0.0698, 0.0563,  ..., 0.9873, 0.9899, 0.9872],
       grad_fn=<IndexBackward0>)
负样本数量： 14665
正样本数量： 8784
TP:  5260
TN:  14312
FP:  353
FN:  3524
batch idx: 1, loss: 0.365851 auc: 0.8929, acc: 0.8347, precision: 0.9371, recall: 0.5988, f1: 0.7307, time: 0.096s
y_pred: tensor([0.5253, 0.4271, 0.4287,  ..., 0.0668, 0.4716, 0.5096],
       grad_fn=<IndexBackward0>)
负样本数量： 14055
正样本数量： 8752
TP:  5186
TN:  13736
FP:  319
FN:  3566
batch idx: 2, loss: 0.371670 auc: 0.8911, acc: 0.8297, precision: 0.9421, recall: 0.5926, f1: 0.7275, time: 0.098s
y_pred: tensor([0.5661, 0.4383, 0.4163,  ..., 0.9827, 0.9910, 0.9903],
       grad_fn=<IndexBackward0>)
负样本数量： 13673
正样本数量： 8939
TP:  5299
TN:  13479
FP:  194
FN:  3640
batch idx: 3, loss: 0.375602 auc: 0.8873, acc: 0.8304, precision: 0.9647, recall: 0.5928, f1: 0.7343, time: 0.100s
y_pred: tensor([0.2060, 0.1378, 0.1296,  ..., 0.2971, 0.2177, 0.2216],
       grad_fn=<IndexBackward0>)
负样本数量： 2882
正样本数量： 1748
TP:  1033
TN:  2827
FP:  55
FN:  715
batch idx: 4, loss: 0.373831 auc: 0.8839, acc: 0.8337, precision: 0.9494, recall: 0.5910, f1: 0.7285, time: 0.083s
First attempt - auc_train: 0.8864060185 acc_train: 0.8354452128
y_pred: tensor([0.5844, 0.4372, 0.5738,  ..., 0.0577, 0.0591, 0.0574])
负样本数量： 14126
正样本数量： 9791
TP:  5824
TN:  13882
FP:  244
FN:  3967
y_pred: tensor([0.1752, 0.0973, 0.0690,  ..., 0.1183, 0.5333, 0.7206])
负样本数量： 9715
正样本数量： 6365
TP:  3570
TN:  9529
FP:  186
FN:  2795
First attempt - auc_val: 0.8892777353 acc_val: 0.8239327675
Epoch: 0029 loss_train: 0.3714724362 auc_train: 0.8883176541 acc_train: 0.8327805099 precision_train: 0.9451186163 recall_train: 0.5942683890 f1_train: 0.7296705611 loss_val: 0.3831154257 auc_val: 0.8880092682 acc_val: 0.8192735977 precision_val: 0.9551341453 recall_val: 0.5778559000 f1_val: 0.7199682131 time: 0.6435s
Epoch 0029: val_loss 没有改善 0.383115，最佳值 0.379788，等待 3/15
y_pred: tensor([0.5016, 0.4897, 0.3990,  ..., 0.5492, 0.5941, 0.4960],
       grad_fn=<IndexBackward0>)
负样本数量： 14475
正样本数量： 8709
TP:  5034
TN:  14266
FP:  209
FN:  3675
batch idx: 0, loss: 0.369063 auc: 0.8908, acc: 0.8325, precision: 0.9601, recall: 0.5780, f1: 0.7216, time: 0.098s
y_pred: tensor([0.5130, 0.4723, 0.4900,  ..., 0.9829, 0.9821, 0.9700],
       grad_fn=<IndexBackward0>)
负样本数量： 14253
正样本数量： 8546
TP:  4909
TN:  14064
FP:  189
FN:  3637
batch idx: 1, loss: 0.365308 auc: 0.8920, acc: 0.8322, precision: 0.9629, recall: 0.5744, f1: 0.7196, time: 0.101s
y_pred: tensor([0.1151, 0.0758, 0.0657,  ..., 0.9878, 0.9904, 0.9935],
       grad_fn=<IndexBackward0>)
负样本数量： 13802
正样本数量： 9025
TP:  5457
TN:  13490
FP:  312
FN:  3568
batch idx: 2, loss: 0.375630 auc: 0.8888, acc: 0.8300, precision: 0.9459, recall: 0.6047, f1: 0.7377, time: 0.095s
y_pred: tensor([0.4866, 0.1517, 0.0912,  ..., 0.9912, 0.9928, 0.9918],
       grad_fn=<IndexBackward0>)
负样本数量： 14374
正样本数量： 8669
TP:  5212
TN:  14038
FP:  336
FN:  3457
batch idx: 3, loss: 0.365761 auc: 0.8913, acc: 0.8354, precision: 0.9394, recall: 0.6012, f1: 0.7332, time: 0.101s
y_pred: tensor([0.1193, 0.0750, 0.2695,  ..., 0.9902, 0.9813, 0.9854],
       grad_fn=<IndexBackward0>)
负样本数量： 3083
正样本数量： 1843
TP:  1130
TN:  2983
FP:  100
FN:  713
batch idx: 4, loss: 0.380335 auc: 0.8802, acc: 0.8350, precision: 0.9187, recall: 0.6131, f1: 0.7354, time: 0.078s
First attempt - auc_train: 0.8907623206 acc_train: 0.8324706694
y_pred: tensor([0.5918, 0.5868, 0.5910,  ..., 0.4236, 0.4155, 0.5798])
负样本数量： 13908
正样本数量： 9414
TP:  5684
TN:  13532
FP:  376
FN:  3730
y_pred: tensor([0.2061, 0.1543, 0.1397,  ..., 0.0468, 0.1936, 0.1897])
负样本数量： 9933
正样本数量： 6742
TP:  4216
TN:  9665
FP:  268
FN:  2526
First attempt - auc_val: 0.8874996265 acc_val: 0.8239430581
Epoch: 0030 loss_train: 0.3712194383 auc_train: 0.8886149793 acc_train: 0.8330068408 precision_train: 0.9454237245 recall_train: 0.5942901538 f1_train: 0.7295153185 loss_val: 0.3789366484 auc_val: 0.8894542994 acc_val: 0.8281934181 precision_val: 0.9390928656 recall_val: 0.6145576654 f1_val: 0.7428825802 time: 0.6377s
Best model so far, saving...
Epoch 0030: val_loss 没有改善 0.378937，最佳值 0.379788，等待 4/15
y_pred: tensor([0.1862, 0.2840, 0.1882,  ..., 0.2823, 0.5168, 0.3498],
       grad_fn=<IndexBackward0>)
负样本数量： 14147
正样本数量： 8807
TP:  5246
TN:  13832
FP:  315
FN:  3561
batch idx: 0, loss: 0.372742 auc: 0.8869, acc: 0.8311, precision: 0.9434, recall: 0.5957, f1: 0.7302, time: 0.095s
y_pred: tensor([0.2105, 0.2958, 0.2257,  ..., 0.2812, 0.1522, 0.4627],
       grad_fn=<IndexBackward0>)
负样本数量： 14649
正样本数量： 8463
TP:  5019
TN:  14337
FP:  312
FN:  3444
batch idx: 1, loss: 0.362049 auc: 0.8931, acc: 0.8375, precision: 0.9415, recall: 0.5931, f1: 0.7277, time: 0.097s
y_pred: tensor([0.5539, 0.5270, 0.4708,  ..., 0.9905, 0.4511, 0.4130],
       grad_fn=<IndexBackward0>)
负样本数量： 13996
正样本数量： 9104
TP:  5388
TN:  13800
FP:  196
FN:  3716
batch idx: 2, loss: 0.369576 auc: 0.8923, acc: 0.8306, precision: 0.9649, recall: 0.5918, f1: 0.7337, time: 0.100s
y_pred: tensor([0.1354, 0.0779, 0.0712,  ..., 0.9779, 0.9785, 0.9700],
       grad_fn=<IndexBackward0>)
负样本数量： 14370
正样本数量： 8707
TP:  5054
TN:  14160
FP:  210
FN:  3653
batch idx: 3, loss: 0.367798 auc: 0.8918, acc: 0.8326, precision: 0.9601, recall: 0.5805, f1: 0.7235, time: 0.102s
y_pred: tensor([0.2035, 0.1557, 0.1406,  ..., 0.9849, 0.9898, 0.9898],
       grad_fn=<IndexBackward0>)
负样本数量： 2825
正样本数量： 1711
TP:  961
TN:  2766
FP:  59
FN:  750
batch idx: 4, loss: 0.389995 auc: 0.8770, acc: 0.8216, precision: 0.9422, recall: 0.5617, f1: 0.7038, time: 0.075s
First attempt - auc_train: 0.8869292741 acc_train: 0.8311405420
y_pred: tensor([0.4864, 0.1525, 0.0917,  ..., 0.9927, 0.9874, 0.9826])
负样本数量： 14005
正样本数量： 9673
TP:  5737
TN:  13676
FP:  329
FN:  3936
y_pred: tensor([0.4124, 0.3935, 0.3896,  ..., 0.9869, 0.9865, 0.9910])
负样本数量： 9836
正样本数量： 6483
TP:  3887
TN:  9635
FP:  201
FN:  2596
First attempt - auc_val: 0.8876854506 acc_val: 0.8198749894
Epoch: 0031 loss_train: 0.3724320233 auc_train: 0.8882204787 acc_train: 0.8307059667 precision_train: 0.9503985732 recall_train: 0.5845309552 f1_train: 0.7237743742 loss_val: 0.3788725138 auc_val: 0.8893088432 acc_val: 0.8242398417 precision_val: 0.9482974866 recall_val: 0.5963311404 f1_val: 0.7322126418 time: 0.6314s
Best model so far, saving...
Epoch 0031: val_loss 没有改善 0.378873，最佳值 0.379788，等待 5/15
y_pred: tensor([0.4157, 0.3134, 0.3254,  ..., 0.1682, 0.1724, 0.1673],
       grad_fn=<IndexBackward0>)
负样本数量： 14211
正样本数量： 8722
TP:  5082
TN:  13976
FP:  235
FN:  3640
batch idx: 0, loss: 0.373446 auc: 0.8880, acc: 0.8310, precision: 0.9558, recall: 0.5827, f1: 0.7240, time: 0.096s
y_pred: tensor([0.2472, 0.1594, 0.1395,  ..., 0.9774, 0.9853, 0.9823],
       grad_fn=<IndexBackward0>)
负样本数量： 15036
正样本数量： 8383
TP:  4874
TN:  14721
FP:  315
FN:  3509
batch idx: 1, loss: 0.368086 auc: 0.8852, acc: 0.8367, precision: 0.9393, recall: 0.5814, f1: 0.7182, time: 0.095s
y_pred: tensor([0.2025, 0.2994, 0.3117,  ..., 0.9880, 0.9855, 0.9900],
       grad_fn=<IndexBackward0>)
负样本数量： 14232
正样本数量： 8760
TP:  5256
TN:  13911
FP:  321
FN:  3504
batch idx: 2, loss: 0.367250 auc: 0.8908, acc: 0.8336, precision: 0.9424, recall: 0.6000, f1: 0.7332, time: 0.096s
y_pred: tensor([0.0864, 0.0700, 0.0575,  ..., 0.6148, 0.4993, 0.6294],
       grad_fn=<IndexBackward0>)
负样本数量： 13451
正样本数量： 9216
TP:  5653
TN:  13206
FP:  245
FN:  3563
batch idx: 3, loss: 0.364197 auc: 0.8975, acc: 0.8320, precision: 0.9585, recall: 0.6134, f1: 0.7480, time: 0.104s
y_pred: tensor([0.4168, 0.3704, 0.3812,  ..., 0.9887, 0.9840, 0.9875],
       grad_fn=<IndexBackward0>)
负样本数量： 3057
正样本数量： 1711
TP:  968
TN:  2992
FP:  65
FN:  743
batch idx: 4, loss: 0.373891 auc: 0.8839, acc: 0.8305, precision: 0.9371, recall: 0.5658, f1: 0.7055, time: 0.079s
First attempt - auc_train: 0.8880050207 acc_train: 0.8310295208
y_pred: tensor([0.0941, 0.0683, 0.0612,  ..., 0.2985, 0.2105, 0.4124])
负样本数量： 14096
正样本数量： 9244
TP:  5442
TN:  13753
FP:  343
FN:  3802
y_pred: tensor([0.1222, 0.0930, 0.0846,  ..., 0.2483, 0.2520, 0.2596])
负样本数量： 9745
正样本数量： 6912
TP:  4373
TN:  9489
FP:  256
FN:  2539
First attempt - auc_val: 0.8843022460 acc_val: 0.8224078835
Epoch: 0032 loss_train: 0.3693739235 auc_train: 0.8890756717 acc_train: 0.8327840941 precision_train: 0.9466151901 recall_train: 0.5886440148 f1_train: 0.7258043884 loss_val: 0.3771336079 auc_val: 0.8903653143 acc_val: 0.8273052805 precision_val: 0.9427026041 recall_val: 0.6106870059 f1_val: 0.7410099133 time: 0.6290s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 12-32-48//checkpoints/best_model.pt
Epoch 0032: val_loss 改善从 0.377134 到 0.377134
y_pred: tensor([0.1943, 0.1571, 0.3307,  ..., 0.9794, 0.9889, 0.9886],
       grad_fn=<IndexBackward0>)
负样本数量： 14478
正样本数量： 8463
TP:  5003
TN:  14230
FP:  248
FN:  3460
batch idx: 0, loss: 0.363055 auc: 0.8912, acc: 0.8384, precision: 0.9528, recall: 0.5912, f1: 0.7296, time: 0.102s
y_pred: tensor([0.4939, 0.4749, 0.4831,  ..., 0.4358, 0.4160, 0.4452],
       grad_fn=<IndexBackward0>)
负样本数量： 14224
正样本数量： 8774
TP:  5145
TN:  13999
FP:  225
FN:  3629
batch idx: 1, loss: 0.364169 auc: 0.8938, acc: 0.8324, precision: 0.9581, recall: 0.5864, f1: 0.7275, time: 0.104s
y_pred: tensor([0.1042, 0.0778, 0.0597,  ..., 0.9802, 0.9885, 0.9842],
       grad_fn=<IndexBackward0>)
负样本数量： 14107
正样本数量： 8858
TP:  5299
TN:  13835
FP:  272
FN:  3559
batch idx: 2, loss: 0.369394 auc: 0.8903, acc: 0.8332, precision: 0.9512, recall: 0.5982, f1: 0.7345, time: 0.094s
y_pred: tensor([0.6973, 0.5104, 0.7498,  ..., 0.9909, 0.9908, 0.9888],
       grad_fn=<IndexBackward0>)
负样本数量： 13967
正样本数量： 9026
TP:  5359
TN:  13675
FP:  292
FN:  3667
batch idx: 3, loss: 0.375630 auc: 0.8874, acc: 0.8278, precision: 0.9483, recall: 0.5937, f1: 0.7303, time: 0.095s
y_pred: tensor([0.1014, 0.0746, 0.0595,  ..., 0.1336, 0.5439, 0.7711],
       grad_fn=<IndexBackward0>)
负样本数量： 3211
正样本数量： 1671
TP:  996
TN:  3135
FP:  76
FN:  675
batch idx: 4, loss: 0.364558 auc: 0.8857, acc: 0.8462, precision: 0.9291, recall: 0.5961, f1: 0.7262, time: 0.070s
First attempt - auc_train: 0.8911578238 acc_train: 0.8383679874
y_pred: tensor([0.2063, 0.1539, 0.1367,  ..., 0.9928, 0.9930, 0.9866])
负样本数量： 14259
正样本数量： 9447
TP:  5604
TN:  13973
FP:  286
FN:  3843
y_pred: tensor([0.4461, 0.1529, 0.2676,  ..., 0.9859, 0.9899, 0.9908])
负样本数量： 9582
正样本数量： 6709
TP:  3997
TN:  9365
FP:  217
FN:  2712
First attempt - auc_val: 0.8849854637 acc_val: 0.8258246857
Epoch: 0033 loss_train: 0.3673613906 auc_train: 0.8896809285 acc_train: 0.8355911780 precision_train: 0.9478958796 recall_train: 0.5931097872 f1_train: 0.7296199548 loss_val: 0.3791051209 auc_val: 0.8901333736 acc_val: 0.8230160811 precision_val: 0.9499740537 recall_val: 0.5944855361 f1_val: 0.7313159969 time: 0.6155s
Epoch 0033: val_loss 没有改善 0.379105，最佳值 0.377134，等待 1/15
y_pred: tensor([0.1495, 0.1102, 0.0853,  ..., 0.6016, 0.5996, 0.5984],
       grad_fn=<IndexBackward0>)
负样本数量： 14403
正样本数量： 8746
TP:  5070
TN:  14188
FP:  215
FN:  3676
batch idx: 0, loss: 0.367615 auc: 0.8914, acc: 0.8319, precision: 0.9593, recall: 0.5797, f1: 0.7227, time: 0.101s
y_pred: tensor([0.4084, 0.4734, 0.3801,  ..., 0.9889, 0.9883, 0.9920],
       grad_fn=<IndexBackward0>)
负样本数量： 14269
正样本数量： 8517
TP:  4948
TN:  14011
FP:  258
FN:  3569
batch idx: 1, loss: 0.369282 auc: 0.8888, acc: 0.8320, precision: 0.9504, recall: 0.5810, f1: 0.7211, time: 0.104s
y_pred: tensor([0.1009, 0.0677, 0.0599,  ..., 0.4092, 0.5331, 0.1770],
       grad_fn=<IndexBackward0>)
负样本数量： 14130
正样本数量： 8844
TP:  5325
TN:  13916
FP:  214
FN:  3519
batch idx: 2, loss: 0.364717 auc: 0.8928, acc: 0.8375, precision: 0.9614, recall: 0.6021, f1: 0.7405, time: 0.105s
y_pred: tensor([0.4398, 0.1670, 0.1044,  ..., 0.9929, 0.9920, 0.9933],
       grad_fn=<IndexBackward0>)
负样本数量： 14129
正样本数量： 9021
TP:  5303
TN:  13916
FP:  213
FN:  3718
batch idx: 3, loss: 0.367638 auc: 0.8924, acc: 0.8302, precision: 0.9614, recall: 0.5879, f1: 0.7296, time: 0.107s
y_pred: tensor([0.3851, 0.3606, 0.3250,  ..., 0.5530, 0.5623, 0.2984],
       grad_fn=<IndexBackward0>)
负样本数量： 3056
正样本数量： 1664
TP:  950
TN:  2985
FP:  71
FN:  714
batch idx: 4, loss: 0.377337 auc: 0.8777, acc: 0.8337, precision: 0.9305, recall: 0.5709, f1: 0.7076, time: 0.079s
First attempt - auc_train: 0.8914219188 acc_train: 0.8319149855
y_pred: tensor([0.1109, 0.0755, 0.2710,  ..., 0.9888, 0.9874, 0.9764])
负样本数量： 13599
正样本数量： 9754
TP:  5864
TN:  13285
FP:  314
FN:  3890
y_pred: tensor([0.2033, 0.1273, 0.3015,  ..., 0.9898, 0.9861, 0.9925])
负样本数量： 10242
正样本数量： 6402
TP:  3781
TN:  10055
FP:  187
FN:  2621
First attempt - auc_val: 0.8914559733 acc_val: 0.8199803023
Epoch: 0034 loss_train: 0.3693180799 auc_train: 0.8886266325 acc_train: 0.8330707548 precision_train: 0.9525941773 recall_train: 0.5843032926 f1_train: 0.7242979333 loss_val: 0.3783760667 auc_val: 0.8887362556 acc_val: 0.8256354287 precision_val: 0.9510237370 recall_val: 0.5958929721 f1_val: 0.7326737235 time: 0.6635s
Epoch 0034: val_loss 没有改善 0.378376，最佳值 0.377134，等待 2/15
y_pred: tensor([0.1103, 0.0735, 0.0642,  ..., 0.9901, 0.9903, 0.9906],
       grad_fn=<IndexBackward0>)
负样本数量： 14383
正样本数量： 8767
TP:  5224
TN:  14101
FP:  282
FN:  3543
batch idx: 0, loss: 0.367146 auc: 0.8909, acc: 0.8348, precision: 0.9488, recall: 0.5959, f1: 0.7320, time: 0.095s
y_pred: tensor([0.1989, 0.1492, 0.3394,  ..., 0.9830, 0.9831, 0.9867],
       grad_fn=<IndexBackward0>)
负样本数量： 13697
正样本数量： 9129
TP:  5476
TN:  13439
FP:  258
FN:  3653
batch idx: 1, loss: 0.369968 auc: 0.8927, acc: 0.8287, precision: 0.9550, recall: 0.5998, f1: 0.7369, time: 0.098s
y_pred: tensor([0.4970, 0.5065, 0.4687,  ..., 0.9815, 0.9807, 0.9903],
       grad_fn=<IndexBackward0>)
负样本数量： 14451
正样本数量： 8769
TP:  5131
TN:  14161
FP:  290
FN:  3638
batch idx: 2, loss: 0.371619 auc: 0.8884, acc: 0.8308, precision: 0.9465, recall: 0.5851, f1: 0.7232, time: 0.103s
y_pred: tensor([0.3718, 0.3402, 0.3715,  ..., 0.1555, 0.5749, 0.2315],
       grad_fn=<IndexBackward0>)
负样本数量： 14599
正样本数量： 8331
TP:  4915
TN:  14337
FP:  262
FN:  3416
batch idx: 3, loss: 0.360413 auc: 0.8925, acc: 0.8396, precision: 0.9494, recall: 0.5900, f1: 0.7277, time: 0.099s
y_pred: tensor([0.3402, 0.1185, 0.2766,  ..., 0.9899, 0.9926, 0.9886],
       grad_fn=<IndexBackward0>)
负样本数量： 2857
正样本数量： 1796
TP:  1048
TN:  2787
FP:  70
FN:  748
batch idx: 4, loss: 0.381280 auc: 0.8827, acc: 0.8242, precision: 0.9374, recall: 0.5835, f1: 0.7193, time: 0.070s
First attempt - auc_train: 0.8908807529 acc_train: 0.8347732181
y_pred: tensor([0.1343, 0.1050, 0.0959,  ..., 0.9853, 0.9922, 0.9894])
负样本数量： 13883
正样本数量： 9495
TP:  5625
TN:  13616
FP:  267
FN:  3870
y_pred: tensor([0.1339, 0.1051, 0.0950,  ..., 0.9897, 0.9864, 0.9924])
负样本数量： 9958
正样本数量： 6661
TP:  3927
TN:  9773
FP:  185
FN:  2734
First attempt - auc_val: 0.8884527039 acc_val: 0.8230387544
Epoch: 0035 loss_train: 0.3700851858 auc_train: 0.8894358072 acc_train: 0.8316134449 precision_train: 0.9474144891 recall_train: 0.5908662153 f1_train: 0.7278126594 loss_val: 0.3786586970 auc_val: 0.8896259901 acc_val: 0.8236982087 precision_val: 0.9548470227 recall_val: 0.5909840900 f1_val: 0.7300907541 time: 0.6233s
Epoch 0035: val_loss 没有改善 0.378659，最佳值 0.377134，等待 3/15
y_pred: tensor([0.5186, 0.4845, 0.5047,  ..., 0.9927, 0.9936, 0.9933],
       grad_fn=<IndexBackward0>)
负样本数量： 14123
正样本数量： 8944
TP:  5336
TN:  13870
FP:  253
FN:  3608
batch idx: 0, loss: 0.370497 auc: 0.8904, acc: 0.8326, precision: 0.9547, recall: 0.5966, f1: 0.7343, time: 0.098s
y_pred: tensor([0.5508, 0.5543, 0.4454,  ..., 0.2720, 0.4910, 0.3201],
       grad_fn=<IndexBackward0>)
负样本数量： 14361
正样本数量： 8429
TP:  4698
TN:  14221
FP:  140
FN:  3731
batch idx: 1, loss: 0.372420 auc: 0.8868, acc: 0.8301, precision: 0.9711, recall: 0.5574, f1: 0.7082, time: 0.104s
y_pred: tensor([0.1168, 0.1017, 0.0864,  ..., 0.9934, 0.9879, 0.9874],
       grad_fn=<IndexBackward0>)
负样本数量： 14014
正样本数量： 9010
TP:  5347
TN:  13828
FP:  186
FN:  3663
batch idx: 2, loss: 0.361461 auc: 0.8987, acc: 0.8328, precision: 0.9664, recall: 0.5935, f1: 0.7353, time: 0.104s
y_pred: tensor([0.1194, 0.0785, 0.0649,  ..., 0.3290, 0.1529, 0.5258],
       grad_fn=<IndexBackward0>)
负样本数量： 14623
正样本数量： 8550
TP:  5045
TN:  14316
FP:  307
FN:  3505
batch idx: 3, loss: 0.369142 auc: 0.8870, acc: 0.8355, precision: 0.9426, recall: 0.5901, f1: 0.7258, time: 0.104s
y_pred: tensor([0.1107, 0.0959, 0.0783,  ..., 0.9915, 0.9920, 0.9866],
       grad_fn=<IndexBackward0>)
负样本数量： 2866
正样本数量： 1859
TP:  1110
TN:  2819
FP:  47
FN:  749
batch idx: 4, loss: 0.361392 auc: 0.8971, acc: 0.8315, precision: 0.9594, recall: 0.5971, f1: 0.7361, time: 0.075s
First attempt - auc_train: 0.8903655735 acc_train: 0.8326180258
y_pred: tensor([0.4449, 0.4174, 0.1881,  ..., 0.9841, 0.9840, 0.9933])
负样本数量： 14154
正样本数量： 9410
TP:  5777
TN:  13778
FP:  376
FN:  3633
y_pred: tensor([0.2055, 0.1559, 0.1406,  ..., 0.9923, 0.9901, 0.9907])
负样本数量： 9687
正样本数量： 6746
TP:  4145
TN:  9420
FP:  267
FN:  2601
First attempt - auc_val: 0.8927676273 acc_val: 0.8298675946
Epoch: 0036 loss_train: 0.3669824421 auc_train: 0.8919959158 acc_train: 0.8325244085 precision_train: 0.9588388834 recall_train: 0.5869135952 f1_train: 0.7279515777 loss_val: 0.3787119240 auc_val: 0.8890593818 acc_val: 0.8276703640 precision_val: 0.9391874126 recall_val: 0.6141797729 f1_val: 0.7426832698 time: 0.6629s
Epoch 0036: val_loss 没有改善 0.378712，最佳值 0.377134，等待 4/15
y_pred: tensor([0.1176, 0.0837, 0.0660,  ..., 0.1111, 0.2131, 0.1581],
       grad_fn=<IndexBackward0>)
负样本数量： 14067
正样本数量： 8990
TP:  5419
TN:  13697
FP:  370
FN:  3571
batch idx: 0, loss: 0.374572 auc: 0.8898, acc: 0.8291, precision: 0.9361, recall: 0.6028, f1: 0.7333, time: 0.102s
y_pred: tensor([0.4415, 0.1588, 0.1096,  ..., 0.9910, 0.9921, 0.9894],
       grad_fn=<IndexBackward0>)
负样本数量： 14061
正样本数量： 8959
TP:  5377
TN:  13776
FP:  285
FN:  3582
batch idx: 1, loss: 0.367634 auc: 0.8918, acc: 0.8320, precision: 0.9497, recall: 0.6002, f1: 0.7355, time: 0.104s
y_pred: tensor([0.2224, 0.1601, 0.1473,  ..., 0.9845, 0.9928, 0.9893],
       grad_fn=<IndexBackward0>)
负样本数量： 14126
正样本数量： 8860
TP:  5297
TN:  13888
FP:  238
FN:  3563
batch idx: 2, loss: 0.362662 auc: 0.8952, acc: 0.8346, precision: 0.9570, recall: 0.5979, f1: 0.7359, time: 0.106s
y_pred: tensor([0.1138, 0.1107, 0.0932,  ..., 0.9915, 0.9936, 0.9893],
       grad_fn=<IndexBackward0>)
负样本数量： 14664
正样本数量： 8216
TP:  4816
TN:  14400
FP:  264
FN:  3400
batch idx: 3, loss: 0.364221 auc: 0.8870, acc: 0.8399, precision: 0.9480, recall: 0.5862, f1: 0.7244, time: 0.106s
y_pred: tensor([0.1059, 0.3004, 0.2981,  ..., 0.9610, 0.9871, 0.9926],
       grad_fn=<IndexBackward0>)
负样本数量： 3069
正样本数量： 1767
TP:  1002
TN:  3031
FP:  38
FN:  765
batch idx: 4, loss: 0.355716 auc: 0.8965, acc: 0.8340, precision: 0.9635, recall: 0.5671, f1: 0.7139, time: 0.077s
First attempt - auc_train: 0.8897536721 acc_train: 0.8290757687
y_pred: tensor([0.1130, 0.0755, 0.0627,  ..., 0.9867, 0.9874, 0.9879])
负样本数量： 14284
正样本数量： 9328
TP:  5506
TN:  14000
FP:  284
FN:  3822
y_pred: tensor([0.1137, 0.0748, 0.0608,  ..., 0.9895, 0.9864, 0.9891])
负样本数量： 9557
正样本数量： 6828
TP:  4025
TN:  9346
FP:  211
FN:  2803
First attempt - auc_val: 0.8899689977 acc_val: 0.8261053702
Epoch: 0037 loss_train: 0.3649611413 auc_train: 0.8920655770 acc_train: 0.8339087407 precision_train: 0.9508488094 recall_train: 0.5908102256 f1_train: 0.7286326190 loss_val: 0.3804440796 auc_val: 0.8888595238 acc_val: 0.8210783183 precision_val: 0.9505693855 recall_val: 0.5898751709 f1_val: 0.7279940941 time: 0.6576s
Epoch 0037: val_loss 没有改善 0.380444，最佳值 0.377134，等待 5/15
y_pred: tensor([0.5777, 0.4869, 0.1570,  ..., 0.9882, 0.9915, 0.9912],
       grad_fn=<IndexBackward0>)
负样本数量： 14437
正样本数量： 8602
TP:  5049
TN:  14251
FP:  186
FN:  3553
batch idx: 0, loss: 0.364551 auc: 0.8901, acc: 0.8377, precision: 0.9645, recall: 0.5870, f1: 0.7298, time: 0.099s
y_pred: tensor([0.1233, 0.0707, 0.0634,  ..., 0.2553, 0.5017, 0.5094],
       grad_fn=<IndexBackward0>)
负样本数量： 13455
正样本数量： 9378
TP:  5669
TN:  13225
FP:  230
FN:  3709
batch idx: 1, loss: 0.367893 auc: 0.8968, acc: 0.8275, precision: 0.9610, recall: 0.6045, f1: 0.7422, time: 0.103s
y_pred: tensor([0.1141, 0.0775, 0.0661,  ..., 0.9935, 0.9935, 0.9943],
       grad_fn=<IndexBackward0>)
负样本数量： 14425
正样本数量： 8738
TP:  5221
TN:  14101
FP:  324
FN:  3517
batch idx: 2, loss: 0.368925 auc: 0.8889, acc: 0.8342, precision: 0.9416, recall: 0.5975, f1: 0.7311, time: 0.103s
y_pred: tensor([0.1679, 0.3345, 0.3488,  ..., 0.9931, 0.9878, 0.9903],
       grad_fn=<IndexBackward0>)
负样本数量： 14559
正样本数量： 8441
TP:  5129
TN:  14175
FP:  384
FN:  3312
batch idx: 3, loss: 0.367302 auc: 0.8885, acc: 0.8393, precision: 0.9303, recall: 0.6076, f1: 0.7351, time: 0.097s
y_pred: tensor([0.0879, 0.0661, 0.0547,  ..., 0.9850, 0.9816, 0.9909],
       grad_fn=<IndexBackward0>)
负样本数量： 3111
正样本数量： 1633
TP:  889
TN:  3061
FP:  50
FN:  744
batch idx: 4, loss: 0.359665 auc: 0.8916, acc: 0.8326, precision: 0.9468, recall: 0.5444, f1: 0.6913, time: 0.071s
First attempt - auc_train: 0.8901134107 acc_train: 0.8377099701
y_pred: tensor([0.4465, 0.4998, 0.4934,  ..., 0.8458, 0.8976, 0.8989])
负样本数量： 13803
正样本数量： 10029
TP:  6159
TN:  13478
FP:  325
FN:  3870
y_pred: tensor([0.6064, 0.4411, 0.2061,  ..., 0.9882, 0.9914, 0.9934])
负样本数量： 10038
正样本数量： 6127
TP:  3538
TN:  9812
FP:  226
FN:  2589
First attempt - auc_val: 0.8893259970 acc_val: 0.8239761665
Epoch: 0038 loss_train: 0.3656671643 auc_train: 0.8911893760 acc_train: 0.8342613470 precision_train: 0.9488295107 recall_train: 0.5881975617 f1_train: 0.7258886655 loss_val: 0.3777541667 auc_val: 0.8892060549 acc_val: 0.8249172512 precision_val: 0.9449170557 recall_val: 0.5957815773 f1_val: 0.7306777833 time: 0.6224s
Epoch 0038: val_loss 没有改善 0.377754，最佳值 0.377134，等待 6/15
y_pred: tensor([0.1965, 0.1609, 0.2488,  ..., 0.0472, 0.0527, 0.0543],
       grad_fn=<IndexBackward0>)
负样本数量： 14323
正样本数量： 8780
TP:  5122
TN:  14079
FP:  244
FN:  3658
batch idx: 0, loss: 0.370053 auc: 0.8880, acc: 0.8311, precision: 0.9545, recall: 0.5834, f1: 0.7242, time: 0.094s
y_pred: tensor([0.4272, 0.1755, 0.3396,  ..., 0.9847, 0.9896, 0.9907],
       grad_fn=<IndexBackward0>)
负样本数量： 14166
正样本数量： 8599
TP:  5017
TN:  13947
FP:  219
FN:  3582
batch idx: 1, loss: 0.363811 auc: 0.8935, acc: 0.8330, precision: 0.9582, recall: 0.5834, f1: 0.7253, time: 0.103s
y_pred: tensor([0.2279, 0.1477, 0.3596,  ..., 0.0790, 0.0621, 0.0797],
       grad_fn=<IndexBackward0>)
负样本数量： 14117
正样本数量： 9061
TP:  5364
TN:  13885
FP:  232
FN:  3697
batch idx: 2, loss: 0.368731 auc: 0.8923, acc: 0.8305, precision: 0.9585, recall: 0.5920, f1: 0.7319, time: 0.107s
y_pred: tensor([0.2271, 0.2929, 0.2364,  ..., 0.0794, 0.3107, 0.3382],
       grad_fn=<IndexBackward0>)
负样本数量： 14265
正样本数量： 8583
TP:  5065
TN:  14036
FP:  229
FN:  3518
batch idx: 3, loss: 0.362340 auc: 0.8934, acc: 0.8360, precision: 0.9567, recall: 0.5901, f1: 0.7300, time: 0.108s
y_pred: tensor([0.1208, 0.0780, 0.0705,  ..., 0.0505, 0.2498, 0.2690],
       grad_fn=<IndexBackward0>)
负样本数量： 3116
正样本数量： 1769
TP:  1076
TN:  3043
FP:  73
FN:  693
batch idx: 4, loss: 0.368538 auc: 0.8894, acc: 0.8432, precision: 0.9365, recall: 0.6083, f1: 0.7375, time: 0.075s
First attempt - auc_train: 0.8880304024 acc_train: 0.8311041856
y_pred: tensor([0.0917, 0.0647, 0.0577,  ..., 0.9936, 0.9883, 0.9842])
负样本数量： 14026
正样本数量： 9788
TP:  5996
TN:  13645
FP:  381
FN:  3792
y_pred: tensor([0.5218, 0.5005, 0.4231,  ..., 0.9930, 0.9917, 0.9884])
负样本数量： 9815
正样本数量： 6368
TP:  3840
TN:  9595
FP:  220
FN:  2528
First attempt - auc_val: 0.8895428223 acc_val: 0.8247669438
Epoch: 0039 loss_train: 0.3666947126 auc_train: 0.8913421740 acc_train: 0.8347639513 precision_train: 0.9528908966 recall_train: 0.5914344255 f1_train: 0.7297675164 loss_val: 0.3772348166 auc_val: 0.8897092867 acc_val: 0.8274795604 precision_val: 0.9430334229 recall_val: 0.6078009582 f1_val: 0.7391641932 time: 0.6360s
Epoch 0039: val_loss 没有改善 0.377235，最佳值 0.377134，等待 7/15
y_pred: tensor([0.0930, 0.2357, 0.1381,  ..., 0.4584, 0.1844, 0.5699],
       grad_fn=<IndexBackward0>)
负样本数量： 14383
正样本数量： 8848
TP:  5131
TN:  14066
FP:  317
FN:  3717
batch idx: 0, loss: 0.372310 auc: 0.8894, acc: 0.8264, precision: 0.9418, recall: 0.5799, f1: 0.7178, time: 0.100s
y_pred: tensor([0.1859, 0.1436, 0.1295,  ..., 0.1839, 0.1285, 0.2132],
       grad_fn=<IndexBackward0>)
负样本数量： 14505
正样本数量： 8540
TP:  4990
TN:  14287
FP:  218
FN:  3550
batch idx: 1, loss: 0.365468 auc: 0.8897, acc: 0.8365, precision: 0.9581, recall: 0.5843, f1: 0.7259, time: 0.096s
y_pred: tensor([0.4396, 0.4343, 0.4364,  ..., 0.9925, 0.9926, 0.5835],
       grad_fn=<IndexBackward0>)
负样本数量： 14341
正样本数量： 8801
TP:  5251
TN:  14027
FP:  314
FN:  3550
batch idx: 2, loss: 0.366036 auc: 0.8903, acc: 0.8330, precision: 0.9436, recall: 0.5966, f1: 0.7310, time: 0.097s
y_pred: tensor([0.4832, 0.1393, 0.0925,  ..., 0.9938, 0.9933, 0.9880],
       grad_fn=<IndexBackward0>)
负样本数量： 13860
正样本数量： 8758
TP:  5398
TN:  13588
FP:  272
FN:  3360
batch idx: 3, loss: 0.358543 auc: 0.8964, acc: 0.8394, precision: 0.9520, recall: 0.6164, f1: 0.7483, time: 0.098s
y_pred: tensor([0.2090, 0.1600, 0.1409,  ..., 0.5459, 0.6153, 0.6498],
       grad_fn=<IndexBackward0>)
负样本数量： 2898
正样本数量： 1845
TP:  1161
TN:  2833
FP:  65
FN:  684
batch idx: 4, loss: 0.362395 auc: 0.8950, acc: 0.8421, precision: 0.9470, recall: 0.6293, f1: 0.7561, time: 0.072s
First attempt - auc_train: 0.8893600993 acc_train: 0.8263527184
y_pred: tensor([0.5316, 0.4949, 0.4932,  ..., 0.9922, 0.9892, 0.9884])
负样本数量： 14166
正样本数量： 9510
TP:  5673
TN:  13824
FP:  342
FN:  3837
y_pred: tensor([0.0901, 0.0640, 0.0574,  ..., 0.5654, 0.4885, 0.5485])
负样本数量： 9675
正样本数量： 6646
TP:  4013
TN:  9472
FP:  203
FN:  2633
First attempt - auc_val: 0.8871878439 acc_val: 0.8234921439
Epoch: 0040 loss_train: 0.3649501860 auc_train: 0.8921253196 acc_train: 0.8354760777 precision_train: 0.9485082051 recall_train: 0.6012940001 f1_train: 0.7358302603 loss_val: 0.3778566569 auc_val: 0.8898924902 acc_val: 0.8248641407 precision_val: 0.9474961198 recall_val: 0.6001759081 f1_val: 0.7348637674 time: 0.6132s
Epoch 0040: val_loss 没有改善 0.377857，最佳值 0.377134，等待 8/15
y_pred: tensor([0.2138, 0.3402, 0.3132,  ..., 0.9909, 0.9864, 0.9911],
       grad_fn=<IndexBackward0>)
负样本数量： 14132
正样本数量： 8950
TP:  5456
TN:  13879
FP:  253
FN:  3494
batch idx: 0, loss: 0.358903 auc: 0.8974, acc: 0.8377, precision: 0.9557, recall: 0.6096, f1: 0.7444, time: 0.095s
y_pred: tensor([0.4619, 0.4339, 0.1773,  ..., 0.3784, 0.3623, 0.3439],
       grad_fn=<IndexBackward0>)
负样本数量： 15007
正样本数量： 8111
TP:  4699
TN:  14811
FP:  196
FN:  3412
batch idx: 1, loss: 0.352557 auc: 0.8927, acc: 0.8439, precision: 0.9600, recall: 0.5793, f1: 0.7226, time: 0.102s
y_pred: tensor([0.0785, 0.0587, 0.0572,  ..., 0.0692, 0.0763, 0.0663],
       grad_fn=<IndexBackward0>)
负样本数量： 13922
正样本数量： 8959
TP:  5218
TN:  13734
FP:  188
FN:  3741
batch idx: 2, loss: 0.370580 auc: 0.8917, acc: 0.8283, precision: 0.9652, recall: 0.5824, f1: 0.7265, time: 0.107s
y_pred: tensor([0.1016, 0.0618, 0.2684,  ..., 0.0675, 0.0756, 0.0721],
       grad_fn=<IndexBackward0>)
负样本数量： 14147
正样本数量： 8756
TP:  5029
TN:  13897
FP:  250
FN:  3727
batch idx: 3, loss: 0.378226 auc: 0.8850, acc: 0.8264, precision: 0.9526, recall: 0.5743, f1: 0.7166, time: 0.108s
y_pred: tensor([0.4931, 0.1364, 0.0805,  ..., 0.9906, 0.9864, 0.9864],
       grad_fn=<IndexBackward0>)
负样本数量： 2779
正样本数量： 2016
TP:  1242
TN:  2740
FP:  39
FN:  774
batch idx: 4, loss: 0.367817 auc: 0.8945, acc: 0.8304, precision: 0.9696, recall: 0.6161, f1: 0.7534, time: 0.100s
First attempt - auc_train: 0.8973504128 acc_train: 0.8376657135
y_pred: tensor([0.5520, 0.4345, 0.4133,  ..., 0.9561, 0.9756, 0.9750])
负样本数量： 14111
正样本数量： 9328
TP:  5491
TN:  13775
FP:  336
FN:  3837
y_pred: tensor([0.4541, 0.4220, 0.4290,  ..., 0.0771, 0.0678, 0.0640])
负样本数量： 9730
正样本数量： 6828
TP:  4292
TN:  9505
FP:  225
FN:  2536
First attempt - auc_val: 0.8849903737 acc_val: 0.8219633943
Epoch: 0041 loss_train: 0.3656164050 auc_train: 0.8922565390 acc_train: 0.8333370673 precision_train: 0.9606129112 recall_train: 0.5923594326 f1_train: 0.7327031700 loss_val: 0.3763374239 auc_val: 0.8904079664 acc_val: 0.8276081013 precision_val: 0.9462627864 recall_val: 0.6086229854 f1_val: 0.7406391047 time: 0.6812s
Best model so far, saving...
Epoch 0041: val_loss 没有改善 0.376337，最佳值 0.377134，等待 9/15
y_pred: tensor([0.4332, 0.1412, 0.2168,  ..., 0.0727, 0.0724, 0.0645],
       grad_fn=<IndexBackward0>)
负样本数量： 14136
正样本数量： 8550
TP:  5039
TN:  13867
FP:  269
FN:  3511
batch idx: 0, loss: 0.364256 auc: 0.8924, acc: 0.8334, precision: 0.9493, recall: 0.5894, f1: 0.7272, time: 0.114s
y_pred: tensor([0.5564, 0.4541, 0.1590,  ..., 0.9931, 0.9878, 0.9914],
       grad_fn=<IndexBackward0>)
负样本数量： 14192
正样本数量： 8978
TP:  5452
TN:  13887
FP:  305
FN:  3526
batch idx: 1, loss: 0.363439 auc: 0.8945, acc: 0.8347, precision: 0.9470, recall: 0.6073, f1: 0.7400, time: 0.117s
y_pred: tensor([0.1016, 0.0614, 0.0650,  ..., 0.9883, 0.9946, 0.9832],
       grad_fn=<IndexBackward0>)
负样本数量： 14651
正样本数量： 8455
TP:  4991
TN:  14340
FP:  311
FN:  3464
batch idx: 2, loss: 0.368260 auc: 0.8859, acc: 0.8366, precision: 0.9413, recall: 0.5903, f1: 0.7256, time: 0.119s
y_pred: tensor([0.1987, 0.3094, 0.1868,  ..., 0.2904, 0.2075, 0.3528],
       grad_fn=<IndexBackward0>)
负样本数量： 13908
正样本数量： 9152
TP:  5691
TN:  13536
FP:  372
FN:  3461
batch idx: 3, loss: 0.363792 auc: 0.8964, acc: 0.8338, precision: 0.9386, recall: 0.6218, f1: 0.7481, time: 0.115s
y_pred: tensor([0.5546, 0.6530, 0.5817,  ..., 0.4575, 0.4420, 0.4848],
       grad_fn=<IndexBackward0>)
负样本数量： 3100
正样本数量： 1657
TP:  904
TN:  3061
FP:  39
FN:  753
batch idx: 4, loss: 0.370362 auc: 0.8835, acc: 0.8335, precision: 0.9586, recall: 0.5456, f1: 0.6954, time: 0.083s
First attempt - auc_train: 0.8924293703 acc_train: 0.8333774134
y_pred: tensor([0.1117, 0.0745, 0.0625,  ..., 0.4569, 0.5928, 0.6581])
负样本数量： 14140
正样本数量： 9422
TP:  5709
TN:  13763
FP:  377
FN:  3713
y_pred: tensor([0.1104, 0.2881, 0.2990,  ..., 0.9865, 0.9931, 0.9929])
负样本数量： 9701
正样本数量： 6734
TP:  4121
TN:  9479
FP:  222
FN:  2613
First attempt - auc_val: 0.8890134010 acc_val: 0.8264154147
Epoch: 0042 loss_train: 0.3660217643 auc_train: 0.8905355983 acc_train: 0.8343893546 precision_train: 0.9469945102 recall_train: 0.5908632170 f1_train: 0.7272593134 loss_val: 0.3776714951 auc_val: 0.8897767572 acc_val: 0.8269588482 precision_val: 0.9434689059 recall_val: 0.6089457107 f1_val: 0.7401647154 time: 0.7111s
Epoch 0042: val_loss 没有改善 0.377671，最佳值 0.377134，等待 10/15
y_pred: tensor([0.1228, 0.0714, 0.2716,  ..., 0.9914, 0.9922, 0.9891],
       grad_fn=<IndexBackward0>)
负样本数量： 14620
正样本数量： 8686
TP:  5232
TN:  14266
FP:  354
FN:  3454
batch idx: 0, loss: 0.363811 auc: 0.8924, acc: 0.8366, precision: 0.9366, recall: 0.6023, f1: 0.7332, time: 0.096s
y_pred: tensor([0.5461, 0.2203, 0.1552,  ..., 0.9840, 0.9830, 0.9797],
       grad_fn=<IndexBackward0>)
负样本数量： 14084
正样本数量： 8979
TP:  5281
TN:  13867
FP:  217
FN:  3698
batch idx: 1, loss: 0.368589 auc: 0.8917, acc: 0.8302, precision: 0.9605, recall: 0.5882, f1: 0.7296, time: 0.104s
y_pred: tensor([0.5371, 0.4257, 0.1494,  ..., 0.0577, 0.0589, 0.0600],
       grad_fn=<IndexBackward0>)
负样本数量： 14267
正样本数量： 8559
TP:  5002
TN:  13980
FP:  287
FN:  3557
batch idx: 2, loss: 0.368222 auc: 0.8895, acc: 0.8316, precision: 0.9457, recall: 0.5844, f1: 0.7224, time: 0.106s
y_pred: tensor([0.5645, 0.4365, 0.1794,  ..., 0.9933, 0.9888, 0.9943],
       grad_fn=<IndexBackward0>)
负样本数量： 14148
正样本数量： 8652
TP:  5126
TN:  13918
FP:  230
FN:  3526
batch idx: 3, loss: 0.361437 auc: 0.8937, acc: 0.8353, precision: 0.9571, recall: 0.5925, f1: 0.7319, time: 0.108s
y_pred: tensor([0.4773, 0.0785, 0.0608,  ..., 0.1493, 0.1180, 0.1342],
       grad_fn=<IndexBackward0>)
负样本数量： 2868
正样本数量： 1916
TP:  1141
TN:  2815
FP:  53
FN:  775
batch idx: 4, loss: 0.368129 auc: 0.8942, acc: 0.8269, precision: 0.9556, recall: 0.5955, f1: 0.7338, time: 0.076s
First attempt - auc_train: 0.8924086844 acc_train: 0.8366085986
y_pred: tensor([0.1184, 0.0924, 0.3196,  ..., 0.9941, 0.9852, 0.9879])
负样本数量： 13730
正样本数量： 9793
TP:  5904
TN:  13422
FP:  308
FN:  3889
y_pred: tensor([0.4910, 0.5770, 0.6962,  ..., 0.9931, 0.9878, 0.9913])
负样本数量： 10111
正样本数量： 6363
TP:  3696
TN:  9912
FP:  199
FN:  2667
First attempt - auc_val: 0.8935413943 acc_val: 0.8215788802
Epoch: 0043 loss_train: 0.3660374522 auc_train: 0.8923017319 acc_train: 0.8321275930 precision_train: 0.9511127429 recall_train: 0.5925776909 f1_train: 0.7301598503 loss_val: 0.3793609142 auc_val: 0.8881059090 acc_val: 0.8238038871 precision_val: 0.9496637011 recall_val: 0.5918688468 f1_val: 0.7291888764 time: 0.6551s
Epoch 0043: val_loss 没有改善 0.379361，最佳值 0.377134，等待 11/15
y_pred: tensor([0.1372, 0.1139, 0.2246,  ..., 0.9886, 0.9870, 0.9920],
       grad_fn=<IndexBackward0>)
负样本数量： 14381
正样本数量： 8765
TP:  5185
TN:  14141
FP:  240
FN:  3580
batch idx: 0, loss: 0.362208 auc: 0.8938, acc: 0.8350, precision: 0.9558, recall: 0.5916, f1: 0.7308, time: 0.095s
y_pred: tensor([0.5976, 0.5562, 0.6077,  ..., 0.9898, 0.9918, 0.9900],
       grad_fn=<IndexBackward0>)
负样本数量： 14682
正样本数量： 8885
TP:  5223
TN:  14453
FP:  229
FN:  3662
batch idx: 1, loss: 0.361759 auc: 0.8937, acc: 0.8349, precision: 0.9580, recall: 0.5878, f1: 0.7286, time: 0.096s
y_pred: tensor([0.0801, 0.4217, 0.4435,  ..., 0.9908, 0.9922, 0.9920],
       grad_fn=<IndexBackward0>)
负样本数量： 14317
正样本数量： 8626
TP:  5135
TN:  14036
FP:  281
FN:  3491
batch idx: 2, loss: 0.366021 auc: 0.8911, acc: 0.8356, precision: 0.9481, recall: 0.5953, f1: 0.7314, time: 0.125s
y_pred: tensor([0.1738, 0.1452, 0.1344,  ..., 0.9935, 0.9847, 0.9936],
       grad_fn=<IndexBackward0>)
负样本数量： 13668
正样本数量： 8776
TP:  5279
TN:  13417
FP:  251
FN:  3497
batch idx: 3, loss: 0.364779 auc: 0.8932, acc: 0.8330, precision: 0.9546, recall: 0.6015, f1: 0.7380, time: 0.108s
y_pred: tensor([0.1330, 0.0930, 0.0914,  ..., 0.9520, 0.9896, 0.9877],
       grad_fn=<IndexBackward0>)
负样本数量： 2939
正样本数量： 1740
TP:  1015
TN:  2855
FP:  84
FN:  725
batch idx: 4, loss: 0.383853 auc: 0.8812, acc: 0.8271, precision: 0.9236, recall: 0.5833, f1: 0.7150, time: 0.076s
First attempt - auc_train: 0.8938400135 acc_train: 0.8349606844
y_pred: tensor([0.0914, 0.0658, 0.0598,  ..., 0.1095, 0.1090, 0.1064])
负样本数量： 14222
正样本数量： 9647
TP:  5944
TN:  13912
FP:  310
FN:  3703
y_pred: tensor([0.2056, 0.3054, 0.2270,  ..., 0.0396, 0.0499, 0.2211])
负样本数量： 9619
正样本数量： 6509
TP:  3867
TN:  9348
FP:  271
FN:  2642
First attempt - auc_val: 0.8957096380 acc_val: 0.8318739788
Epoch: 0044 loss_train: 0.3677240908 auc_train: 0.8905877843 acc_train: 0.8331111790 precision_train: 0.9480104432 recall_train: 0.5919111073 f1_train: 0.7287660946 loss_val: 0.3799406737 auc_val: 0.8881353571 acc_val: 0.8256282096 precision_val: 0.9424705743 recall_val: 0.6051252874 f1_val: 0.7370138694 time: 0.6545s
Epoch 0044: val_loss 没有改善 0.379941，最佳值 0.377134，等待 12/15
y_pred: tensor([0.1163, 0.0771, 0.0567,  ..., 0.5369, 0.6516, 0.6373],
       grad_fn=<IndexBackward0>)
负样本数量： 14336
正样本数量： 8947
TP:  5485
TN:  14069
FP:  267
FN:  3462
batch idx: 0, loss: 0.355524 auc: 0.8977, acc: 0.8398, precision: 0.9536, recall: 0.6131, f1: 0.7463, time: 0.102s
y_pred: tensor([0.0899, 0.0686, 0.0590,  ..., 0.9905, 0.9927, 0.9905],
       grad_fn=<IndexBackward0>)
负样本数量： 14306
正样本数量： 8410
TP:  4866
TN:  14022
FP:  284
FN:  3544
batch idx: 1, loss: 0.369723 auc: 0.8885, acc: 0.8315, precision: 0.9449, recall: 0.5786, f1: 0.7177, time: 0.103s
y_pred: tensor([0.1078, 0.0756, 0.0557,  ..., 0.9945, 0.9939, 0.9930],
       grad_fn=<IndexBackward0>)
负样本数量： 14387
正样本数量： 8441
TP:  5020
TN:  14130
FP:  257
FN:  3421
batch idx: 2, loss: 0.363357 auc: 0.8895, acc: 0.8389, precision: 0.9513, recall: 0.5947, f1: 0.7319, time: 0.101s
y_pred: tensor([0.5676, 0.2101, 0.1509,  ..., 0.9816, 0.9843, 0.9817],
       grad_fn=<IndexBackward0>)
负样本数量： 13906
正样本数量： 9130
TP:  5488
TN:  13636
FP:  270
FN:  3642
batch idx: 3, loss: 0.366060 auc: 0.8961, acc: 0.8302, precision: 0.9531, recall: 0.6011, f1: 0.7372, time: 0.105s
y_pred: tensor([0.1098, 0.0826, 0.0837,  ..., 0.9880, 0.9877, 0.9930],
       grad_fn=<IndexBackward0>)
负样本数量： 3052
正样本数量： 1864
TP:  1103
TN:  2968
FP:  84
FN:  761
batch idx: 4, loss: 0.379845 auc: 0.8805, acc: 0.8281, precision: 0.9292, recall: 0.5917, f1: 0.7230, time: 0.077s
First attempt - auc_train: 0.8977313208 acc_train: 0.8398402268
y_pred: tensor([0.4799, 0.1462, 0.2972,  ..., 0.1585, 0.1055, 0.2122])
负样本数量： 14201
正样本数量： 9381
TP:  5417
TN:  13912
FP:  289
FN:  3964
y_pred: tensor([0.4265, 0.3318, 0.1338,  ..., 0.0466, 0.0435, 0.0409])
负样本数量： 9640
正样本数量： 6775
TP:  4120
TN:  9449
FP:  191
FN:  2655
First attempt - auc_val: 0.8847087614 acc_val: 0.8196505810
Epoch: 0045 loss_train: 0.3669017076 auc_train: 0.8904558671 acc_train: 0.8336995709 precision_train: 0.9464151795 recall_train: 0.5958402634 f1_train: 0.7312346344 loss_val: 0.3774460703 auc_val: 0.8902677835 acc_val: 0.8231362865 precision_val: 0.9525231471 recall_val: 0.5927809253 f1_val: 0.7306907447 time: 0.6525s
Epoch 0045: val_loss 没有改善 0.377446，最佳值 0.377134，等待 13/15
y_pred: tensor([0.1101, 0.0899, 0.0850,  ..., 0.2672, 0.2803, 0.2418],
       grad_fn=<IndexBackward0>)
负样本数量： 14130
正样本数量： 8642
TP:  5118
TN:  13933
FP:  197
FN:  3524
batch idx: 0, loss: 0.359740 auc: 0.8943, acc: 0.8366, precision: 0.9629, recall: 0.5922, f1: 0.7334, time: 0.095s
y_pred: tensor([0.1132, 0.0672, 0.0593,  ..., 0.0672, 0.3018, 0.1545],
       grad_fn=<IndexBackward0>)
负样本数量： 14306
正样本数量： 8768
TP:  5025
TN:  14080
FP:  226
FN:  3743
batch idx: 1, loss: 0.373191 auc: 0.8889, acc: 0.8280, precision: 0.9570, recall: 0.5731, f1: 0.7169, time: 0.097s
y_pred: tensor([0.1076, 0.0688, 0.0578,  ..., 0.3595, 0.4508, 0.6302],
       grad_fn=<IndexBackward0>)
负样本数量： 14373
正样本数量： 8557
TP:  5005
TN:  14227
FP:  146
FN:  3552
batch idx: 2, loss: 0.357658 auc: 0.8952, acc: 0.8387, precision: 0.9717, recall: 0.5849, f1: 0.7302, time: 0.096s
y_pred: tensor([0.1784, 0.1443, 0.1303,  ..., 0.9861, 0.9890, 0.9934],
       grad_fn=<IndexBackward0>)
负样本数量： 14154
正样本数量： 9035
TP:  5354
TN:  13936
FP:  218
FN:  3681
batch idx: 3, loss: 0.368360 auc: 0.8918, acc: 0.8319, precision: 0.9609, recall: 0.5926, f1: 0.7331, time: 0.098s
y_pred: tensor([0.1251, 0.1032, 0.2310,  ..., 0.9935, 0.9874, 0.9931],
       grad_fn=<IndexBackward0>)
负样本数量： 3024
正样本数量： 1790
TP:  1085
TN:  2947
FP:  77
FN:  705
batch idx: 4, loss: 0.360184 auc: 0.8930, acc: 0.8376, precision: 0.9337, recall: 0.6061, f1: 0.7351, time: 0.071s
First attempt - auc_train: 0.8942827848 acc_train: 0.8365975760
y_pred: tensor([0.2030, 0.3057, 0.2258,  ..., 0.0845, 0.0739, 0.0693])
负样本数量： 14037
正样本数量： 9593
TP:  5792
TN:  13732
FP:  305
FN:  3801
y_pred: tensor([0.1302, 0.1019, 0.2377,  ..., 0.9639, 0.9835, 0.9891])
负样本数量： 9804
正样本数量： 6563
TP:  3927
TN:  9585
FP:  219
FN:  2636
First attempt - auc_val: 0.8881071455 acc_val: 0.8262378333
Epoch: 0046 loss_train: 0.3638266563 auc_train: 0.8926415859 acc_train: 0.8345458811 precision_train: 0.9572324810 recall_train: 0.5897923340 f1_train: 0.7297356429 loss_val: 0.3771510124 auc_val: 0.8901824426 acc_val: 0.8259007337 precision_val: 0.9485767003 recall_val: 0.6010639980 f1_val: 0.7358532321 time: 0.6050s
Epoch 0046: val_loss 没有改善 0.377151，最佳值 0.377134，等待 14/15
y_pred: tensor([0.5289, 0.5497, 0.2109,  ..., 0.9949, 0.9853, 0.4290],
       grad_fn=<IndexBackward0>)
负样本数量： 14422
正样本数量： 8701
TP:  5232
TN:  14099
FP:  323
FN:  3469
batch idx: 0, loss: 0.364745 auc: 0.8912, acc: 0.8360, precision: 0.9419, recall: 0.6013, f1: 0.7340, time: 0.100s
y_pred: tensor([0.1864, 0.1455, 0.1240,  ..., 0.9864, 0.9857, 0.9859],
       grad_fn=<IndexBackward0>)
负样本数量： 14698
正样本数量： 8660
TP:  5027
TN:  14480
FP:  218
FN:  3633
batch idx: 1, loss: 0.362735 auc: 0.8925, acc: 0.8351, precision: 0.9584, recall: 0.5805, f1: 0.7230, time: 0.098s
y_pred: tensor([0.2061, 0.1497, 0.1274,  ..., 0.9930, 0.9929, 0.9876],
       grad_fn=<IndexBackward0>)
负样本数量： 13918
正样本数量： 8859
TP:  5243
TN:  13769
FP:  149
FN:  3616
batch idx: 2, loss: 0.360270 auc: 0.8974, acc: 0.8347, precision: 0.9724, recall: 0.5918, f1: 0.7358, time: 0.096s
y_pred: tensor([0.1033, 0.0715, 0.0588,  ..., 0.3603, 0.2532, 0.1363],
       grad_fn=<IndexBackward0>)
负样本数量： 14111
正样本数量： 8794
TP:  5142
TN:  13875
FP:  236
FN:  3652
batch idx: 3, loss: 0.371110 auc: 0.8891, acc: 0.8303, precision: 0.9561, recall: 0.5847, f1: 0.7257, time: 0.096s
y_pred: tensor([0.1638, 0.2984, 0.3107,  ..., 0.9907, 0.9900, 0.9892],
       grad_fn=<IndexBackward0>)
负样本数量： 2838
正样本数量： 1778
TP:  1092
TN:  2789
FP:  49
FN:  686
batch idx: 4, loss: 0.361578 auc: 0.8928, acc: 0.8408, precision: 0.9571, recall: 0.6142, f1: 0.7482, time: 0.071s
First attempt - auc_train: 0.8912143198 acc_train: 0.8360074385
y_pred: tensor([0.2053, 0.1508, 0.1373,  ..., 0.0723, 0.0720, 0.0703])
负样本数量： 13850
正样本数量： 9657
TP:  5749
TN:  13544
FP:  306
FN:  3908
y_pred: tensor([0.1097, 0.0721, 0.0590,  ..., 0.9940, 0.9850, 0.9918])
负样本数量： 9991
正样本数量： 6499
TP:  3846
TN:  9810
FP:  181
FN:  2653
First attempt - auc_val: 0.8878776847 acc_val: 0.8207342494
Epoch: 0047 loss_train: 0.3640875518 auc_train: 0.8925736529 acc_train: 0.8353734354 precision_train: 0.9571659982 recall_train: 0.5945025567 f1_train: 0.7333443345 loss_val: 0.3771754354 auc_val: 0.8901308945 acc_val: 0.8244362575 precision_val: 0.9522583216 recall_val: 0.5935514043 f1_val: 0.7312796376 time: 0.6119s
Epoch 0047: val_loss 没有改善 0.377175，最佳值 0.377134，等待 15/15

Epoch 0047: 提前停止
最佳val_loss: 0.377134 (Epoch 0032)
已恢复到最佳模型权重 (Epoch 0032)

=== 提前停止训练 ===
停止epoch: 47
最佳epoch: 32
最佳验证损失: 0.377134
总训练时间: 33.94秒
Optimization Finished!
Best Epoch: 0041
y_pred: tensor([0.1011, 0.2550, 0.1673,  ..., 0.9835, 0.9858, 0.9864])
负样本数量： 13969
正样本数量： 9758
TP:  5980
TN:  13698
FP:  271
FN:  3778
y_pred: tensor([0.4621, 0.1443, 0.2873,  ..., 0.9919, 0.9941, 0.9881])
负样本数量： 9249
正样本数量： 6091
TP:  3635
TN:  9083
FP:  166
FN:  2456
--------------------------------
--------Testing-----------------
--------------------------------
loss_test: 0.3776632249 auc_test: 0.8887304679 acc_test: 0.8292124222 precision_test: 0.9564871094 recall_test: 0.6048063178 f1_test: 0.7410085454 auc_max: 0.8888510206 acc_max: 0.8293505289 auc_std_test: 0.0001205528 acc_std_test: 0.0001381067 first_attempt_auc_test: 0.8886099151 first_attempt_acc_test: 0.8293505289
../model/expCEKT2025-08-02 12-32-48/
