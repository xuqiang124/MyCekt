/Users/I764812/myCode/MyCekt/code/train_demo_2.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embeddings_tensor = torch.tensor(embeddings, dtype=torch.long)
=== GPU信息 ===
PyTorch版本: 2.7.1
CUDA可用: False
CUDA不可用，将使用CPU训练
==================================================
使用CPU训练
Namespace(no_cuda=False, seed=42, data_dir='../data', save_dir='../model', graph_save_dir='graphs', load_dir='', hid_dim=32, emb_dim=32, attn_dim=32, vae_encoder_dim=32, vae_decoder_dim=32, edge_types=2, dropout=0, bias=True, binary=True, result_type=12, temp=0.5, hard=False, no_factor=False, prior=False, var=1, epochs=50, batch_size=512, train_ratio=0.6, val_ratio=0.2, shuffle=True, lr=0.001, lr_decay=50, gamma=0.5, test=False, test_model_dir='logs/expDKT', weight_method='senet', amp=False, gpu_id=0, cuda=False, factor=True)
从pkl文件加载数据集...../data/487
从pkl文件加载数据集...../data/487
训练集大小: 2153
验证集大小: 868
测试集大小: 847
torch.Size([14, 32]) torch.Size([10, 32])
模型初始化完成
start training!
EarlyStopping: 监控 val_loss (最小值)，耐心值 15，最小变化阈值 0.001
开始训练，最大epoch数: 50
提前停止配置已启用，监控验证损失
y_pred: tensor([0.5924, 0.5508, 0.5416,  ..., 0.5382, 0.5194, 0.5238],
       grad_fn=<IndexBackward0>)
负样本数量： 14384
正样本数量： 8599
TP:  579
TN:  13927
FP:  457
FN:  8020
batch idx: 0, loss: 0.710992 auc: 0.6082, acc: 0.6312, precision: 0.5589, recall: 0.0673, f1: 0.1202, time: 0.154s
y_pred: tensor([0.0691, 0.0567, 0.0564,  ..., 0.0643, 0.0594, 0.0833],
       grad_fn=<IndexBackward0>)
负样本数量： 14129
正样本数量： 9038
TP:  0
TN:  14129
FP:  0
FN:  9038
batch idx: 1, loss: 1.096882 auc: 0.6943, acc: 0.6099, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.081s
y_pred: tensor([0.1121, 0.0920, 0.0888,  ..., 0.1392, 0.1914, 0.1432],
       grad_fn=<IndexBackward0>)
负样本数量： 14413
正样本数量： 8529
TP:  0
TN:  14413
FP:  0
FN:  8529
batch idx: 2, loss: 0.798468 auc: 0.8056, acc: 0.6282, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.080s
y_pred: tensor([0.2278, 0.2215, 0.2069,  ..., 0.4490, 0.5114, 0.4607],
       grad_fn=<IndexBackward0>)
负样本数量： 13994
正样本数量： 8888
TP:  0
TN:  13994
FP:  0
FN:  8888
batch idx: 3, loss: 0.559607 auc: 0.8580, acc: 0.6116, precision: 0.0000, recall: 0.0000, f1: 0.0000, time: 0.082s
y_pred: tensor([0.3672, 0.3508, 0.3397,  ..., 0.7201, 0.6959, 0.6873],
       grad_fn=<IndexBackward0>)
负样本数量： 3067
正样本数量： 1738
TP:  1249
TN:  2697
FP:  370
FN:  489
batch idx: 4, loss: 0.572774 auc: 0.8547, acc: 0.8212, precision: 0.7715, recall: 0.7186, f1: 0.7441, time: 0.059s
First attempt - auc_train: 0.6082187582 acc_train: 0.6311621633
y_pred: tensor([0.3191, 0.2799, 0.2740,  ..., 0.2976, 0.2976, 0.6451])
负样本数量： 14312
正样本数量： 9485
TP:  7449
TN:  12594
FP:  1718
FN:  2036
y_pred: tensor([0.3453, 0.2894, 0.5982,  ..., 0.7575, 0.7569, 0.7567])
负样本数量： 9529
正样本数量： 6671
TP:  5211
TN:  8316
FP:  1213
FN:  1460
First attempt - auc_val: 0.8830804456 acc_val: 0.8422490230
Epoch: 0000 loss_train: 0.7477444768 auc_train: 0.7641645037 acc_train: 0.6604150010 precision_train: 0.2660688351 recall_train: 0.1571951056 f1_train: 0.1728607180 loss_val: 0.4801947474 auc_val: 0.8789803568 acc_val: 0.8386245115 precision_val: 0.8118827350 recall_val: 0.7832437698 f1_val: 0.7973055044 time: 0.5727s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0000: val_loss 改善从 0.480195 到 0.480195
y_pred: tensor([0.3533, 0.3027, 0.6004,  ..., 0.7626, 0.7567, 0.7786],
       grad_fn=<IndexBackward0>)
负样本数量： 14376
正样本数量： 8826
TP:  6682
TN:  12579
FP:  1797
FN:  2144
batch idx: 0, loss: 0.486082 auc: 0.8771, acc: 0.8301, precision: 0.7881, recall: 0.7571, f1: 0.7723, time: 0.081s
y_pred: tensor([0.2675, 0.2138, 0.1983,  ..., 0.1873, 0.5013, 0.2715],
       grad_fn=<IndexBackward0>)
负样本数量： 14163
正样本数量： 8793
TP:  5953
TN:  13476
FP:  687
FN:  2840
batch idx: 1, loss: 0.435736 auc: 0.8771, acc: 0.8464, precision: 0.8965, recall: 0.6770, f1: 0.7715, time: 0.082s
y_pred: tensor([0.6253, 0.6711, 0.2566,  ..., 0.7601, 0.7342, 0.7029],
       grad_fn=<IndexBackward0>)
负样本数量： 14586
正样本数量： 8552
TP:  5280
TN:  14158
FP:  428
FN:  3272
batch idx: 2, loss: 0.425082 auc: 0.8759, acc: 0.8401, precision: 0.9250, recall: 0.6174, f1: 0.7405, time: 0.082s
y_pred: tensor([0.1927, 0.1554, 0.1404,  ..., 0.1194, 0.3338, 0.5397],
       grad_fn=<IndexBackward0>)
负样本数量： 13748
正样本数量： 8872
TP:  5406
TN:  13365
FP:  383
FN:  3466
batch idx: 3, loss: 0.425211 auc: 0.8783, acc: 0.8298, precision: 0.9338, recall: 0.6093, f1: 0.7375, time: 0.082s
y_pred: tensor([0.1967, 0.1463, 0.1258,  ..., 0.8402, 0.8507, 0.8615],
       grad_fn=<IndexBackward0>)
负样本数量： 3114
正样本数量： 1749
TP:  1107
TN:  2998
FP:  116
FN:  642
batch idx: 4, loss: 0.404971 auc: 0.8720, acc: 0.8441, precision: 0.9052, recall: 0.6329, f1: 0.7450, time: 0.061s
First attempt - auc_train: 0.8771299418 acc_train: 0.8301439531
y_pred: tensor([0.1485, 0.1141, 0.1056,  ..., 0.9034, 0.8967, 0.8877])
负样本数量： 13927
正样本数量： 9322
TP:  6554
TN:  13325
FP:  602
FN:  2768
y_pred: tensor([0.1767, 0.1351, 0.4395,  ..., 0.8882, 0.8889, 0.9074])
负样本数量： 9914
正样本数量： 6834
TP:  4774
TN:  9433
FP:  481
FN:  2060
First attempt - auc_val: 0.8906421547 acc_val: 0.8550475289
Epoch: 0001 loss_train: 0.4354163110 auc_train: 0.8760856715 acc_train: 0.8381124173 precision_train: 0.8897219206 recall_train: 0.6587524868 f1_train: 0.7533357400 loss_val: 0.3848797977 auc_val: 0.8892422786 acc_val: 0.8516639603 precision_val: 0.9121714580 recall_val: 0.7008170024 f1_val: 0.7926469031 time: 0.5056s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0001: val_loss 改善从 0.384880 到 0.384880
y_pred: tensor([0.7465, 0.8341, 0.2427,  ..., 0.8856, 0.8921, 0.8823],
       grad_fn=<IndexBackward0>)
负样本数量： 14296
正样本数量： 8404
TP:  5659
TN:  13672
FP:  624
FN:  2745
batch idx: 0, loss: 0.383799 auc: 0.8819, acc: 0.8516, precision: 0.9007, recall: 0.6734, f1: 0.7706, time: 0.084s
y_pred: tensor([0.1559, 0.1190, 0.1153,  ..., 0.1716, 0.1499, 0.6097],
       grad_fn=<IndexBackward0>)
负样本数量： 14236
正样本数量： 8905
TP:  6112
TN:  13508
FP:  728
FN:  2793
batch idx: 1, loss: 0.393377 auc: 0.8811, acc: 0.8478, precision: 0.8936, recall: 0.6864, f1: 0.7764, time: 0.084s
y_pred: tensor([0.1735, 0.1411, 0.1315,  ..., 0.1390, 0.1251, 0.1219],
       grad_fn=<IndexBackward0>)
负样本数量： 14276
正样本数量： 8886
TP:  6134
TN:  13495
FP:  781
FN:  2752
batch idx: 2, loss: 0.391856 auc: 0.8824, acc: 0.8475, precision: 0.8871, recall: 0.6903, f1: 0.7764, time: 0.087s
y_pred: tensor([0.2144, 0.1563, 0.1447,  ..., 0.1085, 0.1062, 0.1005],
       grad_fn=<IndexBackward0>)
负样本数量： 14445
正样本数量： 8760
TP:  5856
TN:  13734
FP:  711
FN:  2904
batch idx: 3, loss: 0.392862 auc: 0.8757, acc: 0.8442, precision: 0.8917, recall: 0.6685, f1: 0.7641, time: 0.084s
y_pred: tensor([0.2391, 0.1622, 0.3870,  ..., 0.9570, 0.9618, 0.9614],
       grad_fn=<IndexBackward0>)
负样本数量： 2734
正样本数量： 1837
TP:  1209
TN:  2601
FP:  133
FN:  628
batch idx: 4, loss: 0.393123 auc: 0.8842, acc: 0.8335, precision: 0.9009, recall: 0.6581, f1: 0.7606, time: 0.060s
First attempt - auc_train: 0.8819250806 acc_train: 0.8515859031
y_pred: tensor([0.2531, 0.1907, 0.1713,  ..., 0.9682, 0.9746, 0.9744])
负样本数量： 14114
正样本数量： 9614
TP:  6414
TN:  13720
FP:  394
FN:  3200
y_pred: tensor([0.2531, 0.4528, 0.6785,  ..., 0.9662, 0.9686, 0.9667])
负样本数量： 9727
正样本数量： 6542
TP:  4265
TN:  9442
FP:  285
FN:  2277
First attempt - auc_val: 0.8912332125 acc_val: 0.8485333783
Epoch: 0002 loss_train: 0.3910033166 auc_train: 0.8810691466 acc_train: 0.8449255291 precision_train: 0.8947868664 recall_train: 0.6753313141 f1_train: 0.7696303466 loss_val: 0.3736218214 auc_val: 0.8886638991 acc_val: 0.8455279836 precision_val: 0.9397447734 recall_val: 0.6595466861 f1_val: 0.7750849803 time: 0.5146s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0002: val_loss 改善从 0.373622 到 0.373622
y_pred: tensor([0.7888, 0.9144, 0.8452,  ..., 0.1602, 0.1663, 0.1688],
       grad_fn=<IndexBackward0>)
负样本数量： 14520
正样本数量： 8585
TP:  5325
TN:  14121
FP:  399
FN:  3260
batch idx: 0, loss: 0.375815 auc: 0.8846, acc: 0.8416, precision: 0.9303, recall: 0.6203, f1: 0.7443, time: 0.081s
y_pred: tensor([0.2256, 0.1831, 0.1567,  ..., 0.9635, 0.9743, 0.9723],
       grad_fn=<IndexBackward0>)
负样本数量： 14495
正样本数量： 8860
TP:  5380
TN:  14130
FP:  365
FN:  3480
batch idx: 1, loss: 0.383151 auc: 0.8807, acc: 0.8354, precision: 0.9365, recall: 0.6072, f1: 0.7367, time: 0.083s
y_pred: tensor([0.2515, 0.2072, 0.1597,  ..., 0.9794, 0.9768, 0.9649],
       grad_fn=<IndexBackward0>)
负样本数量： 14242
正样本数量： 8649
TP:  5325
TN:  13768
FP:  474
FN:  3324
batch idx: 2, loss: 0.391322 auc: 0.8758, acc: 0.8341, precision: 0.9183, recall: 0.6157, f1: 0.7371, time: 0.084s
y_pred: tensor([0.2256, 0.1768, 0.1616,  ..., 0.9860, 0.9766, 0.9763],
       grad_fn=<IndexBackward0>)
负样本数量： 13758
正样本数量： 8811
TP:  5865
TN:  13212
FP:  546
FN:  2946
batch idx: 3, loss: 0.383735 auc: 0.8796, acc: 0.8453, precision: 0.9148, recall: 0.6656, f1: 0.7706, time: 0.083s
y_pred: tensor([0.2104, 0.1935, 0.1558,  ..., 0.1762, 0.3645, 0.1864],
       grad_fn=<IndexBackward0>)
负样本数量： 2972
正样本数量： 1887
TP:  1324
TN:  2841
FP:  131
FN:  563
batch idx: 4, loss: 0.364226 auc: 0.8951, acc: 0.8572, precision: 0.9100, recall: 0.7016, f1: 0.7923, time: 0.062s
First attempt - auc_train: 0.8845634042 acc_train: 0.8416360095
y_pred: tensor([0.8700, 0.9301, 0.9548,  ..., 0.9652, 0.9680, 0.9724])
负样本数量： 14147
正样本数量： 9554
TP:  6811
TN:  13446
FP:  701
FN:  2743
y_pred: tensor([0.8337, 0.2044, 0.6680,  ..., 0.2485, 0.2291, 0.2215])
负样本数量： 9694
正样本数量： 6602
TP:  4647
TN:  9241
FP:  453
FN:  1955
First attempt - auc_val: 0.8947808234 acc_val: 0.8546896755
Epoch: 0003 loss_train: 0.3796500146 auc_train: 0.8831463338 acc_train: 0.8427066364 precision_train: 0.9219642556 recall_train: 0.6420915068 f1_train: 0.7562164322 loss_val: 0.3679195940 auc_val: 0.8916714537 acc_val: 0.8534616763 precision_val: 0.9089295558 recall_val: 0.7083863677 f1_val: 0.7962092259 time: 0.5103s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0003: val_loss 改善从 0.367920 到 0.367920
y_pred: tensor([0.1731, 0.1212, 0.3265,  ..., 0.9833, 0.9752, 0.9835],
       grad_fn=<IndexBackward0>)
负样本数量： 14352
正样本数量： 8759
TP:  5903
TN:  13711
FP:  641
FN:  2856
batch idx: 0, loss: 0.377867 auc: 0.8853, acc: 0.8487, precision: 0.9020, recall: 0.6739, f1: 0.7715, time: 0.081s
y_pred: tensor([0.1788, 0.1351, 0.1242,  ..., 0.1133, 0.1037, 0.1093],
       grad_fn=<IndexBackward0>)
负样本数量： 14107
正样本数量： 8592
TP:  5711
TN:  13550
FP:  557
FN:  2881
batch idx: 1, loss: 0.373978 auc: 0.8835, acc: 0.8485, precision: 0.9111, recall: 0.6647, f1: 0.7686, time: 0.088s
y_pred: tensor([0.8437, 0.2472, 0.5110,  ..., 0.1378, 0.1312, 0.3803],
       grad_fn=<IndexBackward0>)
负样本数量： 14197
正样本数量： 8901
TP:  5746
TN:  13712
FP:  485
FN:  3155
batch idx: 2, loss: 0.380878 auc: 0.8800, acc: 0.8424, precision: 0.9222, recall: 0.6455, f1: 0.7595, time: 0.083s
y_pred: tensor([0.1644, 0.1169, 0.0997,  ..., 0.9744, 0.9776, 0.9818],
       grad_fn=<IndexBackward0>)
负样本数量： 14502
正样本数量： 8696
TP:  5591
TN:  14061
FP:  441
FN:  3105
batch idx: 3, loss: 0.371068 auc: 0.8874, acc: 0.8471, precision: 0.9269, recall: 0.6429, f1: 0.7592, time: 0.084s
y_pred: tensor([0.8289, 0.1913, 0.1398,  ..., 0.9783, 0.9775, 0.9785],
       grad_fn=<IndexBackward0>)
负样本数量： 2829
正样本数量： 1844
TP:  1240
TN:  2717
FP:  112
FN:  604
batch idx: 4, loss: 0.372344 auc: 0.8896, acc: 0.8468, precision: 0.9172, recall: 0.6725, f1: 0.7760, time: 0.062s
First attempt - auc_train: 0.8852912184 acc_train: 0.8486867725
y_pred: tensor([0.1730, 0.1265, 0.1150,  ..., 0.9786, 0.9816, 0.9847])
负样本数量： 14165
正样本数量： 9277
TP:  6509
TN:  13599
FP:  566
FN:  2768
y_pred: tensor([0.1969, 0.1411, 0.1265,  ..., 0.9718, 0.9671, 0.9714])
负样本数量： 9676
正样本数量： 6879
TP:  4868
TN:  9234
FP:  442
FN:  2011
First attempt - auc_val: 0.8952144761 acc_val: 0.8577766402
Epoch: 0004 loss_train: 0.3752268910 auc_train: 0.8851541164 acc_train: 0.8467116640 precision_train: 0.9158793332 recall_train: 0.6599118765 f1_train: 0.7669555216 loss_val: 0.3617252558 auc_val: 0.8945128634 acc_val: 0.8548019414 precision_val: 0.9183804143 recall_val: 0.7046443393 f1_val: 0.7974317708 time: 0.5184s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0004: val_loss 改善从 0.361725 到 0.361725
y_pred: tensor([0.1386, 0.1126, 0.1035,  ..., 0.9843, 0.7832, 0.8921],
       grad_fn=<IndexBackward0>)
负样本数量： 14313
正样本数量： 8619
TP:  5782
TN:  13767
FP:  546
FN:  2837
batch idx: 0, loss: 0.367348 auc: 0.8894, acc: 0.8525, precision: 0.9137, recall: 0.6708, f1: 0.7737, time: 0.084s
y_pred: tensor([0.2499, 0.1601, 0.3609,  ..., 0.1019, 0.1774, 0.4707],
       grad_fn=<IndexBackward0>)
负样本数量： 14308
正样本数量： 8814
TP:  6088
TN:  13723
FP:  585
FN:  2726
batch idx: 1, loss: 0.364585 auc: 0.8895, acc: 0.8568, precision: 0.9123, recall: 0.6907, f1: 0.7862, time: 0.086s
y_pred: tensor([0.8552, 0.9091, 0.2222,  ..., 0.9841, 0.9858, 0.9844],
       grad_fn=<IndexBackward0>)
负样本数量： 14717
正样本数量： 8655
TP:  5866
TN:  14080
FP:  637
FN:  2789
batch idx: 2, loss: 0.375252 auc: 0.8814, acc: 0.8534, precision: 0.9020, recall: 0.6778, f1: 0.7740, time: 0.084s
y_pred: tensor([0.8467, 0.9147, 0.9467,  ..., 0.9913, 0.9907, 0.9894],
       grad_fn=<IndexBackward0>)
负样本数量： 13650
正样本数量： 9016
TP:  6235
TN:  13060
FP:  590
FN:  2781
batch idx: 3, loss: 0.370152 auc: 0.8908, acc: 0.8513, precision: 0.9136, recall: 0.6915, f1: 0.7872, time: 0.084s
y_pred: tensor([0.1997, 0.4773, 0.1902,  ..., 0.9824, 0.9867, 0.9866],
       grad_fn=<IndexBackward0>)
负样本数量： 2999
正样本数量： 1688
TP:  1042
TN:  2897
FP:  102
FN:  646
batch idx: 4, loss: 0.386921 auc: 0.8693, acc: 0.8404, precision: 0.9108, recall: 0.6173, f1: 0.7359, time: 0.064s
First attempt - auc_train: 0.8893892142 acc_train: 0.8524768882
y_pred: tensor([0.1838, 0.1271, 0.1122,  ..., 0.7994, 0.8277, 0.8618])
负样本数量： 13845
正样本数量： 9894
TP:  6858
TN:  13378
FP:  467
FN:  3036
y_pred: tensor([0.2629, 0.1802, 0.1543,  ..., 0.1996, 0.1951, 0.3633])
负样本数量： 9996
正样本数量： 6262
TP:  4268
TN:  9666
FP:  330
FN:  1994
First attempt - auc_val: 0.8948590195 acc_val: 0.8524369182
Epoch: 0005 loss_train: 0.3728516161 auc_train: 0.8840818205 acc_train: 0.8508757912 precision_train: 0.9104975164 recall_train: 0.6696336507 f1_train: 0.7713857928 loss_val: 0.3575072140 auc_val: 0.8953629509 acc_val: 0.8547459532 precision_val: 0.9322376994 recall_val: 0.6873593725 f1_val: 0.7912828103 time: 0.5293s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0005: val_loss 改善从 0.357507 到 0.357507
y_pred: tensor([0.1892, 0.1365, 0.1158,  ..., 0.1324, 0.1367, 0.1259],
       grad_fn=<IndexBackward0>)
负样本数量： 13978
正样本数量： 8781
TP:  5809
TN:  13525
FP:  453
FN:  2972
batch idx: 0, loss: 0.363803 auc: 0.8905, acc: 0.8495, precision: 0.9277, recall: 0.6615, f1: 0.7723, time: 0.083s
y_pred: tensor([0.2154, 0.1602, 0.1453,  ..., 0.9864, 0.9902, 0.9893],
       grad_fn=<IndexBackward0>)
负样本数量： 14626
正样本数量： 8594
TP:  5569
TN:  14135
FP:  491
FN:  3025
batch idx: 1, loss: 0.368176 auc: 0.8878, acc: 0.8486, precision: 0.9190, recall: 0.6480, f1: 0.7601, time: 0.084s
y_pred: tensor([0.1418, 0.0976, 0.0919,  ..., 0.9914, 0.9875, 0.9881],
       grad_fn=<IndexBackward0>)
负样本数量： 14385
正样本数量： 8576
TP:  5686
TN:  13892
FP:  493
FN:  2890
batch idx: 2, loss: 0.365046 auc: 0.8869, acc: 0.8527, precision: 0.9202, recall: 0.6630, f1: 0.7707, time: 0.084s
y_pred: tensor([0.1869, 0.3397, 0.1310,  ..., 0.9902, 0.9857, 0.9870],
       grad_fn=<IndexBackward0>)
负样本数量： 14135
正样本数量： 9016
TP:  6186
TN:  13620
FP:  515
FN:  2830
batch idx: 3, loss: 0.363914 auc: 0.8896, acc: 0.8555, precision: 0.9231, recall: 0.6861, f1: 0.7872, time: 0.085s
y_pred: tensor([0.1454, 0.1185, 0.1127,  ..., 0.9871, 0.9892, 0.9866],
       grad_fn=<IndexBackward0>)
负样本数量： 2863
正样本数量： 1825
TP:  1238
TN:  2737
FP:  126
FN:  587
batch idx: 4, loss: 0.374526 auc: 0.8877, acc: 0.8479, precision: 0.9076, recall: 0.6784, f1: 0.7764, time: 0.062s
First attempt - auc_train: 0.8905225807 acc_train: 0.8495100839
y_pred: tensor([0.1227, 0.4515, 0.2385,  ..., 0.0993, 0.0978, 0.4313])
负样本数量： 14180
正样本数量： 9714
TP:  6744
TN:  13720
FP:  460
FN:  2970
y_pred: tensor([0.1463, 0.1050, 0.0956,  ..., 0.9832, 0.9910, 0.9897])
负样本数量： 9661
正样本数量： 6442
TP:  4389
TN:  9365
FP:  296
FN:  2053
First attempt - auc_val: 0.9000505356 acc_val: 0.8564493178
Epoch: 0006 loss_train: 0.3670932412 auc_train: 0.8884843620 acc_train: 0.8508350928 precision_train: 0.9195239704 recall_train: 0.6674070011 f1_train: 0.7733397433 loss_val: 0.3545608819 auc_val: 0.8959246832 acc_val: 0.8552879390 precision_val: 0.9364831112 recall_val: 0.6877829328 f1_val: 0.7930746218 time: 0.5159s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0006: val_loss 改善从 0.354561 到 0.354561
y_pred: tensor([0.1840, 0.1464, 0.1307,  ..., 0.1759, 0.1842, 0.1944],
       grad_fn=<IndexBackward0>)
负样本数量： 14160
正样本数量： 8418
TP:  5505
TN:  13743
FP:  417
FN:  2913
batch idx: 0, loss: 0.359621 auc: 0.8894, acc: 0.8525, precision: 0.9296, recall: 0.6540, f1: 0.7678, time: 0.083s
y_pred: tensor([0.7738, 0.1836, 0.1303,  ..., 0.9847, 0.9880, 0.9882],
       grad_fn=<IndexBackward0>)
负样本数量： 14542
正样本数量： 8900
TP:  5695
TN:  14086
FP:  456
FN:  3205
batch idx: 1, loss: 0.369012 auc: 0.8877, acc: 0.8438, precision: 0.9259, recall: 0.6399, f1: 0.7568, time: 0.087s
y_pred: tensor([0.1670, 0.1236, 0.1218,  ..., 0.2607, 0.1693, 0.1574],
       grad_fn=<IndexBackward0>)
负样本数量： 14499
正样本数量： 8515
TP:  5561
TN:  14072
FP:  427
FN:  2954
batch idx: 2, loss: 0.356462 auc: 0.8926, acc: 0.8531, precision: 0.9287, recall: 0.6531, f1: 0.7669, time: 0.085s
y_pred: tensor([0.2094, 0.1503, 0.1383,  ..., 0.2039, 0.1970, 0.1657],
       grad_fn=<IndexBackward0>)
负样本数量： 14025
正样本数量： 9061
TP:  6160
TN:  13510
FP:  515
FN:  2901
batch idx: 3, loss: 0.365471 auc: 0.8905, acc: 0.8520, precision: 0.9228, recall: 0.6798, f1: 0.7829, time: 0.088s
y_pred: tensor([0.1528, 0.1146, 0.0998,  ..., 0.9865, 0.9886, 0.9864],
       grad_fn=<IndexBackward0>)
负样本数量： 2761
正样本数量： 1898
TP:  1362
TN:  2663
FP:  98
FN:  536
batch idx: 4, loss: 0.343832 auc: 0.9033, acc: 0.8639, precision: 0.9329, recall: 0.7176, f1: 0.8112, time: 0.064s
First attempt - auc_train: 0.8894292757 acc_train: 0.8525112942
y_pred: tensor([0.7679, 0.1813, 0.1283,  ..., 0.9907, 0.9883, 0.9894])
负样本数量： 14280
正样本数量： 9225
TP:  6428
TN:  13792
FP:  488
FN:  2797
y_pred: tensor([0.1721, 0.1298, 0.1217,  ..., 0.9906, 0.9895, 0.9878])
负样本数量： 9561
正样本数量： 6931
TP:  4933
TN:  9209
FP:  352
FN:  1998
First attempt - auc_val: 0.8952991012 acc_val: 0.8602425016
Epoch: 0007 loss_train: 0.3588794172 auc_train: 0.8927142645 acc_train: 0.8530757733 precision_train: 0.9279728363 recall_train: 0.6688720756 f1_train: 0.7771067769 loss_val: 0.3509785086 auc_val: 0.8976498494 acc_val: 0.8588745857 precision_val: 0.9314176935 recall_val: 0.7042660386 f1_val: 0.8020551748 time: 0.5288s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0007: val_loss 改善从 0.350979 到 0.350979
y_pred: tensor([0.2024, 0.2597, 0.1176,  ..., 0.9586, 0.8238, 0.9060],
       grad_fn=<IndexBackward0>)
负样本数量： 14421
正样本数量： 8835
TP:  5952
TN:  13959
FP:  462
FN:  2883
batch idx: 0, loss: 0.357249 auc: 0.8929, acc: 0.8562, precision: 0.9280, recall: 0.6737, f1: 0.7806, time: 0.084s
y_pred: tensor([0.1848, 0.1291, 0.1213,  ..., 0.9881, 0.9895, 0.9826],
       grad_fn=<IndexBackward0>)
负样本数量： 14531
正样本数量： 8519
TP:  5533
TN:  14110
FP:  421
FN:  2986
batch idx: 1, loss: 0.358834 auc: 0.8907, acc: 0.8522, precision: 0.9293, recall: 0.6495, f1: 0.7646, time: 0.090s
y_pred: tensor([0.8024, 0.8127, 0.1905,  ..., 0.9880, 0.9884, 0.9879],
       grad_fn=<IndexBackward0>)
负样本数量： 14496
正样本数量： 8357
TP:  5410
TN:  14060
FP:  436
FN:  2947
batch idx: 2, loss: 0.361162 auc: 0.8859, acc: 0.8520, precision: 0.9254, recall: 0.6474, f1: 0.7618, time: 0.088s
y_pred: tensor([0.8099, 0.8761, 0.8782,  ..., 0.9591, 0.9650, 0.9723],
       grad_fn=<IndexBackward0>)
负样本数量： 13613
正样本数量： 9389
TP:  6510
TN:  13125
FP:  488
FN:  2879
batch idx: 3, loss: 0.354220 auc: 0.8981, acc: 0.8536, precision: 0.9303, recall: 0.6934, f1: 0.7945, time: 0.087s
y_pred: tensor([0.7833, 0.1922, 0.1408,  ..., 0.9886, 0.9911, 0.9920],
       grad_fn=<IndexBackward0>)
负样本数量： 2926
正样本数量： 1692
TP:  1123
TN:  2829
FP:  97
FN:  569
batch idx: 4, loss: 0.356158 auc: 0.8890, acc: 0.8558, precision: 0.9205, recall: 0.6637, f1: 0.7713, time: 0.063s
First attempt - auc_train: 0.8928961204 acc_train: 0.8561661507
y_pred: tensor([0.7816, 0.8458, 0.8825,  ..., 0.7163, 0.8936, 0.8925])
负样本数量： 13514
正样本数量： 10082
TP:  7312
TN:  12981
FP:  533
FN:  2770
y_pred: tensor([0.1895, 0.1264, 0.1125,  ..., 0.9898, 0.9899, 0.9916])
负样本数量： 10327
正样本数量： 6074
TP:  4164
TN:  9959
FP:  368
FN:  1910
First attempt - auc_val: 0.9032944690 acc_val: 0.8600186472
Epoch: 0008 loss_train: 0.3575245857 auc_train: 0.8913241631 acc_train: 0.8539454214 precision_train: 0.9266875963 recall_train: 0.6655222480 f1_train: 0.7745743686 loss_val: 0.3485698253 auc_val: 0.8961735870 acc_val: 0.8605623387 precision_val: 0.9254291415 recall_val: 0.7053989358 f1_val: 0.8004843453 time: 0.5324s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0008: val_loss 改善从 0.348570 到 0.348570
y_pred: tensor([0.1564, 0.1172, 0.1118,  ..., 0.9682, 0.9622, 0.9699],
       grad_fn=<IndexBackward0>)
负样本数量： 14603
正样本数量： 8608
TP:  5871
TN:  14112
FP:  491
FN:  2737
batch idx: 0, loss: 0.349382 auc: 0.8935, acc: 0.8609, precision: 0.9228, recall: 0.6820, f1: 0.7844, time: 0.083s
y_pred: tensor([0.1080, 0.0763, 0.0702,  ..., 0.0723, 0.0768, 0.0755],
       grad_fn=<IndexBackward0>)
负样本数量： 13995
正样本数量： 9254
TP:  6360
TN:  13556
FP:  439
FN:  2894
batch idx: 1, loss: 0.350469 auc: 0.8975, acc: 0.8566, precision: 0.9354, recall: 0.6873, f1: 0.7924, time: 0.087s
y_pred: tensor([0.1363, 0.1096, 0.1113,  ..., 0.9862, 0.9892, 0.9929],
       grad_fn=<IndexBackward0>)
负样本数量： 14117
正样本数量： 8608
TP:  5629
TN:  13652
FP:  465
FN:  2979
batch idx: 2, loss: 0.363712 auc: 0.8880, acc: 0.8484, precision: 0.9237, recall: 0.6539, f1: 0.7657, time: 0.090s
y_pred: tensor([0.1413, 0.0928, 0.0874,  ..., 0.1111, 0.1230, 0.1145],
       grad_fn=<IndexBackward0>)
负样本数量： 14260
正样本数量： 8659
TP:  5830
TN:  13765
FP:  495
FN:  2829
batch idx: 3, loss: 0.350750 auc: 0.8960, acc: 0.8550, precision: 0.9217, recall: 0.6733, f1: 0.7782, time: 0.083s
y_pred: tensor([0.1480, 0.1143, 0.1140,  ..., 0.1041, 0.1044, 0.1016],
       grad_fn=<IndexBackward0>)
负样本数量： 3012
正样本数量： 1663
TP:  1061
TN:  2895
FP:  117
FN:  602
batch idx: 4, loss: 0.374271 auc: 0.8780, acc: 0.8462, precision: 0.9007, recall: 0.6380, f1: 0.7469, time: 0.062s
First attempt - auc_train: 0.8934656686 acc_train: 0.8609280083
y_pred: tensor([0.7562, 0.8065, 0.8440,  ..., 0.9908, 0.9910, 0.9946])
负样本数量： 14501
正样本数量： 9213
TP:  6285
TN:  14058
FP:  443
FN:  2928
y_pred: tensor([0.2202, 0.1495, 0.1354,  ..., 0.9397, 0.9664, 0.9846])
负样本数量： 9340
正样本数量： 6943
TP:  4930
TN:  9053
FP:  287
FN:  2013
First attempt - auc_val: 0.8952281878 acc_val: 0.8578476849
Epoch: 0009 loss_train: 0.3577170432 auc_train: 0.8905875900 acc_train: 0.8534373102 precision_train: 0.9208736757 recall_train: 0.6669056858 f1_train: 0.7735147248 loss_val: 0.3457759619 auc_val: 0.8991134049 acc_val: 0.8582980364 precision_val: 0.9395716538 recall_val: 0.6961279532 f1_val: 0.7996939888 time: 0.5258s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0009: val_loss 改善从 0.345776 到 0.345776
y_pred: tensor([0.6690, 0.1462, 0.0877,  ..., 0.1299, 0.1211, 0.1137],
       grad_fn=<IndexBackward0>)
负样本数量： 14307
正样本数量： 9175
TP:  6138
TN:  13892
FP:  415
FN:  3037
batch idx: 0, loss: 0.354883 auc: 0.8928, acc: 0.8530, precision: 0.9367, recall: 0.6690, f1: 0.7805, time: 0.080s
y_pred: tensor([0.2256, 0.1527, 0.1424,  ..., 0.9280, 0.9657, 0.9525],
       grad_fn=<IndexBackward0>)
负样本数量： 14407
正样本数量： 8695
TP:  5765
TN:  13973
FP:  434
FN:  2930
batch idx: 1, loss: 0.352611 auc: 0.8931, acc: 0.8544, precision: 0.9300, recall: 0.6630, f1: 0.7741, time: 0.084s
y_pred: tensor([0.2203, 0.1471, 0.1346,  ..., 0.2129, 0.1865, 0.1845],
       grad_fn=<IndexBackward0>)
负样本数量： 14138
正样本数量： 8707
TP:  5811
TN:  13674
FP:  464
FN:  2896
batch idx: 2, loss: 0.353878 auc: 0.8946, acc: 0.8529, precision: 0.9261, recall: 0.6674, f1: 0.7757, time: 0.085s
y_pred: tensor([0.2002, 0.1572, 0.1393,  ..., 0.9925, 0.9924, 0.9933],
       grad_fn=<IndexBackward0>)
负样本数量： 14210
正样本数量： 8382
TP:  5611
TN:  13735
FP:  475
FN:  2771
batch idx: 3, loss: 0.351571 auc: 0.8921, acc: 0.8563, precision: 0.9220, recall: 0.6694, f1: 0.7756, time: 0.088s
y_pred: tensor([0.1134, 0.0822, 0.0690,  ..., 0.9568, 0.9769, 0.9867],
       grad_fn=<IndexBackward0>)
负样本数量： 2925
正样本数量： 1833
TP:  1257
TN:  2841
FP:  84
FN:  576
batch idx: 4, loss: 0.340583 auc: 0.9033, acc: 0.8613, precision: 0.9374, recall: 0.6858, f1: 0.7921, time: 0.065s
First attempt - auc_train: 0.8928417312 acc_train: 0.8529937825
y_pred: tensor([0.8118, 0.2315, 0.1722,  ..., 0.9946, 0.9946, 0.9947])
负样本数量： 14014
正样本数量： 9558
TP:  6795
TN:  13535
FP:  479
FN:  2763
y_pred: tensor([0.7548, 0.8192, 0.2496,  ..., 0.5767, 0.6716, 0.2071])
负样本数量： 9827
正样本数量： 6598
TP:  4604
TN:  9450
FP:  377
FN:  1994
First attempt - auc_val: 0.8989656130 acc_val: 0.8624639403
Epoch: 0010 loss_train: 0.3507053673 auc_train: 0.8952051072 acc_train: 0.8555815250 precision_train: 0.9304053824 recall_train: 0.6709164585 f1_train: 0.7796180446 loss_val: 0.3453928679 auc_val: 0.8985943582 acc_val: 0.8590554100 precision_val: 0.9292307055 recall_val: 0.7043549977 f1_val: 0.8013117167 time: 0.5243s
Best model so far, saving...
Epoch 0010: val_loss 没有改善 0.345393，最佳值 0.345776，等待 1/15
y_pred: tensor([0.1195, 0.0814, 0.0727,  ..., 0.9925, 0.9940, 0.9912],
       grad_fn=<IndexBackward0>)
负样本数量： 14840
正样本数量： 8563
TP:  5730
TN:  14388
FP:  452
FN:  2833
batch idx: 0, loss: 0.345996 auc: 0.8943, acc: 0.8596, precision: 0.9269, recall: 0.6692, f1: 0.7772, time: 0.085s
y_pred: tensor([0.1930, 0.2782, 0.1351,  ..., 0.0917, 0.0943, 0.5341],
       grad_fn=<IndexBackward0>)
负样本数量： 14003
正样本数量： 9102
TP:  6158
TN:  13492
FP:  511
FN:  2944
batch idx: 1, loss: 0.357316 auc: 0.8944, acc: 0.8505, precision: 0.9234, recall: 0.6766, f1: 0.7809, time: 0.087s
y_pred: tensor([0.1448, 0.0935, 0.0857,  ..., 0.9892, 0.9894, 0.9894],
       grad_fn=<IndexBackward0>)
负样本数量： 14286
正样本数量： 8759
TP:  5833
TN:  13860
FP:  426
FN:  2926
batch idx: 2, loss: 0.350790 auc: 0.8943, acc: 0.8545, precision: 0.9319, recall: 0.6659, f1: 0.7768, time: 0.084s
y_pred: tensor([0.6538, 0.1175, 0.0744,  ..., 0.4041, 0.4825, 0.2249],
       grad_fn=<IndexBackward0>)
负样本数量： 14054
正样本数量： 8415
TP:  5548
TN:  13675
FP:  379
FN:  2867
batch idx: 3, loss: 0.349094 auc: 0.8932, acc: 0.8555, precision: 0.9361, recall: 0.6593, f1: 0.7737, time: 0.087s
y_pred: tensor([0.2023, 0.1365, 0.1178,  ..., 0.9915, 0.9928, 0.9928],
       grad_fn=<IndexBackward0>)
负样本数量： 2804
正样本数量： 1953
TP:  1338
TN:  2715
FP:  89
FN:  615
batch idx: 4, loss: 0.350993 auc: 0.8989, acc: 0.8520, precision: 0.9376, recall: 0.6851, f1: 0.7917, time: 0.062s
First attempt - auc_train: 0.8942731776 acc_train: 0.8596333803
y_pred: tensor([0.2055, 0.1412, 0.3120,  ..., 0.9895, 0.9891, 0.9880])
负样本数量： 14022
正样本数量： 9479
TP:  6603
TN:  13518
FP:  504
FN:  2876
y_pred: tensor([0.2546, 0.1769, 0.1625,  ..., 0.9934, 0.9917, 0.9935])
负样本数量： 9819
正样本数量： 6677
TP:  4738
TN:  9506
FP:  313
FN:  1939
First attempt - auc_val: 0.8982719294 acc_val: 0.8561763329
Epoch: 0011 loss_train: 0.3508377373 auc_train: 0.8950278986 acc_train: 0.8544371923 precision_train: 0.9311772131 recall_train: 0.6712109854 f1_train: 0.7800657028 loss_val: 0.3424104303 auc_val: 0.8991114061 acc_val: 0.8598291946 precision_val: 0.9335580373 recall_val: 0.7030962937 f1_val: 0.8020972873 time: 0.5270s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0011: val_loss 改善从 0.342410 到 0.342410
y_pred: tensor([0.1331, 0.0955, 0.0822,  ..., 0.9933, 0.9928, 0.9919],
       grad_fn=<IndexBackward0>)
负样本数量： 14227
正样本数量： 8667
TP:  5821
TN:  13728
FP:  499
FN:  2846
batch idx: 0, loss: 0.350849 auc: 0.8950, acc: 0.8539, precision: 0.9210, recall: 0.6716, f1: 0.7768, time: 0.086s
y_pred: tensor([0.7595, 0.8632, 0.9107,  ..., 0.9938, 0.9921, 0.9921],
       grad_fn=<IndexBackward0>)
负样本数量： 13838
正样本数量： 9083
TP:  6167
TN:  13372
FP:  466
FN:  2916
batch idx: 1, loss: 0.354026 auc: 0.8936, acc: 0.8524, precision: 0.9297, recall: 0.6790, f1: 0.7848, time: 0.089s
y_pred: tensor([0.1027, 0.0817, 0.2222,  ..., 0.9630, 0.9744, 0.9839],
       grad_fn=<IndexBackward0>)
负样本数量： 14300
正样本数量： 8675
TP:  5781
TN:  13851
FP:  449
FN:  2894
batch idx: 2, loss: 0.349970 auc: 0.8951, acc: 0.8545, precision: 0.9279, recall: 0.6664, f1: 0.7757, time: 0.087s
y_pred: tensor([0.1851, 0.1463, 0.1147,  ..., 0.0997, 0.0992, 0.1009],
       grad_fn=<IndexBackward0>)
负样本数量： 14735
正样本数量： 8527
TP:  5678
TN:  14336
FP:  399
FN:  2849
batch idx: 3, loss: 0.343657 auc: 0.8952, acc: 0.8604, precision: 0.9343, recall: 0.6659, f1: 0.7776, time: 0.091s
y_pred: tensor([0.1257, 0.0805, 0.0746,  ..., 0.9873, 0.9901, 0.9894],
       grad_fn=<IndexBackward0>)
负样本数量： 2887
正样本数量： 1840
TP:  1254
TN:  2815
FP:  72
FN:  586
batch idx: 4, loss: 0.341379 auc: 0.8989, acc: 0.8608, precision: 0.9457, recall: 0.6815, f1: 0.7922, time: 0.063s
First attempt - auc_train: 0.8949844650 acc_train: 0.8538918494
y_pred: tensor([0.1138, 0.0789, 0.0727,  ..., 0.1529, 0.1524, 0.1520])
负样本数量： 14464
正样本数量： 9245
TP:  6421
TN:  13998
FP:  466
FN:  2824
y_pred: tensor([0.2081, 0.1321, 0.1171,  ..., 0.1192, 0.1160, 0.1134])
负样本数量： 9377
正样本数量： 6911
TP:  4901
TN:  9048
FP:  329
FN:  2010
First attempt - auc_val: 0.8962265390 acc_val: 0.8612341305
Epoch: 0012 loss_train: 0.3479764104 auc_train: 0.8955387335 acc_train: 0.8564016771 precision_train: 0.9317525704 recall_train: 0.6728785960 f1_train: 0.7814173318 loss_val: 0.3424279243 auc_val: 0.8998488464 acc_val: 0.8588157391 precision_val: 0.9347149880 recall_val: 0.7018484496 f1_val: 0.8017022657 time: 0.5410s
Epoch 0012: val_loss 没有改善 0.342428，最佳值 0.342410，等待 1/15
y_pred: tensor([0.2139, 0.1340, 0.3055,  ..., 0.1358, 0.1242, 0.1280],
       grad_fn=<IndexBackward0>)
负样本数量： 14228
正样本数量： 8818
TP:  5945
TN:  13784
FP:  444
FN:  2873
batch idx: 0, loss: 0.342751 auc: 0.8987, acc: 0.8561, precision: 0.9305, recall: 0.6742, f1: 0.7819, time: 0.084s
y_pred: tensor([0.8292, 0.8716, 0.9442,  ..., 0.3514, 0.3069, 0.6115],
       grad_fn=<IndexBackward0>)
负样本数量： 14097
正样本数量： 8754
TP:  5905
TN:  13648
FP:  449
FN:  2849
batch idx: 1, loss: 0.350677 auc: 0.8928, acc: 0.8557, precision: 0.9293, recall: 0.6745, f1: 0.7817, time: 0.086s
y_pred: tensor([0.1192, 0.0792, 0.0754,  ..., 0.1207, 0.2552, 0.2523],
       grad_fn=<IndexBackward0>)
负样本数量： 14496
正样本数量： 8635
TP:  5754
TN:  14056
FP:  440
FN:  2881
batch idx: 2, loss: 0.349928 auc: 0.8921, acc: 0.8564, precision: 0.9290, recall: 0.6664, f1: 0.7760, time: 0.085s
y_pred: tensor([0.1415, 0.1100, 0.1082,  ..., 0.1381, 0.1279, 0.1390],
       grad_fn=<IndexBackward0>)
负样本数量： 14272
正样本数量： 8561
TP:  5624
TN:  13904
FP:  368
FN:  2937
batch idx: 3, loss: 0.343089 auc: 0.8989, acc: 0.8553, precision: 0.9386, recall: 0.6569, f1: 0.7729, time: 0.083s
y_pred: tensor([0.7663, 0.1911, 0.4194,  ..., 0.1038, 0.1044, 0.1067],
       grad_fn=<IndexBackward0>)
负样本数量： 2894
正样本数量： 2024
TP:  1336
TN:  2799
FP:  95
FN:  688
batch idx: 4, loss: 0.363638 auc: 0.8935, acc: 0.8408, precision: 0.9336, recall: 0.6601, f1: 0.7734, time: 0.061s
First attempt - auc_train: 0.8987421812 acc_train: 0.8560704678
y_pred: tensor([0.1386, 0.0939, 0.0859,  ..., 0.9922, 0.9940, 0.9924])
负样本数量： 14085
正样本数量： 9503
TP:  6667
TN:  13663
FP:  422
FN:  2836
y_pred: tensor([0.8192, 0.7988, 0.8668,  ..., 0.1214, 0.5370, 0.1914])
负样本数量： 9756
正样本数量： 6653
TP:  4627
TN:  9416
FP:  340
FN:  2026
First attempt - auc_val: 0.9003391004 acc_val: 0.8618789215
Epoch: 0013 loss_train: 0.3500167906 auc_train: 0.8952020607 acc_train: 0.8528425841 precision_train: 0.9322005118 recall_train: 0.6664214870 f1_train: 0.7771799485 loss_val: 0.3417380005 auc_val: 0.8995705693 acc_val: 0.8588448785 precision_val: 0.9360096854 recall_val: 0.6985218256 f1_val: 0.8000129254 time: 0.5228s
Best model so far, saving...
Epoch 0013: val_loss 没有改善 0.341738，最佳值 0.342410，等待 2/15
y_pred: tensor([0.1387, 0.0954, 0.0938,  ..., 0.9920, 0.9887, 0.9912],
       grad_fn=<IndexBackward0>)
负样本数量： 14154
正样本数量： 8586
TP:  5580
TN:  13731
FP:  423
FN:  3006
batch idx: 0, loss: 0.357929 auc: 0.8884, acc: 0.8492, precision: 0.9295, recall: 0.6499, f1: 0.7650, time: 0.086s
y_pred: tensor([0.7537, 0.1719, 0.0971,  ..., 0.8086, 0.8435, 0.8613],
       grad_fn=<IndexBackward0>)
负样本数量： 13787
正样本数量： 8481
TP:  5746
TN:  13360
FP:  427
FN:  2735
batch idx: 1, loss: 0.339808 auc: 0.9006, acc: 0.8580, precision: 0.9308, recall: 0.6775, f1: 0.7842, time: 0.087s
y_pred: tensor([0.1249, 0.0999, 0.0865,  ..., 0.9733, 0.9865, 0.9894],
       grad_fn=<IndexBackward0>)
负样本数量： 14565
正样本数量： 8842
TP:  5937
TN:  14145
FP:  420
FN:  2905
batch idx: 2, loss: 0.343156 auc: 0.8968, acc: 0.8579, precision: 0.9339, recall: 0.6715, f1: 0.7812, time: 0.087s
y_pred: tensor([0.1508, 0.0996, 0.2670,  ..., 0.9933, 0.9945, 0.9956],
       grad_fn=<IndexBackward0>)
负样本数量： 14599
正样本数量： 8912
TP:  5943
TN:  14212
FP:  387
FN:  2969
batch idx: 3, loss: 0.341530 auc: 0.8987, acc: 0.8573, precision: 0.9389, recall: 0.6669, f1: 0.7798, time: 0.087s
y_pred: tensor([0.2232, 0.1523, 0.1475,  ..., 0.0730, 0.0725, 0.0761],
       grad_fn=<IndexBackward0>)
负样本数量： 2882
正样本数量： 1971
TP:  1335
TN:  2780
FP:  102
FN:  636
batch idx: 4, loss: 0.357071 auc: 0.8906, acc: 0.8479, precision: 0.9290, recall: 0.6773, f1: 0.7835, time: 0.063s
First attempt - auc_train: 0.8883787316 acc_train: 0.8492084433
y_pred: tensor([0.1449, 0.3274, 0.1638,  ..., 0.9936, 0.9946, 0.1571])
负样本数量： 13905
正样本数量： 9679
TP:  6714
TN:  13526
FP:  379
FN:  2965
y_pred: tensor([0.1449, 0.0971, 0.0887,  ..., 0.9949, 0.9963, 0.9963])
负样本数量： 9936
正样本数量： 6477
TP:  4457
TN:  9686
FP:  250
FN:  2020
First attempt - auc_val: 0.8981803003 acc_val: 0.8582089552
Epoch: 0014 loss_train: 0.3478990555 auc_train: 0.8950133024 acc_train: 0.8540693711 precision_train: 0.9324350958 recall_train: 0.6686077763 f1_train: 0.7787375745 loss_val: 0.3394236714 auc_val: 0.9003873918 acc_val: 0.8599519765 precision_val: 0.9467273261 recall_val: 0.6908969602 f1_val: 0.7988257773 time: 0.5287s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0014: val_loss 改善从 0.339424 到 0.339424
y_pred: tensor([0.2206, 0.4288, 0.4476,  ..., 0.9926, 0.9945, 0.9931],
       grad_fn=<IndexBackward0>)
负样本数量： 14369
正样本数量： 8755
TP:  5754
TN:  14006
FP:  363
FN:  3001
batch idx: 0, loss: 0.347863 auc: 0.8936, acc: 0.8545, precision: 0.9407, recall: 0.6572, f1: 0.7738, time: 0.084s
y_pred: tensor([0.2273, 0.1449, 0.1375,  ..., 0.8368, 0.8467, 0.9178],
       grad_fn=<IndexBackward0>)
负样本数量： 14571
正样本数量： 8206
TP:  5271
TN:  14185
FP:  386
FN:  2935
batch idx: 1, loss: 0.349658 auc: 0.8891, acc: 0.8542, precision: 0.9318, recall: 0.6423, f1: 0.7604, time: 0.087s
y_pred: tensor([0.1517, 0.1030, 0.0878,  ..., 0.2604, 0.2574, 0.2510],
       grad_fn=<IndexBackward0>)
负样本数量： 14294
正样本数量： 8764
TP:  5835
TN:  13912
FP:  382
FN:  2929
batch idx: 2, loss: 0.342420 auc: 0.8970, acc: 0.8564, precision: 0.9386, recall: 0.6658, f1: 0.7790, time: 0.088s
y_pred: tensor([0.8034, 0.2014, 0.3603,  ..., 0.9889, 0.9934, 0.9936],
       grad_fn=<IndexBackward0>)
负样本数量： 13699
正样本数量： 9343
TP:  6424
TN:  13241
FP:  458
FN:  2919
batch idx: 3, loss: 0.340217 auc: 0.9048, acc: 0.8534, precision: 0.9334, recall: 0.6876, f1: 0.7919, time: 0.086s
y_pred: tensor([0.1561, 0.1141, 0.1059,  ..., 0.9940, 0.9949, 0.9932],
       grad_fn=<IndexBackward0>)
负样本数量： 3054
正样本数量： 1724
TP:  1166
TN:  2963
FP:  91
FN:  558
batch idx: 4, loss: 0.336274 auc: 0.8971, acc: 0.8642, precision: 0.9276, recall: 0.6763, f1: 0.7823, time: 0.063s
First attempt - auc_train: 0.8935869024 acc_train: 0.8545234389
y_pred: tensor([0.8605, 0.8833, 0.3461,  ..., 0.6255, 0.7063, 0.7652])
负样本数量： 14083
正样本数量： 9534
TP:  6547
TN:  13698
FP:  385
FN:  2987
y_pred: tensor([0.7772, 0.1741, 0.1284,  ..., 0.6848, 0.8843, 0.9503])
负样本数量： 9758
正样本数量： 6622
TP:  4636
TN:  9500
FP:  258
FN:  1986
First attempt - auc_val: 0.8992766088 acc_val: 0.8572214930
Epoch: 0015 loss_train: 0.3432863832 auc_train: 0.8963215252 acc_train: 0.8565469392 precision_train: 0.9344067401 recall_train: 0.6658517774 f1_train: 0.7774767058 loss_val: 0.3380401284 auc_val: 0.9005368817 acc_val: 0.8601125780 precision_val: 0.9458714299 recall_val: 0.6933954189 f1_val: 0.8001775275 time: 0.5321s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0015: val_loss 改善从 0.338040 到 0.338040
y_pred: tensor([0.2196, 0.1395, 0.1301,  ..., 0.9853, 0.9898, 0.9914],
       grad_fn=<IndexBackward0>)
负样本数量： 14343
正样本数量： 8390
TP:  5456
TN:  13987
FP:  356
FN:  2934
batch idx: 0, loss: 0.345730 auc: 0.8932, acc: 0.8553, precision: 0.9387, recall: 0.6503, f1: 0.7683, time: 0.089s
y_pred: tensor([0.1543, 0.0920, 0.0770,  ..., 0.1566, 0.1581, 0.1410],
       grad_fn=<IndexBackward0>)
负样本数量： 14257
正样本数量： 8795
TP:  5756
TN:  13950
FP:  307
FN:  3039
batch idx: 1, loss: 0.341475 auc: 0.8985, acc: 0.8548, precision: 0.9494, recall: 0.6545, f1: 0.7748, time: 0.094s
y_pred: tensor([0.1493, 0.6015, 0.5621,  ..., 0.1169, 0.1053, 0.1000],
       grad_fn=<IndexBackward0>)
负样本数量： 14735
正样本数量： 8752
TP:  5704
TN:  14394
FP:  341
FN:  3048
batch idx: 2, loss: 0.341095 auc: 0.8969, acc: 0.8557, precision: 0.9436, recall: 0.6517, f1: 0.7710, time: 0.094s
y_pred: tensor([0.2089, 0.4560, 0.4555,  ..., 0.9937, 0.9962, 0.9951],
       grad_fn=<IndexBackward0>)
负样本数量： 13842
正样本数量： 9098
TP:  6182
TN:  13400
FP:  442
FN:  2916
batch idx: 3, loss: 0.347164 auc: 0.8967, acc: 0.8536, precision: 0.9333, recall: 0.6795, f1: 0.7864, time: 0.088s
y_pred: tensor([0.7416, 0.1458, 0.1057,  ..., 0.9860, 0.9924, 0.9946],
       grad_fn=<IndexBackward0>)
负样本数量： 2810
正样本数量： 1757
TP:  1212
TN:  2722
FP:  88
FN:  545
batch idx: 4, loss: 0.335326 auc: 0.9035, acc: 0.8614, precision: 0.9323, recall: 0.6898, f1: 0.7929, time: 0.060s
First attempt - auc_train: 0.8932305252 acc_train: 0.8552764703
y_pred: tensor([0.1322, 0.0911, 0.0841,  ..., 0.9952, 0.9947, 0.9934])
负样本数量： 13976
正样本数量： 9654
TP:  6786
TN:  13508
FP:  468
FN:  2868
y_pred: tensor([0.1322, 0.0911, 0.0841,  ..., 0.1715, 0.1670, 0.1457])
负样本数量： 9865
正样本数量： 6502
TP:  4600
TN:  9557
FP:  308
FN:  1902
First attempt - auc_val: 0.9013459910 acc_val: 0.8588235294
Epoch: 0016 loss_train: 0.3421577394 auc_train: 0.8977534350 acc_train: 0.8561697800 precision_train: 0.9394565605 recall_train: 0.6651599321 f1_train: 0.7786918440 loss_val: 0.3378532976 auc_val: 0.9001961957 acc_val: 0.8618978648 precision_val: 0.9363645924 recall_val: 0.7051978461 f1_val: 0.8045036012 time: 0.5463s
Best model so far, saving...
Epoch 0016: val_loss 没有改善 0.337853，最佳值 0.338040，等待 1/15
y_pred: tensor([0.1358, 0.0883, 0.0824,  ..., 0.0788, 0.0753, 0.4241],
       grad_fn=<IndexBackward0>)
负样本数量： 14057
正样本数量： 8906
TP:  6114
TN:  13636
FP:  421
FN:  2792
batch idx: 0, loss: 0.337846 auc: 0.8991, acc: 0.8601, precision: 0.9356, recall: 0.6865, f1: 0.7919, time: 0.084s
y_pred: tensor([0.1213, 0.2935, 0.1735,  ..., 0.9909, 0.9917, 0.9921],
       grad_fn=<IndexBackward0>)
负样本数量： 14550
正样本数量： 8533
TP:  5446
TN:  14222
FP:  328
FN:  3087
batch idx: 1, loss: 0.345065 auc: 0.8934, acc: 0.8521, precision: 0.9432, recall: 0.6382, f1: 0.7613, time: 0.085s
y_pred: tensor([0.8332, 0.2478, 0.1639,  ..., 0.1349, 0.1139, 0.1147],
       grad_fn=<IndexBackward0>)
负样本数量： 14487
正样本数量： 8715
TP:  5696
TN:  14186
FP:  301
FN:  3019
batch idx: 2, loss: 0.339831 auc: 0.8982, acc: 0.8569, precision: 0.9498, recall: 0.6536, f1: 0.7743, time: 0.085s
y_pred: tensor([0.0985, 0.0703, 0.0596,  ..., 0.7728, 0.9022, 0.9357],
       grad_fn=<IndexBackward0>)
负样本数量： 14064
正样本数量： 8984
TP:  5924
TN:  13670
FP:  394
FN:  3060
batch idx: 3, loss: 0.345969 auc: 0.8970, acc: 0.8501, precision: 0.9376, recall: 0.6594, f1: 0.7743, time: 0.087s
y_pred: tensor([0.2026, 0.1461, 0.1546,  ..., 0.0632, 0.0590, 0.0635],
       grad_fn=<IndexBackward0>)
负样本数量： 2829
正样本数量： 1654
TP:  1087
TN:  2747
FP:  82
FN:  567
batch idx: 4, loss: 0.338463 auc: 0.9024, acc: 0.8552, precision: 0.9299, recall: 0.6572, f1: 0.7701, time: 0.066s
First attempt - auc_train: 0.8991299275 acc_train: 0.8600792579
y_pred: tensor([0.2003, 0.1390, 0.3334,  ..., 0.1089, 0.1058, 0.1036])
负样本数量： 13691
正样本数量： 9834
TP:  7003
TN:  13305
FP:  386
FN:  2831
y_pred: tensor([0.1904, 0.2921, 0.1344,  ..., 0.9912, 0.9954, 0.9958])
负样本数量： 10150
正样本数量： 6322
TP:  4281
TN:  9858
FP:  292
FN:  2041
First attempt - auc_val: 0.9068845999 acc_val: 0.8632518597
Epoch: 0017 loss_train: 0.3414347827 auc_train: 0.8980270902 acc_train: 0.8548826967 precision_train: 0.9392145185 recall_train: 0.6589812934 f1_train: 0.7743875507 loss_val: 0.3380174786 auc_val: 0.8991145789 acc_val: 0.8608087856 precision_val: 0.9419535668 recall_val: 0.6946401695 f1_val: 0.7995399814 time: 0.5339s
Epoch 0017: val_loss 没有改善 0.338017，最佳值 0.338040，等待 2/15
y_pred: tensor([0.1229, 0.0842, 0.0842,  ..., 0.1787, 0.1619, 0.1615],
       grad_fn=<IndexBackward0>)
负样本数量： 13872
正样本数量： 8612
TP:  5742
TN:  13495
FP:  377
FN:  2870
batch idx: 0, loss: 0.341555 auc: 0.8982, acc: 0.8556, precision: 0.9384, recall: 0.6667, f1: 0.7796, time: 0.084s
y_pred: tensor([0.0889, 0.0671, 0.0631,  ..., 0.9944, 0.9954, 0.9953],
       grad_fn=<IndexBackward0>)
负样本数量： 14474
正样本数量： 8796
TP:  5836
TN:  14128
FP:  346
FN:  2960
batch idx: 1, loss: 0.339971 auc: 0.8967, acc: 0.8579, precision: 0.9440, recall: 0.6635, f1: 0.7793, time: 0.089s
y_pred: tensor([0.1361, 0.2870, 0.1521,  ..., 0.9940, 0.9961, 0.9916],
       grad_fn=<IndexBackward0>)
负样本数量： 14173
正样本数量： 8586
TP:  5625
TN:  13841
FP:  332
FN:  2961
batch idx: 2, loss: 0.338271 auc: 0.8983, acc: 0.8553, precision: 0.9443, recall: 0.6551, f1: 0.7736, time: 0.088s
y_pred: tensor([0.1272, 0.0891, 0.0856,  ..., 0.9943, 0.9944, 0.9944],
       grad_fn=<IndexBackward0>)
负样本数量： 14365
正样本数量： 8891
TP:  5834
TN:  14042
FP:  323
FN:  3057
batch idx: 3, loss: 0.342984 auc: 0.8970, acc: 0.8547, precision: 0.9475, recall: 0.6562, f1: 0.7754, time: 0.088s
y_pred: tensor([0.7786, 0.8274, 0.8638,  ..., 0.9949, 0.9948, 0.9953],
       grad_fn=<IndexBackward0>)
负样本数量： 3103
正样本数量： 1907
TP:  1259
TN:  3031
FP:  72
FN:  648
batch idx: 4, loss: 0.335923 auc: 0.9022, acc: 0.8563, precision: 0.9459, recall: 0.6602, f1: 0.7776, time: 0.063s
First attempt - auc_train: 0.8982439297 acc_train: 0.8555861946
y_pred: tensor([0.8054, 0.8788, 0.8515,  ..., 0.8881, 0.9518, 0.9782])
负样本数量： 14051
正样本数量： 9627
TP:  6783
TN:  13656
FP:  395
FN:  2844
y_pred: tensor([0.2075, 0.4264, 0.4050,  ..., 0.9903, 0.9958, 0.9947])
负样本数量： 9790
正样本数量： 6529
TP:  4554
TN:  9510
FP:  280
FN:  1975
First attempt - auc_val: 0.9022437421 acc_val: 0.8632063519
Epoch: 0018 loss_train: 0.3397407234 auc_train: 0.8984885389 acc_train: 0.8559546867 precision_train: 0.9440263305 recall_train: 0.6603464347 f1_train: 0.7770901480 loss_val: 0.3365491480 auc_val: 0.9007878385 acc_val: 0.8625119326 precision_val: 0.9435238494 recall_val: 0.7010421562 f1_val: 0.8044043154 time: 0.5395s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0018: val_loss 改善从 0.336549 到 0.336549
y_pred: tensor([0.1666, 0.1479, 0.1385,  ..., 0.9945, 0.9965, 0.9946],
       grad_fn=<IndexBackward0>)
负样本数量： 14316
正样本数量： 8579
TP:  5739
TN:  13938
FP:  378
FN:  2840
batch idx: 0, loss: 0.338742 auc: 0.8970, acc: 0.8594, precision: 0.9382, recall: 0.6690, f1: 0.7810, time: 0.088s
y_pred: tensor([0.1309, 0.0941, 0.0890,  ..., 0.0868, 0.1403, 0.2483],
       grad_fn=<IndexBackward0>)
负样本数量： 14350
正样本数量： 8928
TP:  6050
TN:  13976
FP:  374
FN:  2878
batch idx: 1, loss: 0.333455 auc: 0.9032, acc: 0.8603, precision: 0.9418, recall: 0.6776, f1: 0.7882, time: 0.089s
y_pred: tensor([0.2237, 0.1444, 0.1353,  ..., 0.9453, 0.9759, 0.9804],
       grad_fn=<IndexBackward0>)
负样本数量： 14740
正样本数量： 8692
TP:  5700
TN:  14407
FP:  333
FN:  2992
batch idx: 2, loss: 0.336011 auc: 0.8986, acc: 0.8581, precision: 0.9448, recall: 0.6558, f1: 0.7742, time: 0.088s
y_pred: tensor([0.1227, 0.0811, 0.0759,  ..., 0.9590, 0.9806, 0.9881],
       grad_fn=<IndexBackward0>)
负样本数量： 13757
正样本数量： 8910
TP:  5825
TN:  13427
FP:  330
FN:  3085
batch idx: 3, loss: 0.349513 auc: 0.8941, acc: 0.8493, precision: 0.9464, recall: 0.6538, f1: 0.7733, time: 0.089s
y_pred: tensor([0.1270, 0.0987, 0.0796,  ..., 0.9958, 0.9959, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 2824
正样本数量： 1683
TP:  1089
TN:  2769
FP:  55
FN:  594
batch idx: 4, loss: 0.348248 auc: 0.8893, acc: 0.8560, precision: 0.9519, recall: 0.6471, f1: 0.7704, time: 0.065s
First attempt - auc_train: 0.8969605249 acc_train: 0.8594452937
y_pred: tensor([0.2520, 0.1831, 0.1726,  ..., 0.1891, 0.1819, 0.1767])
负样本数量： 13941
正样本数量： 9541
TP:  6664
TN:  13599
FP:  342
FN:  2877
y_pred: tensor([0.0931, 0.0670, 0.0630,  ..., 0.9959, 0.9931, 0.9959])
负样本数量： 9900
正样本数量： 6615
TP:  4512
TN:  9642
FP:  258
FN:  2103
First attempt - auc_val: 0.9026223575 acc_val: 0.8629162763
Epoch: 0019 loss_train: 0.3411938012 auc_train: 0.8964415732 acc_train: 0.8566369660 precision_train: 0.9446195069 recall_train: 0.6606393050 f1_train: 0.7774273940 loss_val: 0.3357508779 auc_val: 0.9011871531 acc_val: 0.8599776659 precision_val: 0.9485483243 recall_val: 0.6902727244 f1_val: 0.7990425484 time: 0.5464s
Best model so far, saving...
Epoch 0019: val_loss 没有改善 0.335751，最佳值 0.336549，等待 1/15
y_pred: tensor([0.2191, 0.1539, 0.1322,  ..., 0.9963, 0.9920, 0.9955],
       grad_fn=<IndexBackward0>)
负样本数量： 14473
正样本数量： 8931
TP:  5936
TN:  14099
FP:  374
FN:  2995
batch idx: 0, loss: 0.338074 auc: 0.8989, acc: 0.8561, precision: 0.9407, recall: 0.6647, f1: 0.7790, time: 0.083s
y_pred: tensor([0.7498, 0.8329, 0.1901,  ..., 0.9968, 0.9953, 0.9969],
       grad_fn=<IndexBackward0>)
负样本数量： 14188
正样本数量： 9085
TP:  6183
TN:  13854
FP:  334
FN:  2902
batch idx: 1, loss: 0.330234 auc: 0.9050, acc: 0.8610, precision: 0.9487, recall: 0.6806, f1: 0.7926, time: 0.085s
y_pred: tensor([0.8253, 0.7916, 0.1669,  ..., 0.9964, 0.9964, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 13743
正样本数量： 8638
TP:  5736
TN:  13421
FP:  322
FN:  2902
batch idx: 2, loss: 0.340021 auc: 0.8972, acc: 0.8559, precision: 0.9468, recall: 0.6640, f1: 0.7806, time: 0.090s
y_pred: tensor([0.2120, 0.1365, 0.1327,  ..., 0.9913, 0.9866, 0.9893],
       grad_fn=<IndexBackward0>)
负样本数量： 14638
正样本数量： 8524
TP:  5466
TN:  14337
FP:  301
FN:  3058
batch idx: 3, loss: 0.341488 auc: 0.8960, acc: 0.8550, precision: 0.9478, recall: 0.6412, f1: 0.7650, time: 0.085s
y_pred: tensor([0.1315, 0.0894, 0.0835,  ..., 0.9493, 0.7814, 0.8314],
       grad_fn=<IndexBackward0>)
负样本数量： 2945
正样本数量： 1614
TP:  984
TN:  2890
FP:  55
FN:  630
batch idx: 4, loss: 0.359794 auc: 0.8795, acc: 0.8497, precision: 0.9471, recall: 0.6097, f1: 0.7418, time: 0.061s
First attempt - auc_train: 0.8988789685 acc_train: 0.8560502478
y_pred: tensor([0.8712, 0.9017, 0.9222,  ..., 0.9826, 0.9932, 0.9914])
负样本数量： 13856
正样本数量： 9714
TP:  6761
TN:  13544
FP:  312
FN:  2953
y_pred: tensor([0.1285, 0.0893, 0.0830,  ..., 0.9182, 0.9871, 0.9896])
负样本数量： 9985
正样本数量： 6442
TP:  4328
TN:  9746
FP:  239
FN:  2114
First attempt - auc_val: 0.9038381739 acc_val: 0.8614764531
Epoch: 0020 loss_train: 0.3419221640 auc_train: 0.8953145235 acc_train: 0.8555359956 precision_train: 0.9462393081 recall_train: 0.6520359714 f1_train: 0.7717842965 loss_val: 0.3356298953 auc_val: 0.9010738693 acc_val: 0.8591183325 precision_val: 0.9517783219 recall_val: 0.6839234040 f1_val: 0.7958850209 time: 0.5259s
Best model so far, saving...
Epoch 0020: val_loss 没有改善 0.335630，最佳值 0.336549，等待 2/15
y_pred: tensor([0.1406, 0.1090, 0.1138,  ..., 0.8943, 0.9075, 0.9169],
       grad_fn=<IndexBackward0>)
负样本数量： 14528
正样本数量： 8304
TP:  5304
TN:  14208
FP:  320
FN:  3000
batch idx: 0, loss: 0.340086 auc: 0.8965, acc: 0.8546, precision: 0.9431, recall: 0.6387, f1: 0.7616, time: 0.085s
y_pred: tensor([0.2356, 0.1364, 0.1331,  ..., 0.7859, 0.7175, 0.8757],
       grad_fn=<IndexBackward0>)
负样本数量： 14206
正样本数量： 8774
TP:  5795
TN:  13937
FP:  269
FN:  2979
batch idx: 1, loss: 0.335943 auc: 0.8989, acc: 0.8587, precision: 0.9556, recall: 0.6605, f1: 0.7811, time: 0.091s
y_pred: tensor([0.1998, 0.1502, 0.1321,  ..., 0.2021, 0.2057, 0.3115],
       grad_fn=<IndexBackward0>)
负样本数量： 14057
正样本数量： 8979
TP:  5997
TN:  13757
FP:  300
FN:  2982
batch idx: 2, loss: 0.334423 auc: 0.9019, acc: 0.8575, precision: 0.9524, recall: 0.6679, f1: 0.7852, time: 0.088s
y_pred: tensor([0.1950, 0.1526, 0.1363,  ..., 0.0930, 0.0911, 0.0946],
       grad_fn=<IndexBackward0>)
负样本数量： 14270
正样本数量： 8874
TP:  5822
TN:  13954
FP:  316
FN:  3052
batch idx: 3, loss: 0.341529 auc: 0.8977, acc: 0.8545, precision: 0.9485, recall: 0.6561, f1: 0.7756, time: 0.086s
y_pred: tensor([0.1255, 0.0870, 0.0885,  ..., 0.9976, 0.9972, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 2926
正样本数量： 1861
TP:  1262
TN:  2837
FP:  89
FN:  599
batch idx: 4, loss: 0.339983 auc: 0.8994, acc: 0.8563, precision: 0.9341, recall: 0.6781, f1: 0.7858, time: 0.061s
First attempt - auc_train: 0.8965141577 acc_train: 0.8545900491
y_pred: tensor([0.1273, 0.0892, 0.0831,  ..., 0.9956, 0.9966, 0.9957])
负样本数量： 14024
正样本数量： 9563
TP:  6557
TN:  13694
FP:  330
FN:  3006
y_pred: tensor([0.8735, 0.9036, 0.9237,  ..., 0.9920, 0.9952, 0.9962])
负样本数量： 9817
正样本数量： 6593
TP:  4557
TN:  9588
FP:  229
FN:  2036
First attempt - auc_val: 0.9030800167 acc_val: 0.8585661593
Epoch: 0021 loss_train: 0.3383928537 auc_train: 0.8988604499 acc_train: 0.8563061684 precision_train: 0.9467478815 recall_train: 0.6602596321 f1_train: 0.7778672780 loss_val: 0.3342857212 auc_val: 0.9013928021 acc_val: 0.8602702826 precision_val: 0.9521178731 recall_val: 0.6884255590 f1_val: 0.7990763821 time: 0.5335s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0021: val_loss 改善从 0.334286 到 0.334286
y_pred: tensor([0.1856, 0.1416, 0.1256,  ..., 0.9935, 0.9906, 0.9958],
       grad_fn=<IndexBackward0>)
负样本数量： 13903
正样本数量： 9108
TP:  6023
TN:  13581
FP:  322
FN:  3085
batch idx: 0, loss: 0.343610 auc: 0.8979, acc: 0.8519, precision: 0.9493, recall: 0.6613, f1: 0.7795, time: 0.090s
y_pred: tensor([0.2186, 0.1515, 0.1383,  ..., 0.9960, 0.9959, 0.9971],
       grad_fn=<IndexBackward0>)
负样本数量： 14396
正样本数量： 8436
TP:  5545
TN:  14094
FP:  302
FN:  2891
batch idx: 1, loss: 0.329814 auc: 0.9025, acc: 0.8602, precision: 0.9483, recall: 0.6573, f1: 0.7764, time: 0.090s
y_pred: tensor([0.1300, 0.0828, 0.0799,  ..., 0.9918, 0.9912, 0.9919],
       grad_fn=<IndexBackward0>)
负样本数量： 14632
正样本数量： 8209
TP:  5319
TN:  14350
FP:  282
FN:  2890
batch idx: 2, loss: 0.333734 auc: 0.8966, acc: 0.8611, precision: 0.9497, recall: 0.6479, f1: 0.7703, time: 0.088s
y_pred: tensor([0.2065, 0.1486, 0.1365,  ..., 0.2832, 0.2805, 0.2909],
       grad_fn=<IndexBackward0>)
负样本数量： 13877
正样本数量： 9328
TP:  6187
TN:  13568
FP:  309
FN:  3141
batch idx: 3, loss: 0.342733 auc: 0.9003, acc: 0.8513, precision: 0.9524, recall: 0.6633, f1: 0.7820, time: 0.091s
y_pred: tensor([0.1217, 0.0870, 0.0825,  ..., 0.9976, 0.9951, 0.9973],
       grad_fn=<IndexBackward0>)
负样本数量： 3179
正样本数量： 1711
TP:  1122
TN:  3110
FP:  69
FN:  589
batch idx: 4, loss: 0.339301 auc: 0.8886, acc: 0.8654, precision: 0.9421, recall: 0.6558, f1: 0.7733, time: 0.062s
First attempt - auc_train: 0.8979458846 acc_train: 0.8519403763
y_pred: tensor([0.8398, 0.7975, 0.1576,  ..., 0.9950, 0.9962, 0.9919])
负样本数量： 13956
正样本数量： 9784
TP:  6892
TN:  13601
FP:  355
FN:  2892
y_pred: tensor([0.1995, 0.1422, 0.1329,  ..., 0.3208, 0.3084, 0.3006])
负样本数量： 9885
正样本数量： 6372
TP:  4354
TN:  9642
FP:  243
FN:  2018
First attempt - auc_val: 0.9050839565 acc_val: 0.8632266217
Epoch: 0022 loss_train: 0.3378383160 auc_train: 0.8971884342 acc_train: 0.8579969066 precision_train: 0.9483501130 recall_train: 0.6571129863 f1_train: 0.7763040940 loss_val: 0.3344621360 auc_val: 0.9009154737 acc_val: 0.8620740355 precision_val: 0.9490768258 recall_val: 0.6938586590 f1_val: 0.8016106520 time: 0.5409s
Epoch 0022: val_loss 没有改善 0.334462，最佳值 0.334286，等待 1/15
y_pred: tensor([0.2105, 0.1549, 0.1299,  ..., 0.9961, 0.9973, 0.9960],
       grad_fn=<IndexBackward0>)
负样本数量： 14595
正样本数量： 8669
TP:  5774
TN:  14234
FP:  361
FN:  2895
batch idx: 0, loss: 0.334336 auc: 0.9012, acc: 0.8600, precision: 0.9412, recall: 0.6661, f1: 0.7801, time: 0.090s
y_pred: tensor([0.1185, 0.0852, 0.0729,  ..., 0.2730, 0.2732, 0.9731],
       grad_fn=<IndexBackward0>)
负样本数量： 14153
正样本数量： 9129
TP:  6034
TN:  13843
FP:  310
FN:  3095
batch idx: 1, loss: 0.342374 auc: 0.8967, acc: 0.8537, precision: 0.9511, recall: 0.6610, f1: 0.7799, time: 0.089s
y_pred: tensor([0.1890, 0.3168, 0.1273,  ..., 0.9900, 0.9953, 0.9941],
       grad_fn=<IndexBackward0>)
负样本数量： 14092
正样本数量： 8843
TP:  5908
TN:  13773
FP:  319
FN:  2935
batch idx: 2, loss: 0.337854 auc: 0.8989, acc: 0.8581, precision: 0.9488, recall: 0.6681, f1: 0.7841, time: 0.083s
y_pred: tensor([0.1693, 0.1090, 0.0945,  ..., 0.1035, 0.1072, 0.0997],
       grad_fn=<IndexBackward0>)
负样本数量： 14215
正样本数量： 8339
TP:  5542
TN:  13905
FP:  310
FN:  2797
batch idx: 3, loss: 0.330402 auc: 0.9015, acc: 0.8622, precision: 0.9470, recall: 0.6646, f1: 0.7811, time: 0.086s
y_pred: tensor([0.1905, 0.1285, 0.3754,  ..., 0.9976, 0.9959, 0.9971],
       grad_fn=<IndexBackward0>)
负样本数量： 2932
正样本数量： 1812
TP:  1161
TN:  2861
FP:  71
FN:  651
batch idx: 4, loss: 0.354174 auc: 0.8923, acc: 0.8478, precision: 0.9424, recall: 0.6407, f1: 0.7628, time: 0.061s
First attempt - auc_train: 0.9012202818 acc_train: 0.8600412655
y_pred: tensor([0.1982, 0.1419, 0.1328,  ..., 0.9947, 0.9969, 0.9961])
负样本数量： 13715
正样本数量： 9643
TP:  6717
TN:  13367
FP:  348
FN:  2926
y_pred: tensor([0.1982, 0.1419, 0.1328,  ..., 0.9964, 0.9965, 0.9972])
负样本数量： 10126
正样本数量： 6513
TP:  4437
TN:  9899
FP:  227
FN:  2076
First attempt - auc_val: 0.9041802370 acc_val: 0.8598338899
Epoch: 0023 loss_train: 0.3398278654 auc_train: 0.8981297814 acc_train: 0.8563922415 precision_train: 0.9460920983 recall_train: 0.6600875199 f1_train: 0.7775887038 loss_val: 0.3335108608 auc_val: 0.9014180007 acc_val: 0.8607120648 precision_val: 0.9510362154 recall_val: 0.6889101686 f1_val: 0.7989989157 time: 0.5328s
Best model so far, saving...
Epoch 0023: val_loss 没有改善 0.333511，最佳值 0.334286，等待 2/15
y_pred: tensor([0.8471, 0.2618, 0.1901,  ..., 0.9955, 0.9955, 0.9977],
       grad_fn=<IndexBackward0>)
负样本数量： 14577
正样本数量： 8633
TP:  5798
TN:  14258
FP:  319
FN:  2835
batch idx: 0, loss: 0.328281 auc: 0.9022, acc: 0.8641, precision: 0.9479, recall: 0.6716, f1: 0.7862, time: 0.087s
y_pred: tensor([0.7799, 0.7268, 0.1166,  ..., 0.9972, 0.9977, 0.9975],
       grad_fn=<IndexBackward0>)
负样本数量： 14179
正样本数量： 8876
TP:  5822
TN:  13842
FP:  337
FN:  3054
batch idx: 1, loss: 0.341958 auc: 0.8972, acc: 0.8529, precision: 0.9453, recall: 0.6559, f1: 0.7745, time: 0.084s
y_pred: tensor([0.8467, 0.8016, 0.1578,  ..., 0.3113, 0.2884, 0.2850],
       grad_fn=<IndexBackward0>)
负样本数量： 13408
正样本数量： 9032
TP:  6022
TN:  13124
FP:  284
FN:  3010
batch idx: 2, loss: 0.338329 auc: 0.9033, acc: 0.8532, precision: 0.9550, recall: 0.6667, f1: 0.7852, time: 0.090s
y_pred: tensor([0.2313, 0.4230, 0.3811,  ..., 0.9955, 0.9958, 0.9963],
       grad_fn=<IndexBackward0>)
负样本数量： 14881
正样本数量： 8285
TP:  5394
TN:  14569
FP:  312
FN:  2891
batch idx: 3, loss: 0.338706 auc: 0.8933, acc: 0.8617, precision: 0.9453, recall: 0.6511, f1: 0.7711, time: 0.090s
y_pred: tensor([0.1363, 0.0867, 0.0837,  ..., 0.9979, 0.9971, 0.9939],
       grad_fn=<IndexBackward0>)
负样本数量： 2942
正样本数量： 1966
TP:  1328
TN:  2866
FP:  76
FN:  638
batch idx: 4, loss: 0.341597 auc: 0.8978, acc: 0.8545, precision: 0.9459, recall: 0.6755, f1: 0.7881, time: 0.062s
First attempt - auc_train: 0.9022386470 acc_train: 0.8641102973
y_pred: tensor([0.1270, 0.0908, 0.0852,  ..., 0.2873, 0.2871, 0.2864])
负样本数量： 14174
正样本数量： 9062
TP:  6246
TN:  13815
FP:  359
FN:  2816
y_pred: tensor([0.1443, 0.1175, 0.1138,  ..., 0.1754, 0.1725, 0.1704])
负样本数量： 9667
正样本数量： 7094
TP:  4985
TN:  9425
FP:  242
FN:  2109
First attempt - auc_val: 0.9019833915 acc_val: 0.8633585815
Epoch: 0024 loss_train: 0.3377742052 auc_train: 0.8987738915 acc_train: 0.8572992094 precision_train: 0.9478573533 recall_train: 0.6641629707 f1_train: 0.7810132078 loss_val: 0.3339483440 auc_val: 0.9019367902 acc_val: 0.8615462438 precision_val: 0.9496745846 recall_val: 0.6959791667 f1_val: 0.8032661516 time: 0.5364s
Epoch 0024: val_loss 没有改善 0.333948，最佳值 0.334286，等待 3/15
y_pred: tensor([0.7843, 0.2103, 0.1332,  ..., 0.9958, 0.9962, 0.9947],
       grad_fn=<IndexBackward0>)
负样本数量： 14920
正样本数量： 8167
TP:  5279
TN:  14594
FP:  326
FN:  2888
batch idx: 0, loss: 0.335526 auc: 0.8955, acc: 0.8608, precision: 0.9418, recall: 0.6464, f1: 0.7666, time: 0.084s
y_pred: tensor([0.1951, 0.1552, 0.1358,  ..., 0.0585, 0.0513, 0.0563],
       grad_fn=<IndexBackward0>)
负样本数量： 13946
正样本数量： 8617
TP:  5688
TN:  13660
FP:  286
FN:  2929
batch idx: 1, loss: 0.336577 auc: 0.8995, acc: 0.8575, precision: 0.9521, recall: 0.6601, f1: 0.7797, time: 0.089s
y_pred: tensor([0.8894, 0.8746, 0.1596,  ..., 0.9960, 0.9939, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 14344
正样本数量： 8591
TP:  5522
TN:  14085
FP:  259
FN:  3069
batch idx: 2, loss: 0.339367 auc: 0.8947, acc: 0.8549, precision: 0.9552, recall: 0.6428, f1: 0.7684, time: 0.086s
y_pred: tensor([0.2420, 0.1386, 0.1343,  ..., 0.9964, 0.9958, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 13822
正样本数量： 9473
TP:  6319
TN:  13522
FP:  300
FN:  3154
batch idx: 3, loss: 0.336637 auc: 0.9061, acc: 0.8517, precision: 0.9547, recall: 0.6671, f1: 0.7854, time: 0.087s
y_pred: tensor([0.1133, 0.2903, 0.1528,  ..., 0.9966, 0.9944, 0.9960],
       grad_fn=<IndexBackward0>)
负样本数量： 2955
正样本数量： 1944
TP:  1344
TN:  2887
FP:  68
FN:  600
batch idx: 4, loss: 0.329287 auc: 0.9049, acc: 0.8636, precision: 0.9518, recall: 0.6914, f1: 0.8010, time: 0.063s
First attempt - auc_train: 0.8954922068 acc_train: 0.8607874561
y_pred: tensor([0.1377, 0.1136, 0.4125,  ..., 0.2633, 0.2334, 0.2211])
负样本数量： 13740
正样本数量： 9719
TP:  6910
TN:  13370
FP:  370
FN:  2809
y_pred: tensor([0.1984, 0.1445, 0.1362,  ..., 0.9963, 0.9971, 0.9975])
负样本数量： 10101
正样本数量： 6437
TP:  4412
TN:  9821
FP:  280
FN:  2025
First attempt - auc_val: 0.9044357471 acc_val: 0.8644869773
Epoch: 0025 loss_train: 0.3354789317 auc_train: 0.9001253655 acc_train: 0.8577130572 precision_train: 0.9511357758 recall_train: 0.6615299481 f1_train: 0.7802075932 loss_val: 0.3340256065 auc_val: 0.9016260738 acc_val: 0.8625554973 precision_val: 0.9447498899 recall_val: 0.6981954775 f1_val: 0.8029362285 time: 0.5330s
Epoch 0025: val_loss 没有改善 0.334026，最佳值 0.334286，等待 4/15
y_pred: tensor([0.1423, 0.1202, 0.1087,  ..., 0.9932, 0.9971, 0.9963],
       grad_fn=<IndexBackward0>)
负样本数量： 13795
正样本数量： 9032
TP:  6173
TN:  13445
FP:  350
FN:  2859
batch idx: 0, loss: 0.334526 auc: 0.9031, acc: 0.8594, precision: 0.9463, recall: 0.6835, f1: 0.7937, time: 0.086s
y_pred: tensor([0.1968, 0.1530, 0.1298,  ..., 0.1899, 0.1876, 0.1831],
       grad_fn=<IndexBackward0>)
负样本数量： 14411
正样本数量： 8741
TP:  5778
TN:  14039
FP:  372
FN:  2963
batch idx: 1, loss: 0.341977 auc: 0.8950, acc: 0.8560, precision: 0.9395, recall: 0.6610, f1: 0.7760, time: 0.088s
y_pred: tensor([0.1973, 0.2900, 0.1172,  ..., 0.2726, 0.2748, 0.9519],
       grad_fn=<IndexBackward0>)
负样本数量： 14927
正样本数量： 7916
TP:  5049
TN:  14643
FP:  284
FN:  2867
batch idx: 2, loss: 0.336488 auc: 0.8924, acc: 0.8621, precision: 0.9467, recall: 0.6378, f1: 0.7622, time: 0.090s
y_pred: tensor([0.0970, 0.2880, 0.3830,  ..., 0.1664, 0.1635, 0.1149],
       grad_fn=<IndexBackward0>)
负样本数量： 13858
正样本数量： 9224
TP:  6212
TN:  13561
FP:  297
FN:  3012
batch idx: 3, loss: 0.331779 auc: 0.9050, acc: 0.8566, precision: 0.9544, recall: 0.6735, f1: 0.7897, time: 0.092s
y_pred: tensor([0.1154, 0.0884, 0.0773,  ..., 0.9965, 0.9965, 0.9964],
       grad_fn=<IndexBackward0>)
负样本数量： 2996
正样本数量： 1879
TP:  1222
TN:  2940
FP:  56
FN:  657
batch idx: 4, loss: 0.334175 auc: 0.9052, acc: 0.8537, precision: 0.9562, recall: 0.6503, f1: 0.7742, time: 0.063s
First attempt - auc_train: 0.9031224448 acc_train: 0.8594208613
y_pred: tensor([0.7746, 0.1584, 0.1263,  ..., 0.9947, 0.9966, 0.9959])
负样本数量： 13840
正样本数量： 9661
TP:  6701
TN:  13509
FP:  331
FN:  2960
y_pred: tensor([0.1365, 0.1115, 0.1072,  ..., 0.9955, 0.9931, 0.9970])
负样本数量： 10001
正样本数量： 6495
TP:  4511
TN:  9759
FP:  242
FN:  1984
First attempt - auc_val: 0.9010629375 acc_val: 0.8599634058
Epoch: 0026 loss_train: 0.3357889295 auc_train: 0.9001394250 acc_train: 0.8575632716 precision_train: 0.9486309957 recall_train: 0.6612220356 f1_train: 0.7791480294 loss_val: 0.3316748738 auc_val: 0.9026713741 acc_val: 0.8625108009 precision_val: 0.9510071269 recall_val: 0.6940738773 f1_val: 0.8024748227 time: 0.5447s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0026: val_loss 改善从 0.331675 到 0.331675
y_pred: tensor([0.0785, 0.0636, 0.0630,  ..., 0.9961, 0.9960, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 14042
正样本数量： 8845
TP:  5905
TN:  13701
FP:  341
FN:  2940
batch idx: 0, loss: 0.340704 auc: 0.8979, acc: 0.8566, precision: 0.9454, recall: 0.6676, f1: 0.7826, time: 0.084s
y_pred: tensor([0.1652, 0.1395, 0.3520,  ..., 0.9944, 0.9945, 0.9920],
       grad_fn=<IndexBackward0>)
负样本数量： 14247
正样本数量： 8812
TP:  6024
TN:  13864
FP:  383
FN:  2788
batch idx: 1, loss: 0.331446 auc: 0.9029, acc: 0.8625, precision: 0.9402, recall: 0.6836, f1: 0.7916, time: 0.087s
y_pred: tensor([0.1978, 0.1488, 0.3944,  ..., 0.0553, 0.0541, 0.0569],
       grad_fn=<IndexBackward0>)
负样本数量： 14692
正样本数量： 8646
TP:  5816
TN:  14256
FP:  436
FN:  2830
batch idx: 2, loss: 0.338770 auc: 0.8960, acc: 0.8601, precision: 0.9303, recall: 0.6727, f1: 0.7808, time: 0.086s
y_pred: tensor([0.7375, 0.1395, 0.3022,  ..., 0.2401, 0.2485, 0.2524],
       grad_fn=<IndexBackward0>)
负样本数量： 14190
正样本数量： 8766
TP:  5927
TN:  13830
FP:  360
FN:  2839
batch idx: 3, loss: 0.335155 auc: 0.8990, acc: 0.8606, precision: 0.9427, recall: 0.6761, f1: 0.7875, time: 0.085s
y_pred: tensor([0.6448, 0.1036, 0.0693,  ..., 0.0978, 0.0886, 0.0892],
       grad_fn=<IndexBackward0>)
负样本数量： 2816
正样本数量： 1723
TP:  1164
TN:  2761
FP:  55
FN:  559
batch idx: 4, loss: 0.318319 auc: 0.9102, acc: 0.8647, precision: 0.9549, recall: 0.6756, f1: 0.7913, time: 0.061s
First attempt - auc_train: 0.8978816196 acc_train: 0.8566435094
y_pred: tensor([0.1986, 0.1428, 0.3454,  ..., 0.9959, 0.9955, 0.9930])
负样本数量： 14207
正样本数量： 9534
TP:  6448
TN:  13950
FP:  257
FN:  3086
y_pred: tensor([0.1176, 0.0836, 0.0780,  ..., 0.9952, 0.9955, 0.9955])
负样本数量： 9634
正样本数量： 6622
TP:  4514
TN:  9438
FP:  196
FN:  2108
First attempt - auc_val: 0.9001429300 acc_val: 0.8591887452
Epoch: 0027 loss_train: 0.3328788936 auc_train: 0.9011847909 acc_train: 0.8609115265 precision_train: 0.9427018086 recall_train: 0.6751208045 f1_train: 0.7867572551 loss_val: 0.3324628323 auc_val: 0.9030299596 acc_val: 0.8587282309 precision_val: 0.9600284036 recall_val: 0.6789917558 f1_val: 0.7954097663 time: 0.5256s
Epoch 0027: val_loss 没有改善 0.332463，最佳值 0.331675，等待 1/15
y_pred: tensor([0.2138, 0.1494, 0.1321,  ..., 0.9948, 0.9962, 0.9956],
       grad_fn=<IndexBackward0>)
负样本数量： 14025
正样本数量： 9141
TP:  6097
TN:  13738
FP:  287
FN:  3044
batch idx: 0, loss: 0.331525 auc: 0.9061, acc: 0.8562, precision: 0.9550, recall: 0.6670, f1: 0.7854, time: 0.086s
y_pred: tensor([0.7772, 0.1562, 0.1203,  ..., 0.9266, 0.9766, 0.9879],
       grad_fn=<IndexBackward0>)
负样本数量： 14065
正样本数量： 9077
TP:  5942
TN:  13784
FP:  281
FN:  3135
batch idx: 1, loss: 0.339578 auc: 0.8994, acc: 0.8524, precision: 0.9548, recall: 0.6546, f1: 0.7767, time: 0.085s
y_pred: tensor([0.1119, 0.0874, 0.0772,  ..., 0.0958, 0.0943, 0.6045],
       grad_fn=<IndexBackward0>)
负样本数量： 14790
正样本数量： 8105
TP:  5263
TN:  14496
FP:  294
FN:  2842
batch idx: 2, loss: 0.334715 auc: 0.8945, acc: 0.8630, precision: 0.9471, recall: 0.6494, f1: 0.7705, time: 0.083s
y_pred: tensor([0.2628, 0.3361, 0.1917,  ..., 0.9975, 0.9978, 0.9972],
       grad_fn=<IndexBackward0>)
负样本数量： 14334
正样本数量： 8617
TP:  5806
TN:  13948
FP:  386
FN:  2811
batch idx: 3, loss: 0.335744 auc: 0.8988, acc: 0.8607, precision: 0.9377, recall: 0.6738, f1: 0.7841, time: 0.090s
y_pred: tensor([0.1241, 0.0910, 0.2318,  ..., 0.9949, 0.9962, 0.9961],
       grad_fn=<IndexBackward0>)
负样本数量： 2773
正样本数量： 1852
TP:  1298
TN:  2700
FP:  73
FN:  554
batch idx: 4, loss: 0.331394 auc: 0.9039, acc: 0.8644, precision: 0.9468, recall: 0.7009, f1: 0.8055, time: 0.064s
First attempt - auc_train: 0.9060617449 acc_train: 0.8562116895
y_pred: tensor([0.1993, 0.4303, 0.2316,  ..., 0.9963, 0.9920, 0.9956])
负样本数量： 14089
正样本数量： 9481
TP:  6690
TN:  13695
FP:  394
FN:  2791
y_pred: tensor([0.1181, 0.0854, 0.0799,  ..., 0.9962, 0.9961, 0.9941])
负样本数量： 9752
正样本数量： 6675
TP:  4678
TN:  9499
FP:  253
FN:  1997
First attempt - auc_val: 0.9039555964 acc_val: 0.8648705982
Epoch: 0028 loss_train: 0.3345911860 auc_train: 0.9005370003 acc_train: 0.8593527631 precision_train: 0.9482796476 recall_train: 0.6691233983 f1_train: 0.7844423165 loss_val: 0.3327454627 auc_val: 0.9023628417 acc_val: 0.8639504875 precision_val: 0.9465368271 recall_val: 0.7032228699 f1_val: 0.8069309467 time: 0.5345s
Epoch 0028: val_loss 没有改善 0.332745，最佳值 0.331675，等待 2/15
y_pred: tensor([0.2297, 0.4304, 0.3830,  ..., 0.9974, 0.9963, 0.9979],
       grad_fn=<IndexBackward0>)
负样本数量： 14712
正样本数量： 8569
TP:  5710
TN:  14359
FP:  353
FN:  2859
batch idx: 0, loss: 0.336915 auc: 0.8958, acc: 0.8620, precision: 0.9418, recall: 0.6664, f1: 0.7805, time: 0.087s
y_pred: tensor([0.1190, 0.0811, 0.0799,  ..., 0.9964, 0.9970, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 14665
正样本数量： 8784
TP:  5847
TN:  14337
FP:  328
FN:  2937
batch idx: 1, loss: 0.329164 auc: 0.9036, acc: 0.8608, precision: 0.9469, recall: 0.6656, f1: 0.7817, time: 0.088s
y_pred: tensor([0.8342, 0.7754, 0.1386,  ..., 0.0887, 0.5312, 0.6464],
       grad_fn=<IndexBackward0>)
负样本数量： 14055
正样本数量： 8752
TP:  5826
TN:  13760
FP:  295
FN:  2926
batch idx: 2, loss: 0.329070 auc: 0.9051, acc: 0.8588, precision: 0.9518, recall: 0.6657, f1: 0.7834, time: 0.086s
y_pred: tensor([0.8371, 0.7741, 0.1426,  ..., 0.9941, 0.9971, 0.9970],
       grad_fn=<IndexBackward0>)
负样本数量： 13673
正样本数量： 8939
TP:  5864
TN:  13411
FP:  262
FN:  3075
batch idx: 3, loss: 0.341994 auc: 0.8970, acc: 0.8524, precision: 0.9572, recall: 0.6560, f1: 0.7785, time: 0.090s
y_pred: tensor([0.2165, 0.1310, 0.1408,  ..., 0.4197, 0.4514, 0.2398],
       grad_fn=<IndexBackward0>)
负样本数量： 2882
正样本数量： 1748
TP:  1146
TN:  2809
FP:  73
FN:  602
batch idx: 4, loss: 0.344550 auc: 0.8936, acc: 0.8542, precision: 0.9401, recall: 0.6556, f1: 0.7725, time: 0.062s
First attempt - auc_train: 0.8957569415 acc_train: 0.8620334178
y_pred: tensor([0.8690, 0.7983, 0.9133,  ..., 0.0951, 0.0950, 0.0949])
负样本数量： 14126
正样本数量： 9791
TP:  6816
TN:  13813
FP:  313
FN:  2975
y_pred: tensor([0.2053, 0.0975, 0.0860,  ..., 0.2765, 0.9647, 0.9919])
负样本数量： 9715
正样本数量： 6365
TP:  4341
TN:  9471
FP:  244
FN:  2024
First attempt - auc_val: 0.9020516874 acc_val: 0.8625245641
Epoch: 0029 loss_train: 0.3363385558 auc_train: 0.8990289268 acc_train: 0.8576403311 precision_train: 0.9475624340 recall_train: 0.6618564316 f1_train: 0.7793283239 loss_val: 0.3318435997 auc_val: 0.9030755041 acc_val: 0.8607398940 precision_val: 0.9514389060 recall_val: 0.6890802614 f1_val: 0.7992752356 time: 0.5371s
Epoch 0029: val_loss 没有改善 0.331844，最佳值 0.331675，等待 3/15
y_pred: tensor([0.1451, 0.3106, 0.3510,  ..., 0.2900, 0.3112, 0.3473],
       grad_fn=<IndexBackward0>)
负样本数量： 14475
正样本数量： 8709
TP:  5754
TN:  14178
FP:  297
FN:  2955
batch idx: 0, loss: 0.332740 auc: 0.9006, acc: 0.8597, precision: 0.9509, recall: 0.6607, f1: 0.7797, time: 0.089s
y_pred: tensor([0.1517, 0.1224, 0.1082,  ..., 0.9960, 0.9961, 0.9934],
       grad_fn=<IndexBackward0>)
负样本数量： 14253
正样本数量： 8546
TP:  5683
TN:  13947
FP:  306
FN:  2863
batch idx: 1, loss: 0.331710 auc: 0.9008, acc: 0.8610, precision: 0.9489, recall: 0.6650, f1: 0.7820, time: 0.088s
y_pred: tensor([0.1249, 0.0913, 0.0797,  ..., 0.9968, 0.9972, 0.9978],
       grad_fn=<IndexBackward0>)
负样本数量： 13802
正样本数量： 9025
TP:  6057
TN:  13490
FP:  312
FN:  2968
batch idx: 2, loss: 0.338170 auc: 0.9002, acc: 0.8563, precision: 0.9510, recall: 0.6711, f1: 0.7869, time: 0.086s
y_pred: tensor([0.7363, 0.1233, 0.0963,  ..., 0.9974, 0.9977, 0.9974],
       grad_fn=<IndexBackward0>)
负样本数量： 14374
正样本数量： 8669
TP:  5738
TN:  14055
FP:  319
FN:  2931
batch idx: 3, loss: 0.332162 auc: 0.9016, acc: 0.8590, precision: 0.9473, recall: 0.6619, f1: 0.7793, time: 0.084s
y_pred: tensor([0.1278, 0.0909, 0.0849,  ..., 0.9970, 0.9932, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 3083
正样本数量： 1843
TP:  1226
TN:  3022
FP:  61
FN:  617
batch idx: 4, loss: 0.338366 auc: 0.8930, acc: 0.8624, precision: 0.9526, recall: 0.6652, f1: 0.7834, time: 0.060s
First attempt - auc_train: 0.9006024855 acc_train: 0.8597308489
y_pred: tensor([0.8692, 0.8981, 0.9185,  ..., 0.8444, 0.8525, 0.9119])
负样本数量： 13908
正样本数量： 9414
TP:  6458
TN:  13578
FP:  330
FN:  2956
y_pred: tensor([0.2072, 0.1504, 0.1406,  ..., 0.1007, 0.0999, 0.0992])
负样本数量： 9933
正样本数量： 6742
TP:  4696
TN:  9715
FP:  218
FN:  2046
First attempt - auc_val: 0.9023897648 acc_val: 0.8591029929
Epoch: 0030 loss_train: 0.3346296668 auc_train: 0.8992240770 acc_train: 0.8596732686 precision_train: 0.9501545732 recall_train: 0.6647879009 f1_train: 0.7822535620 loss_val: 0.3309725523 auc_val: 0.9031387921 acc_val: 0.8616654395 precision_val: 0.9535108762 recall_val: 0.6912643975 f1_val: 0.8014754019 time: 0.5273s
Best model so far, saving...
Epoch 0030: val_loss 没有改善 0.330973，最佳值 0.331675，等待 4/15
y_pred: tensor([0.1868, 0.3966, 0.2427,  ..., 0.1088, 0.7761, 0.7087],
       grad_fn=<IndexBackward0>)
负样本数量： 14147
正样本数量： 8807
TP:  5781
TN:  13844
FP:  303
FN:  3026
batch idx: 0, loss: 0.341924 auc: 0.8952, acc: 0.8550, precision: 0.9502, recall: 0.6564, f1: 0.7764, time: 0.086s
y_pred: tensor([0.2308, 0.4333, 0.3647,  ..., 0.1094, 0.1011, 0.5598],
       grad_fn=<IndexBackward0>)
负样本数量： 14649
正样本数量： 8463
TP:  5577
TN:  14335
FP:  314
FN:  2886
batch idx: 1, loss: 0.328712 auc: 0.9016, acc: 0.8615, precision: 0.9467, recall: 0.6590, f1: 0.7771, time: 0.089s
y_pred: tensor([0.8396, 0.8407, 0.8195,  ..., 0.9970, 0.8044, 0.8411],
       grad_fn=<IndexBackward0>)
负样本数量： 13996
正样本数量： 9104
TP:  6121
TN:  13719
FP:  277
FN:  2983
batch idx: 2, loss: 0.332185 auc: 0.9033, acc: 0.8589, precision: 0.9567, recall: 0.6723, f1: 0.7897, time: 0.088s
y_pred: tensor([0.1342, 0.0819, 0.0752,  ..., 0.9948, 0.9952, 0.9926],
       grad_fn=<IndexBackward0>)
负样本数量： 14370
正样本数量： 8707
TP:  5760
TN:  14076
FP:  294
FN:  2947
batch idx: 3, loss: 0.329503 auc: 0.9045, acc: 0.8596, precision: 0.9514, recall: 0.6615, f1: 0.7804, time: 0.085s
y_pred: tensor([0.1994, 0.1405, 0.1452,  ..., 0.9966, 0.9973, 0.9975],
       grad_fn=<IndexBackward0>)
负样本数量： 2825
正样本数量： 1711
TP:  1096
TN:  2762
FP:  63
FN:  615
batch idx: 4, loss: 0.354185 auc: 0.8847, acc: 0.8505, precision: 0.9456, recall: 0.6406, f1: 0.7638, time: 0.062s
First attempt - auc_train: 0.8952048199 acc_train: 0.8549708112
y_pred: tensor([0.7145, 0.1246, 0.0893,  ..., 0.9976, 0.9965, 0.9940])
负样本数量： 14005
正样本数量： 9673
TP:  6718
TN:  13623
FP:  382
FN:  2955
y_pred: tensor([0.7299, 0.7594, 0.2020,  ..., 0.9955, 0.9963, 0.9974])
负样本数量： 9836
正样本数量： 6483
TP:  4510
TN:  9625
FP:  211
FN:  1973
First attempt - auc_val: 0.9034058777 acc_val: 0.8590674888
Epoch: 0031 loss_train: 0.3373017788 auc_train: 0.8978576920 acc_train: 0.8570950584 precision_train: 0.9501361349 recall_train: 0.6579670894 f1_train: 0.7774820646 loss_val: 0.3309843987 auc_val: 0.9029749513 acc_val: 0.8626178795 precision_val: 0.9507516312 recall_val: 0.6950880400 f1_val: 0.8030594617 time: 0.5338s
Epoch 0031: val_loss 没有改善 0.330984，最佳值 0.331675，等待 5/15
y_pred: tensor([0.7412, 0.6596, 0.1071,  ..., 0.2969, 0.2744, 0.2684],
       grad_fn=<IndexBackward0>)
负样本数量： 14211
正样本数量： 8722
TP:  5775
TN:  13886
FP:  325
FN:  2947
batch idx: 0, loss: 0.335364 auc: 0.9002, acc: 0.8573, precision: 0.9467, recall: 0.6621, f1: 0.7792, time: 0.084s
y_pred: tensor([0.2369, 0.1530, 0.1344,  ..., 0.9972, 0.9971, 0.9962],
       grad_fn=<IndexBackward0>)
负样本数量： 15036
正样本数量： 8383
TP:  5535
TN:  14685
FP:  351
FN:  2848
batch idx: 1, loss: 0.333502 auc: 0.8963, acc: 0.8634, precision: 0.9404, recall: 0.6603, f1: 0.7758, time: 0.089s
y_pred: tensor([0.2093, 0.4163, 0.2453,  ..., 0.9964, 0.9962, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 14232
正样本数量： 8760
TP:  5868
TN:  13918
FP:  314
FN:  2892
batch idx: 2, loss: 0.333022 auc: 0.9015, acc: 0.8606, precision: 0.9492, recall: 0.6699, f1: 0.7854, time: 0.085s
y_pred: tensor([0.0713, 0.0708, 0.0563,  ..., 0.9423, 0.9559, 0.9709],
       grad_fn=<IndexBackward0>)
负样本数量： 13451
正样本数量： 9216
TP:  6344
TN:  13148
FP:  303
FN:  2872
batch idx: 3, loss: 0.331013 auc: 0.9053, acc: 0.8599, precision: 0.9544, recall: 0.6884, f1: 0.7998, time: 0.088s
y_pred: tensor([0.1468, 0.1110, 0.1077,  ..., 0.9974, 0.9963, 0.9965],
       grad_fn=<IndexBackward0>)
负样本数量： 3057
正样本数量： 1711
TP:  1092
TN:  2991
FP:  66
FN:  619
batch idx: 4, loss: 0.339254 auc: 0.8931, acc: 0.8563, precision: 0.9430, recall: 0.6382, f1: 0.7612, time: 0.061s
First attempt - auc_train: 0.9002219247 acc_train: 0.8573235076
y_pred: tensor([0.0853, 0.0647, 0.0611,  ..., 0.3628, 0.3276, 0.5423])
负样本数量： 14096
正样本数量： 9244
TP:  6275
TN:  13756
FP:  340
FN:  2969
y_pred: tensor([0.1371, 0.1135, 0.1092,  ..., 0.1671, 0.1611, 0.1571])
负样本数量： 9745
正样本数量： 6912
TP:  4881
TN:  9545
FP:  200
FN:  2031
First attempt - auc_val: 0.8987544295 acc_val: 0.8582262211
Epoch: 0032 loss_train: 0.3344309211 auc_train: 0.8992863093 acc_train: 0.8595095274 precision_train: 0.9467432735 recall_train: 0.6637675865 f1_train: 0.7803162677 loss_val: 0.3294281811 auc_val: 0.9039250568 acc_val: 0.8621442686 precision_val: 0.9546196663 recall_val: 0.6924909438 f1_val: 0.8026617898 time: 0.5285s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0032: val_loss 改善从 0.329428 到 0.329428
y_pred: tensor([0.1964, 0.1565, 0.1474,  ..., 0.9940, 0.9970, 0.9965],
       grad_fn=<IndexBackward0>)
负样本数量： 14478
正样本数量： 8463
TP:  5578
TN:  14165
FP:  313
FN:  2885
batch idx: 0, loss: 0.332933 auc: 0.8993, acc: 0.8606, precision: 0.9469, recall: 0.6591, f1: 0.7772, time: 0.082s
y_pred: tensor([0.7827, 0.8166, 0.8400,  ..., 0.4735, 0.6189, 0.6702],
       grad_fn=<IndexBackward0>)
负样本数量： 14224
正样本数量： 8774
TP:  5880
TN:  13904
FP:  320
FN:  2894
batch idx: 1, loss: 0.330182 auc: 0.9037, acc: 0.8602, precision: 0.9484, recall: 0.6702, f1: 0.7854, time: 0.084s
y_pred: tensor([0.1195, 0.0800, 0.0799,  ..., 0.9937, 0.9965, 0.9953],
       grad_fn=<IndexBackward0>)
负样本数量： 14107
正样本数量： 8858
TP:  5937
TN:  13828
FP:  279
FN:  2921
batch idx: 2, loss: 0.334017 auc: 0.8992, acc: 0.8607, precision: 0.9551, recall: 0.6702, f1: 0.7877, time: 0.084s
y_pred: tensor([0.8794, 0.7675, 0.9605,  ..., 0.9970, 0.9974, 0.9965],
       grad_fn=<IndexBackward0>)
负样本数量： 13967
正样本数量： 9026
TP:  6064
TN:  13604
FP:  363
FN:  2962
batch idx: 3, loss: 0.338153 auc: 0.9005, acc: 0.8554, precision: 0.9435, recall: 0.6718, f1: 0.7848, time: 0.092s
y_pred: tensor([0.1196, 0.0903, 0.0815,  ..., 0.3108, 0.3099, 0.2809],
       grad_fn=<IndexBackward0>)
负样本数量： 3211
正样本数量： 1671
TP:  1081
TN:  3145
FP:  66
FN:  590
batch idx: 4, loss: 0.326500 auc: 0.8969, acc: 0.8656, precision: 0.9425, recall: 0.6469, f1: 0.7672, time: 0.064s
First attempt - auc_train: 0.8992512723 acc_train: 0.8605989277
y_pred: tensor([0.2014, 0.1479, 0.1386,  ..., 0.9979, 0.9977, 0.9963])
负样本数量： 14259
正样本数量： 9447
TP:  6526
TN:  13903
FP:  356
FN:  2921
y_pred: tensor([0.1175, 0.1029, 0.1029,  ..., 0.9963, 0.9968, 0.9974])
负样本数量： 9582
正样本数量： 6709
TP:  4722
TN:  9339
FP:  243
FN:  1987
First attempt - auc_val: 0.8998533482 acc_val: 0.8617649540
Epoch: 0033 loss_train: 0.3323570013 auc_train: 0.8999137576 acc_train: 0.8605049558 precision_train: 0.9472698291 recall_train: 0.6636525393 f1_train: 0.7804644820 loss_val: 0.3305904716 auc_val: 0.9039497718 acc_val: 0.8624397786 precision_val: 0.9496641267 recall_val: 0.6973159939 f1_val: 0.8041456590 time: 0.5289s
Epoch 0033: val_loss 没有改善 0.330590，最佳值 0.329428，等待 1/15
y_pred: tensor([0.1741, 0.1050, 0.0999,  ..., 0.8291, 0.8449, 0.8863],
       grad_fn=<IndexBackward0>)
负样本数量： 14403
正样本数量： 8746
TP:  5852
TN:  14064
FP:  339
FN:  2894
batch idx: 0, loss: 0.332390 auc: 0.9012, acc: 0.8603, precision: 0.9452, recall: 0.6691, f1: 0.7836, time: 0.088s
y_pred: tensor([0.1215, 0.4367, 0.4815,  ..., 0.9966, 0.9963, 0.9973],
       grad_fn=<IndexBackward0>)
负样本数量： 14269
正样本数量： 8517
TP:  5634
TN:  13985
FP:  284
FN:  2883
batch idx: 1, loss: 0.332520 auc: 0.8998, acc: 0.8610, precision: 0.9520, recall: 0.6615, f1: 0.7806, time: 0.090s
y_pred: tensor([0.0954, 0.0791, 0.0841,  ..., 0.2989, 0.3080, 0.3186],
       grad_fn=<IndexBackward0>)
负样本数量： 14130
正样本数量： 8844
TP:  6003
TN:  13838
FP:  292
FN:  2841
batch idx: 2, loss: 0.328451 auc: 0.9027, acc: 0.8636, precision: 0.9536, recall: 0.6788, f1: 0.7931, time: 0.088s
y_pred: tensor([0.7572, 0.1411, 0.1204,  ..., 0.9980, 0.9974, 0.9981],
       grad_fn=<IndexBackward0>)
负样本数量： 14129
正样本数量： 9021
TP:  5952
TN:  13820
FP:  309
FN:  3069
batch idx: 3, loss: 0.337322 auc: 0.9013, acc: 0.8541, precision: 0.9506, recall: 0.6598, f1: 0.7790, time: 0.087s
y_pred: tensor([0.1222, 0.0994, 0.1101,  ..., 0.2556, 0.4673, 0.3474],
       grad_fn=<IndexBackward0>)
负样本数量： 3056
正样本数量： 1664
TP:  1012
TN:  2998
FP:  58
FN:  652
batch idx: 4, loss: 0.343801 auc: 0.8913, acc: 0.8496, precision: 0.9458, recall: 0.6082, f1: 0.7403, time: 0.061s
First attempt - auc_train: 0.9011981379 acc_train: 0.8603395395
y_pred: tensor([0.1176, 0.0848, 0.0790,  ..., 0.9970, 0.9972, 0.9936])
负样本数量： 13599
正样本数量： 9754
TP:  6844
TN:  13274
FP:  325
FN:  2910
y_pred: tensor([0.2020, 0.1489, 0.2001,  ..., 0.9967, 0.9963, 0.9980])
负样本数量： 10242
正样本数量： 6402
TP:  4303
TN:  10032
FP:  210
FN:  2099
First attempt - auc_val: 0.9065210329 acc_val: 0.8614739006
Epoch: 0034 loss_train: 0.3348969281 auc_train: 0.8992567772 acc_train: 0.8577274962 precision_train: 0.9494618285 recall_train: 0.6554677123 f1_train: 0.7752948494 loss_val: 0.3311385214 auc_val: 0.9025359539 acc_val: 0.8613726148 precision_val: 0.9540668413 recall_val: 0.6868972827 f1_val: 0.7986481465 time: 0.5398s
Epoch 0034: val_loss 没有改善 0.331139，最佳值 0.329428，等待 2/15
y_pred: tensor([0.1261, 0.0856, 0.0788,  ..., 0.9954, 0.9958, 0.9959],
       grad_fn=<IndexBackward0>)
负样本数量： 14383
正样本数量： 8767
TP:  5826
TN:  14080
FP:  303
FN:  2941
batch idx: 0, loss: 0.333784 auc: 0.8995, acc: 0.8599, precision: 0.9506, recall: 0.6645, f1: 0.7822, time: 0.085s
y_pred: tensor([0.1952, 0.1540, 0.1366,  ..., 0.9967, 0.9965, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 13697
正样本数量： 9129
TP:  6219
TN:  13386
FP:  311
FN:  2910
batch idx: 1, loss: 0.333008 auc: 0.9047, acc: 0.8589, precision: 0.9524, recall: 0.6812, f1: 0.7943, time: 0.086s
y_pred: tensor([0.8109, 0.8391, 0.8501,  ..., 0.9938, 0.9943, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 14451
正样本数量： 8769
TP:  5877
TN:  14104
FP:  347
FN:  2892
batch idx: 2, loss: 0.336137 auc: 0.8980, acc: 0.8605, precision: 0.9442, recall: 0.6702, f1: 0.7840, time: 0.091s
y_pred: tensor([0.7142, 0.7784, 0.8203,  ..., 0.2861, 0.2849, 0.2767],
       grad_fn=<IndexBackward0>)
负样本数量： 14599
正样本数量： 8331
TP:  5532
TN:  14265
FP:  334
FN:  2799
batch idx: 3, loss: 0.327606 auc: 0.9013, acc: 0.8634, precision: 0.9431, recall: 0.6640, f1: 0.7793, time: 0.089s
y_pred: tensor([0.6392, 0.0892, 0.3391,  ..., 0.9974, 0.9977, 0.9969],
       grad_fn=<IndexBackward0>)
负样本数量： 2857
正样本数量： 1796
TP:  1197
TN:  2787
FP:  70
FN:  599
batch idx: 4, loss: 0.339767 auc: 0.8986, acc: 0.8562, precision: 0.9448, recall: 0.6665, f1: 0.7816, time: 0.061s
First attempt - auc_train: 0.8994851540 acc_train: 0.8598704104
y_pred: tensor([0.1573, 0.1065, 0.0971,  ..., 0.9954, 0.9975, 0.9969])
负样本数量： 13883
正样本数量： 9495
TP:  6568
TN:  13555
FP:  328
FN:  2927
y_pred: tensor([0.1573, 0.1065, 0.0971,  ..., 0.9967, 0.9954, 0.9979])
负样本数量： 9958
正样本数量： 6661
TP:  4609
TN:  9739
FP:  219
FN:  2052
First attempt - auc_val: 0.9029072308 acc_val: 0.8607665326
Epoch: 0035 loss_train: 0.3340602040 auc_train: 0.9004166887 acc_train: 0.8597712280 precision_train: 0.9469995445 recall_train: 0.6692963873 f1_train: 0.7842798232 loss_val: 0.3303781450 auc_val: 0.9035806378 acc_val: 0.8620578556 precision_val: 0.9535378986 recall_val: 0.6918353191 f1_val: 0.8018740385 time: 0.5330s
Epoch 0035: val_loss 没有改善 0.330378，最佳值 0.329428，等待 3/15
y_pred: tensor([0.7817, 0.8145, 0.8501,  ..., 0.9979, 0.9980, 0.9977],
       grad_fn=<IndexBackward0>)
负样本数量： 14123
正样本数量： 8944
TP:  5944
TN:  13811
FP:  312
FN:  3000
batch idx: 0, loss: 0.338156 auc: 0.8982, acc: 0.8564, precision: 0.9501, recall: 0.6646, f1: 0.7821, time: 0.087s
y_pred: tensor([0.2076, 0.1704, 0.2367,  ..., 0.1069, 0.6108, 0.3882],
       grad_fn=<IndexBackward0>)
负样本数量： 14361
正样本数量： 8429
TP:  5411
TN:  14065
FP:  296
FN:  3018
batch idx: 1, loss: 0.340133 auc: 0.8960, acc: 0.8546, precision: 0.9481, recall: 0.6420, f1: 0.7656, time: 0.090s
y_pred: tensor([0.1343, 0.1190, 0.1107,  ..., 0.9979, 0.9958, 0.9961],
       grad_fn=<IndexBackward0>)
负样本数量： 14014
正样本数量： 9010
TP:  6118
TN:  13736
FP:  278
FN:  2892
batch idx: 2, loss: 0.320040 auc: 0.9117, acc: 0.8623, precision: 0.9565, recall: 0.6790, f1: 0.7942, time: 0.089s
y_pred: tensor([0.1200, 0.0854, 0.0779,  ..., 0.3185, 0.3140, 0.9639],
       grad_fn=<IndexBackward0>)
负样本数量： 14623
正样本数量： 8550
TP:  5628
TN:  14314
FP:  309
FN:  2922
batch idx: 3, loss: 0.333616 auc: 0.8969, acc: 0.8606, precision: 0.9480, recall: 0.6582, f1: 0.7770, time: 0.089s
y_pred: tensor([0.1349, 0.1238, 0.1150,  ..., 0.9964, 0.9965, 0.9949],
       grad_fn=<IndexBackward0>)
负样本数量： 2866
正样本数量： 1859
TP:  1287
TN:  2787
FP:  79
FN:  572
batch idx: 4, loss: 0.331538 auc: 0.9056, acc: 0.8622, precision: 0.9422, recall: 0.6923, f1: 0.7981, time: 0.062s
First attempt - auc_train: 0.8982061449 acc_train: 0.8564182599
y_pred: tensor([0.1164, 0.2905, 0.1551,  ..., 0.9942, 0.9942, 0.9975])
负样本数量： 14154
正样本数量： 9410
TP:  6544
TN:  13836
FP:  318
FN:  2866
y_pred: tensor([0.2008, 0.1490, 0.1399,  ..., 0.9975, 0.9969, 0.9975])
负样本数量： 9687
正样本数量： 6746
TP:  4668
TN:  9444
FP:  243
FN:  2078
First attempt - auc_val: 0.9070882844 acc_val: 0.8648786284
Epoch: 0036 loss_train: 0.3326965392 auc_train: 0.9016866350 acc_train: 0.8592227799 precision_train: 0.9489835010 recall_train: 0.6672213259 f1_train: 0.7834032739 loss_val: 0.3314516544 auc_val: 0.9027579321 acc_val: 0.8618192205 precision_val: 0.9520885341 recall_val: 0.6936980012 f1_val: 0.8026093091 time: 0.5355s
Epoch 0036: val_loss 没有改善 0.331452，最佳值 0.329428，等待 4/15
y_pred: tensor([0.1242, 0.0871, 0.0863,  ..., 0.1938, 0.2717, 0.2525],
       grad_fn=<IndexBackward0>)
负样本数量： 14067
正样本数量： 8990
TP:  6052
TN:  13738
FP:  329
FN:  2938
batch idx: 0, loss: 0.332804 auc: 0.9032, acc: 0.8583, precision: 0.9484, recall: 0.6732, f1: 0.7875, time: 0.088s
y_pred: tensor([0.7553, 0.1456, 0.1277,  ..., 0.9966, 0.9975, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 14061
正样本数量： 8959
TP:  6022
TN:  13752
FP:  309
FN:  2937
batch idx: 1, loss: 0.334362 auc: 0.9014, acc: 0.8590, precision: 0.9512, recall: 0.6722, f1: 0.7877, time: 0.085s
y_pred: tensor([0.2230, 0.1566, 0.1487,  ..., 0.9955, 0.9980, 0.9970],
       grad_fn=<IndexBackward0>)
负样本数量： 14126
正样本数量： 8860
TP:  5931
TN:  13805
FP:  321
FN:  2929
batch idx: 2, loss: 0.332690 auc: 0.9019, acc: 0.8586, precision: 0.9487, recall: 0.6694, f1: 0.7849, time: 0.084s
y_pred: tensor([0.1329, 0.1122, 0.0930,  ..., 0.9973, 0.9977, 0.9969],
       grad_fn=<IndexBackward0>)
负样本数量： 14664
正样本数量： 8216
TP:  5436
TN:  14334
FP:  330
FN:  2780
batch idx: 3, loss: 0.330617 auc: 0.8975, acc: 0.8641, precision: 0.9428, recall: 0.6616, f1: 0.7776, time: 0.181s
y_pred: tensor([0.1071, 0.0835, 0.2233,  ..., 0.9932, 0.9958, 0.9972],
       grad_fn=<IndexBackward0>)
负样本数量： 3069
正样本数量： 1767
TP:  1152
TN:  3008
FP:  61
FN:  615
batch idx: 4, loss: 0.329447 auc: 0.9025, acc: 0.8602, precision: 0.9497, recall: 0.6520, f1: 0.7732, time: 0.075s
First attempt - auc_train: 0.9032351808 acc_train: 0.8583076723
y_pred: tensor([0.1161, 0.0841, 0.0784,  ..., 0.9964, 0.9965, 0.9968])
负样本数量： 14284
正样本数量： 9328
TP:  6414
TN:  13963
FP:  321
FN:  2914
y_pred: tensor([0.1161, 0.0841, 0.0784,  ..., 0.9967, 0.9961, 0.9965])
负样本数量： 9557
正样本数量： 6828
TP:  4763
TN:  9339
FP:  218
FN:  2065
First attempt - auc_val: 0.9029071439 acc_val: 0.8629933932
Epoch: 0037 loss_train: 0.3319840908 auc_train: 0.9012910126 acc_train: 0.8600395844 precision_train: 0.9481538134 recall_train: 0.6656734113 f1_train: 0.7821651856 loss_val: 0.3304325640 auc_val: 0.9037896434 acc_val: 0.8618293179 precision_val: 0.9542861090 recall_val: 0.6925880192 f1_val: 0.8026391837 time: 0.6482s
Epoch 0037: val_loss 没有改善 0.330433，最佳值 0.329428，等待 5/15
y_pred: tensor([0.1810, 0.2839, 0.1128,  ..., 0.9968, 0.9971, 0.9966],
       grad_fn=<IndexBackward0>)
负样本数量： 14437
正样本数量： 8602
TP:  5698
TN:  14113
FP:  324
FN:  2904
batch idx: 0, loss: 0.332527 auc: 0.8994, acc: 0.8599, precision: 0.9462, recall: 0.6624, f1: 0.7793, time: 0.105s
y_pred: tensor([0.1204, 0.0806, 0.0803,  ..., 0.1001, 0.6017, 0.7067],
       grad_fn=<IndexBackward0>)
负样本数量： 13455
正样本数量： 9378
TP:  6449
TN:  13163
FP:  292
FN:  2929
batch idx: 1, loss: 0.329964 auc: 0.9075, acc: 0.8589, precision: 0.9567, recall: 0.6877, f1: 0.8002, time: 0.100s
y_pred: tensor([0.1323, 0.0867, 0.0772,  ..., 0.9977, 0.9978, 0.9980],
       grad_fn=<IndexBackward0>)
负样本数量： 14425
正样本数量： 8738
TP:  5813
TN:  14061
FP:  364
FN:  2925
batch idx: 2, loss: 0.339800 auc: 0.8957, acc: 0.8580, precision: 0.9411, recall: 0.6653, f1: 0.7795, time: 0.100s
y_pred: tensor([0.1711, 0.1519, 0.1481,  ..., 0.9974, 0.9968, 0.9967],
       grad_fn=<IndexBackward0>)
负样本数量： 14559
正样本数量： 8441
TP:  5681
TN:  14225
FP:  334
FN:  2760
batch idx: 3, loss: 0.327679 auc: 0.9015, acc: 0.8655, precision: 0.9445, recall: 0.6730, f1: 0.7860, time: 0.102s
y_pred: tensor([0.0789, 0.0619, 0.0589,  ..., 0.9965, 0.9966, 0.9978],
       grad_fn=<IndexBackward0>)
负样本数量： 3111
正样本数量： 1633
TP:  1050
TN:  3039
FP:  72
FN:  583
batch idx: 4, loss: 0.328179 auc: 0.9022, acc: 0.8619, precision: 0.9358, recall: 0.6430, f1: 0.7623, time: 0.072s
First attempt - auc_train: 0.8993980928 acc_train: 0.8598897522
y_pred: tensor([0.7931, 0.8689, 0.8872,  ..., 0.9448, 0.9635, 0.9591])
负样本数量： 13803
正样本数量： 10029
TP:  7041
TN:  13485
FP:  318
FN:  2988
y_pred: tensor([0.8597, 0.7669, 0.2022,  ..., 0.9963, 0.9973, 0.9977])
负样本数量： 10038
正样本数量： 6127
TP:  4124
TN:  9825
FP:  213
FN:  2003
First attempt - auc_val: 0.9041704544 acc_val: 0.8612789527
Epoch: 0038 loss_train: 0.3316297412 auc_train: 0.9012374670 acc_train: 0.8608474847 precision_train: 0.9448506018 recall_train: 0.6662690930 f1_train: 0.7814292169 loss_val: 0.3298070729 auc_val: 0.9034232763 acc_val: 0.8620963276 precision_val: 0.9538376587 recall_val: 0.6875751768 f1_val: 0.7990475874 time: 0.6139s
Epoch 0038: val_loss 没有改善 0.329807，最佳值 0.329428，等待 6/15
y_pred: tensor([0.1797, 0.1596, 0.2581,  ..., 0.0479, 0.0527, 0.0524],
       grad_fn=<IndexBackward0>)
负样本数量： 14323
正样本数量： 8780
TP:  5844
TN:  13989
FP:  334
FN:  2936
batch idx: 0, loss: 0.334201 auc: 0.9015, acc: 0.8585, precision: 0.9459, recall: 0.6656, f1: 0.7814, time: 0.101s
y_pred: tensor([0.7417, 0.1585, 0.5459,  ..., 0.9955, 0.9975, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 14166
正样本数量： 8599
TP:  5692
TN:  13894
FP:  272
FN:  2907
batch idx: 1, loss: 0.329892 auc: 0.9035, acc: 0.8604, precision: 0.9544, recall: 0.6619, f1: 0.7817, time: 0.100s
y_pred: tensor([0.2250, 0.1342, 0.1421,  ..., 0.0883, 0.0794, 0.0881],
       grad_fn=<IndexBackward0>)
负样本数量： 14117
正样本数量： 9061
TP:  6036
TN:  13794
FP:  323
FN:  3025
batch idx: 2, loss: 0.340152 auc: 0.8971, acc: 0.8556, precision: 0.9492, recall: 0.6662, f1: 0.7829, time: 0.136s
y_pred: tensor([0.2087, 0.4266, 0.3611,  ..., 0.1044, 0.5251, 0.6575],
       grad_fn=<IndexBackward0>)
负样本数量： 14265
正样本数量： 8583
TP:  5832
TN:  13921
FP:  344
FN:  2751
batch idx: 3, loss: 0.326279 auc: 0.9031, acc: 0.8645, precision: 0.9443, recall: 0.6795, f1: 0.7903, time: 0.124s
y_pred: tensor([0.1387, 0.0830, 0.0835,  ..., 0.0884, 0.0869, 0.0971],
       grad_fn=<IndexBackward0>)
负样本数量： 3116
正样本数量： 1769
TP:  1199
TN:  3045
FP:  71
FN:  570
batch idx: 4, loss: 0.321134 auc: 0.9040, acc: 0.8688, precision: 0.9441, recall: 0.6778, f1: 0.7891, time: 0.074s
First attempt - auc_train: 0.9014986091 acc_train: 0.8584599403
y_pred: tensor([0.0837, 0.0651, 0.0615,  ..., 0.9979, 0.9968, 0.9946])
负样本数量： 14026
正样本数量： 9788
TP:  6847
TN:  13669
FP:  357
FN:  2941
y_pred: tensor([0.7739, 0.8150, 0.8217,  ..., 0.9977, 0.9975, 0.9963])
负样本数量： 9815
正样本数量： 6368
TP:  4388
TN:  9607
FP:  208
FN:  1980
First attempt - auc_val: 0.9021840773 acc_val: 0.8615100361
Epoch: 0039 loss_train: 0.3303315759 auc_train: 0.9018401567 acc_train: 0.8615379961 precision_train: 0.9475862155 recall_train: 0.6701918951 f1_train: 0.7850694257 loss_val: 0.3291561455 auc_val: 0.9041646803 acc_val: 0.8631532137 precision_val: 0.9525937263 recall_val: 0.6943001943 f1_val: 0.8031732297 time: 0.7391s
Best model so far, saving...
Epoch 0039: val_loss 没有改善 0.329156，最佳值 0.329428，等待 7/15
y_pred: tensor([0.0929, 0.0626, 0.0661,  ..., 0.8192, 0.3335, 0.3223],
       grad_fn=<IndexBackward0>)
负样本数量： 14383
正样本数量： 8848
TP:  5927
TN:  14024
FP:  359
FN:  2921
batch idx: 0, loss: 0.336521 auc: 0.8999, acc: 0.8588, precision: 0.9429, recall: 0.6699, f1: 0.7833, time: 0.166s
y_pred: tensor([0.1916, 0.1532, 0.1364,  ..., 0.1879, 0.1708, 0.1720],
       grad_fn=<IndexBackward0>)
负样本数量： 14505
正样本数量： 8540
TP:  5610
TN:  14207
FP:  298
FN:  2930
batch idx: 1, loss: 0.331754 auc: 0.9011, acc: 0.8599, precision: 0.9496, recall: 0.6569, f1: 0.7766, time: 0.117s
y_pred: tensor([0.1055, 0.0853, 0.0778,  ..., 0.9976, 0.9977, 0.8151],
       grad_fn=<IndexBackward0>)
负样本数量： 14341
正样本数量： 8801
TP:  5884
TN:  14014
FP:  327
FN:  2917
batch idx: 2, loss: 0.331638 auc: 0.9015, acc: 0.8598, precision: 0.9474, recall: 0.6686, f1: 0.7839, time: 0.090s
y_pred: tensor([0.6817, 0.1149, 0.0879,  ..., 0.9981, 0.9973, 0.9970],
       grad_fn=<IndexBackward0>)
负样本数量： 13860
正样本数量： 8758
TP:  5987
TN:  13549
FP:  311
FN:  2771
batch idx: 3, loss: 0.327567 auc: 0.9039, acc: 0.8637, precision: 0.9506, recall: 0.6836, f1: 0.7953, time: 0.089s
y_pred: tensor([0.2361, 0.1522, 0.1421,  ..., 0.2151, 0.2172, 0.2177],
       grad_fn=<IndexBackward0>)
负样本数量： 2898
正样本数量： 1845
TP:  1248
TN:  2842
FP:  56
FN:  597
batch idx: 4, loss: 0.327420 auc: 0.9015, acc: 0.8623, precision: 0.9571, recall: 0.6764, f1: 0.7926, time: 0.063s
First attempt - auc_train: 0.8999289679 acc_train: 0.8588093496
y_pred: tensor([0.8092, 0.2007, 0.1456,  ..., 0.9975, 0.9963, 0.9961])
负样本数量： 14166
正样本数量： 9510
TP:  6554
TN:  13856
FP:  310
FN:  2956
y_pred: tensor([0.0830, 0.0647, 0.0610,  ..., 0.9191, 0.9231, 0.9470])
负样本数量： 9675
正样本数量： 6646
TP:  4636
TN:  9453
FP:  222
FN:  2010
First attempt - auc_val: 0.9031539432 acc_val: 0.8620544011
Epoch: 0040 loss_train: 0.3309799492 auc_train: 0.9015848359 acc_train: 0.8609235641 precision_train: 0.9494949621 recall_train: 0.6710728559 f1_train: 0.7863367757 loss_val: 0.3298364729 auc_val: 0.9040443453 acc_val: 0.8626490374 precision_val: 0.9545695059 recall_val: 0.6933658695 f1_val: 0.8032589830 time: 0.6643s
Epoch 0040: val_loss 没有改善 0.329836，最佳值 0.329428，等待 8/15
y_pred: tensor([0.1957, 0.4292, 0.5261,  ..., 0.9970, 0.9968, 0.9977],
       grad_fn=<IndexBackward0>)
负样本数量： 14132
正样本数量： 8950
TP:  6124
TN:  13837
FP:  295
FN:  2826
batch idx: 0, loss: 0.325409 auc: 0.9051, acc: 0.8648, precision: 0.9540, recall: 0.6842, f1: 0.7969, time: 0.086s
y_pred: tensor([0.6642, 0.7941, 0.1739,  ..., 0.6900, 0.7623, 0.8076],
       grad_fn=<IndexBackward0>)
负样本数量： 15007
正样本数量： 8111
TP:  5312
TN:  14740
FP:  267
FN:  2799
batch idx: 1, loss: 0.324021 auc: 0.9003, acc: 0.8674, precision: 0.9521, recall: 0.6549, f1: 0.7760, time: 0.085s
y_pred: tensor([0.0708, 0.0609, 0.0610,  ..., 0.1017, 0.1088, 0.0987],
       grad_fn=<IndexBackward0>)
负样本数量： 13922
正样本数量： 8959
TP:  5999
TN:  13579
FP:  343
FN:  2960
batch idx: 2, loss: 0.335148 auc: 0.9035, acc: 0.8556, precision: 0.9459, recall: 0.6696, f1: 0.7841, time: 0.086s
y_pred: tensor([0.1188, 0.0785, 0.0801,  ..., 0.1027, 0.1057, 0.1102],
       grad_fn=<IndexBackward0>)
负样本数量： 14147
正样本数量： 8756
TP:  5760
TN:  13825
FP:  322
FN:  2996
batch idx: 3, loss: 0.340327 auc: 0.8973, acc: 0.8551, precision: 0.9471, recall: 0.6578, f1: 0.7764, time: 0.086s
y_pred: tensor([0.6822, 0.1075, 0.0824,  ..., 0.9969, 0.9964, 0.9965],
       grad_fn=<IndexBackward0>)
负样本数量： 2779
正样本数量： 2016
TP:  1419
TN:  2694
FP:  85
FN:  597
batch idx: 4, loss: 0.338702 auc: 0.9015, acc: 0.8578, precision: 0.9435, recall: 0.7039, f1: 0.8063, time: 0.060s
First attempt - auc_train: 0.9051485238 acc_train: 0.8647864137
y_pred: tensor([0.8213, 0.7448, 0.8342,  ..., 0.9656, 0.9800, 0.9809])
负样本数量： 14111
正样本数量： 9328
TP:  6375
TN:  13747
FP:  364
FN:  2953
y_pred: tensor([0.1144, 0.2872, 0.1561,  ..., 0.0863, 0.0859, 0.0856])
负样本数量： 9730
正样本数量： 6828
TP:  4872
TN:  9524
FP:  206
FN:  1956
First attempt - auc_val: 0.8995505518 acc_val: 0.8584837237
Epoch: 0041 loss_train: 0.3327215910 auc_train: 0.9015333016 acc_train: 0.8601407127 precision_train: 0.9485283386 recall_train: 0.6740937098 f1_train: 0.7879473004 loss_val: 0.3281628042 auc_val: 0.9047119304 acc_val: 0.8639561993 precision_val: 0.9527094495 recall_val: 0.6984793784 f1_val: 0.8059814431 time: 0.5253s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-08-02 11-45-47//checkpoints/best_model.pt
Epoch 0041: val_loss 改善从 0.328163 到 0.328163
y_pred: tensor([0.1318, 0.1199, 0.1217,  ..., 0.1059, 0.1056, 0.1038],
       grad_fn=<IndexBackward0>)
负样本数量： 14136
正样本数量： 8550
TP:  5730
TN:  13815
FP:  321
FN:  2820
batch idx: 0, loss: 0.327926 auc: 0.9048, acc: 0.8615, precision: 0.9470, recall: 0.6702, f1: 0.7849, time: 0.085s
y_pred: tensor([0.8248, 0.7449, 0.1248,  ..., 0.9975, 0.9968, 0.9969],
       grad_fn=<IndexBackward0>)
负样本数量： 14192
正样本数量： 8978
TP:  6017
TN:  13911
FP:  281
FN:  2961
batch idx: 1, loss: 0.330828 auc: 0.9018, acc: 0.8601, precision: 0.9554, recall: 0.6702, f1: 0.7878, time: 0.085s
y_pred: tensor([0.1110, 0.0752, 0.0844,  ..., 0.9956, 0.9981, 0.9940],
       grad_fn=<IndexBackward0>)
负样本数量： 14651
正样本数量： 8455
TP:  5498
TN:  14348
FP:  303
FN:  2957
batch idx: 2, loss: 0.336496 auc: 0.8942, acc: 0.8589, precision: 0.9478, recall: 0.6503, f1: 0.7713, time: 0.087s
y_pred: tensor([0.2035, 0.4415, 0.2585,  ..., 0.4361, 0.2634, 0.2281],
       grad_fn=<IndexBackward0>)
负样本数量： 13908
正样本数量： 9152
TP:  6238
TN:  13582
FP:  326
FN:  2914
batch idx: 3, loss: 0.330260 auc: 0.9068, acc: 0.8595, precision: 0.9503, recall: 0.6816, f1: 0.7938, time: 0.084s
y_pred: tensor([0.7914, 0.8811, 0.8576,  ..., 0.7110, 0.7894, 0.8428],
       grad_fn=<IndexBackward0>)
负样本数量： 3100
正样本数量： 1657
TP:  1072
TN:  3040
FP:  60
FN:  585
batch idx: 4, loss: 0.335251 auc: 0.8946, acc: 0.8644, precision: 0.9470, recall: 0.6470, f1: 0.7687, time: 0.063s
First attempt - auc_train: 0.9047908579 acc_train: 0.8615445649
y_pred: tensor([0.1153, 0.0841, 0.0782,  ..., 0.2692, 0.9593, 0.9831])
负样本数量： 14140
正样本数量： 9422
TP:  6474
TN:  13814
FP:  326
FN:  2948
y_pred: tensor([0.1153, 0.2848, 0.1567,  ..., 0.9962, 0.9977, 0.9978])
负样本数量： 9701
正样本数量： 6734
TP:  4716
TN:  9493
FP:  208
FN:  2018
First attempt - auc_val: 0.9030754371 acc_val: 0.8610474493
Epoch: 0042 loss_train: 0.3321524620 auc_train: 0.9004392375 acc_train: 0.8608881328 precision_train: 0.9494865665 recall_train: 0.6638374668 f1_train: 0.7813097512 loss_val: 0.3293474764 auc_val: 0.9041469600 acc_val: 0.8628023982 precision_val: 0.9549083720 recall_val: 0.6937209812 f1_val: 0.8036167375 time: 0.5284s
Epoch 0042: val_loss 没有改善 0.329347，最佳值 0.328163，等待 1/15
y_pred: tensor([0.1184, 0.0781, 0.0818,  ..., 0.9967, 0.9976, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 14620
正样本数量： 8686
TP:  5830
TN:  14278
FP:  342
FN:  2856
batch idx: 0, loss: 0.326970 auc: 0.9050, acc: 0.8628, precision: 0.9446, recall: 0.6712, f1: 0.7848, time: 0.084s
y_pred: tensor([0.8344, 0.2608, 0.1932,  ..., 0.9958, 0.9957, 0.9932],
       grad_fn=<IndexBackward0>)
负样本数量： 14084
正样本数量： 8979
TP:  6022
TN:  13785
FP:  299
FN:  2957
batch idx: 1, loss: 0.335491 auc: 0.9000, acc: 0.8588, precision: 0.9527, recall: 0.6707, f1: 0.7872, time: 0.085s
y_pred: tensor([0.8008, 0.7258, 0.1308,  ..., 0.0544, 0.0574, 0.0559],
       grad_fn=<IndexBackward0>)
负样本数量： 14267
正样本数量： 8559
TP:  5676
TN:  13977
FP:  290
FN:  2883
batch idx: 2, loss: 0.332707 auc: 0.8993, acc: 0.8610, precision: 0.9514, recall: 0.6632, f1: 0.7815, time: 0.086s
y_pred: tensor([0.8273, 0.7418, 0.1352,  ..., 0.9976, 0.9967, 0.9981],
       grad_fn=<IndexBackward0>)
负样本数量： 14148
正样本数量： 8652
TP:  5775
TN:  13841
FP:  307
FN:  2877
batch idx: 3, loss: 0.331297 auc: 0.9021, acc: 0.8604, precision: 0.9495, recall: 0.6675, f1: 0.7839, time: 0.086s
y_pred: tensor([0.6890, 0.0734, 0.0696,  ..., 0.1890, 0.1725, 0.1917],
       grad_fn=<IndexBackward0>)
负样本数量： 2868
正样本数量： 1916
TP:  1316
TN:  2806
FP:  62
FN:  600
batch idx: 4, loss: 0.328087 auc: 0.9050, acc: 0.8616, precision: 0.9550, recall: 0.6868, f1: 0.7990, time: 0.061s
First attempt - auc_train: 0.9049820528 acc_train: 0.8627821162
y_pred: tensor([0.1361, 0.1204, 0.4450,  ..., 0.9977, 0.9941, 0.9964])
负样本数量： 13730
正样本数量： 9793
TP:  6905
TN:  13406
FP:  324
FN:  2888
y_pred: tensor([0.7239, 0.1461, 0.1633,  ..., 0.9976, 0.9968, 0.9970])
负样本数量： 10111
正样本数量： 6363
TP:  4284
TN:  9907
FP:  204
FN:  2079
First attempt - auc_val: 0.9085886258 acc_val: 0.8634527909
Epoch: 0043 loss_train: 0.3309103131 auc_train: 0.9022874643 acc_train: 0.8609136815 precision_train: 0.9506414958 recall_train: 0.6718711920 f1_train: 0.7872861462 loss_val: 0.3304225057 auc_val: 0.9028043436 acc_val: 0.8624353914 precision_val: 0.9548629887 recall_val: 0.6891814015 f1_val: 0.8004538322 time: 0.5260s
Epoch 0043: val_loss 没有改善 0.330423，最佳值 0.328163，等待 2/15
y_pred: tensor([0.1550, 0.1152, 0.0993,  ..., 0.9966, 0.9947, 0.9969],
       grad_fn=<IndexBackward0>)
负样本数量： 14381
正样本数量： 8765
TP:  5898
TN:  14039
FP:  342
FN:  2867
batch idx: 0, loss: 0.328570 auc: 0.9036, acc: 0.8614, precision: 0.9452, recall: 0.6729, f1: 0.7861, time: 0.084s
y_pred: tensor([0.8512, 0.8827, 0.9171,  ..., 0.9977, 0.9976, 0.9971],
       grad_fn=<IndexBackward0>)
负样本数量： 14682
正样本数量： 8885
TP:  5871
TN:  14440
FP:  242
FN:  3014
batch idx: 1, loss: 0.330075 auc: 0.9017, acc: 0.8618, precision: 0.9604, recall: 0.6608, f1: 0.7829, time: 0.086s
y_pred: tensor([0.0806, 0.5785, 0.3081,  ..., 0.9974, 0.9980, 0.9980],
       grad_fn=<IndexBackward0>)
负样本数量： 14317
正样本数量： 8626
TP:  5716
TN:  14046
FP:  271
FN:  2910
batch idx: 2, loss: 0.330310 auc: 0.9009, acc: 0.8614, precision: 0.9547, recall: 0.6626, f1: 0.7823, time: 0.087s
y_pred: tensor([0.1675, 0.1521, 0.1486,  ..., 0.9978, 0.9941, 0.9979],
       grad_fn=<IndexBackward0>)
负样本数量： 13668
正样本数量： 8776
TP:  5854
TN:  13370
FP:  298
FN:  2922
batch idx: 3, loss: 0.335052 auc: 0.9024, acc: 0.8565, precision: 0.9516, recall: 0.6670, f1: 0.7843, time: 0.086s
y_pred: tensor([0.1510, 0.1011, 0.0923,  ..., 0.9608, 0.9953, 0.9946],
       grad_fn=<IndexBackward0>)
负样本数量： 2939
正样本数量： 1740
TP:  1150
TN:  2859
FP:  80
FN:  590
batch idx: 4, loss: 0.338441 auc: 0.8990, acc: 0.8568, precision: 0.9350, recall: 0.6609, f1: 0.7744, time: 0.061s
First attempt - auc_train: 0.9035529584 acc_train: 0.8613583341
y_pred: tensor([0.0832, 0.0660, 0.0626,  ..., 0.1354, 0.1351, 0.1348])
负样本数量： 14222
正样本数量： 9647
TP:  6808
TN:  13884
FP:  338
FN:  2839
y_pred: tensor([0.2022, 0.4301, 0.3474,  ..., 0.1177, 0.1244, 0.4249])
负样本数量： 9619
正样本数量： 6509
TP:  4446
TN:  9391
FP:  228
FN:  2063
First attempt - auc_val: 0.9080158989 acc_val: 0.8668984876
Epoch: 0044 loss_train: 0.3324897468 auc_train: 0.9015155581 acc_train: 0.8595779825 precision_train: 0.9493719243 recall_train: 0.6648588046 f1_train: 0.7820136388 loss_val: 0.3312875926 auc_val: 0.9030441836 acc_val: 0.8624236982 precision_val: 0.9519601619 recall_val: 0.6943829264 f1_val: 0.8029747516 time: 0.5292s
Epoch 0044: val_loss 没有改善 0.331288，最佳值 0.328163，等待 3/15
y_pred: tensor([0.1154, 0.0870, 0.0703,  ..., 0.6214, 0.7437, 0.7806],
       grad_fn=<IndexBackward0>)
负样本数量： 14336
正样本数量： 8947
TP:  6135
TN:  14020
FP:  316
FN:  2812
batch idx: 0, loss: 0.326141 auc: 0.9039, acc: 0.8657, precision: 0.9510, recall: 0.6857, f1: 0.7969, time: 0.087s
y_pred: tensor([0.0817, 0.0643, 0.0655,  ..., 0.9964, 0.9970, 0.9964],
       grad_fn=<IndexBackward0>)
负样本数量： 14306
正样本数量： 8410
TP:  5584
TN:  13994
FP:  312
FN:  2826
batch idx: 1, loss: 0.330832 auc: 0.9016, acc: 0.8619, precision: 0.9471, recall: 0.6640, f1: 0.7807, time: 0.086s
y_pred: tensor([0.1093, 0.0847, 0.0739,  ..., 0.9981, 0.9975, 0.9973],
       grad_fn=<IndexBackward0>)
负样本数量： 14387
正样本数量： 8441
TP:  5522
TN:  14095
FP:  292
FN:  2919
batch idx: 2, loss: 0.334064 auc: 0.8978, acc: 0.8593, precision: 0.9498, recall: 0.6542, f1: 0.7747, time: 0.090s
y_pred: tensor([0.8248, 0.2215, 0.1920,  ..., 0.9956, 0.9960, 0.9937],
       grad_fn=<IndexBackward0>)
负样本数量： 13906
正样本数量： 9130
TP:  6153
TN:  13609
FP:  297
FN:  2977
batch idx: 3, loss: 0.331014 auc: 0.9062, acc: 0.8579, precision: 0.9540, recall: 0.6739, f1: 0.7899, time: 0.092s
y_pred: tensor([0.1346, 0.1222, 0.1266,  ..., 0.9964, 0.9963, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 3052
正样本数量： 1864
TP:  1216
TN:  2981
FP:  71
FN:  648
batch idx: 4, loss: 0.342828 auc: 0.8949, acc: 0.8537, precision: 0.9448, recall: 0.6524, f1: 0.7718, time: 0.066s
First attempt - auc_train: 0.9039100406 acc_train: 0.8656530516
y_pred: tensor([0.6803, 0.1128, 0.0851,  ..., 0.1542, 0.1514, 0.1490])
负样本数量： 14201
正样本数量： 9381
TP:  6399
TN:  13887
FP:  314
FN:  2982
y_pred: tensor([0.1529, 0.1648, 0.0752,  ..., 0.1009, 0.1003, 0.0998])
负样本数量： 9640
正样本数量： 6775
TP:  4781
TN:  9429
FP:  211
FN:  1994
First attempt - auc_val: 0.9010677267 acc_val: 0.8602323806
Epoch: 0045 loss_train: 0.3329757750 auc_train: 0.9008825780 acc_train: 0.8596938906 precision_train: 0.9493321899 recall_train: 0.6660313335 f1_train: 0.7827862353 loss_val: 0.3283921331 auc_val: 0.9046685497 acc_val: 0.8629520112 precision_val: 0.9554787287 recall_val: 0.6939030489 f1_val: 0.8039073610 time: 0.5487s
Epoch 0045: val_loss 没有改善 0.328392，最佳值 0.328163，等待 4/15
y_pred: tensor([0.1355, 0.1157, 0.1184,  ..., 0.2541, 0.2405, 0.3779],
       grad_fn=<IndexBackward0>)
负样本数量： 14130
正样本数量： 8642
TP:  5770
TN:  13865
FP:  265
FN:  2872
batch idx: 0, loss: 0.329260 auc: 0.9014, acc: 0.8622, precision: 0.9561, recall: 0.6677, f1: 0.7863, time: 0.090s
y_pred: tensor([0.1192, 0.0748, 0.0787,  ..., 0.0919, 0.0933, 0.0921],
       grad_fn=<IndexBackward0>)
负样本数量： 14306
正样本数量： 8768
TP:  5870
TN:  13975
FP:  331
FN:  2898
batch idx: 1, loss: 0.331245 auc: 0.9034, acc: 0.8601, precision: 0.9466, recall: 0.6695, f1: 0.7843, time: 0.092s
y_pred: tensor([0.1097, 0.0858, 0.0772,  ..., 0.6870, 0.7814, 0.8705],
       grad_fn=<IndexBackward0>)
负样本数量： 14373
正样本数量： 8557
TP:  5748
TN:  14045
FP:  328
FN:  2809
batch idx: 2, loss: 0.329180 auc: 0.9020, acc: 0.8632, precision: 0.9460, recall: 0.6717, f1: 0.7856, time: 0.096s
y_pred: tensor([0.1901, 0.1538, 0.1518,  ..., 0.9968, 0.9968, 0.9980],
       grad_fn=<IndexBackward0>)
负样本数量： 14154
正样本数量： 9035
TP:  6106
TN:  13790
FP:  364
FN:  2929
batch idx: 3, loss: 0.335102 auc: 0.9019, acc: 0.8580, precision: 0.9437, recall: 0.6758, f1: 0.7876, time: 0.088s
y_pred: tensor([0.1562, 0.1051, 0.1006,  ..., 0.9981, 0.9961, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 3024
正样本数量： 1790
TP:  1206
TN:  2962
FP:  62
FN:  584
batch idx: 4, loss: 0.323815 auc: 0.9043, acc: 0.8658, precision: 0.9511, recall: 0.6737, f1: 0.7888, time: 0.062s
First attempt - auc_train: 0.9013807304 acc_train: 0.8622431056
y_pred: tensor([0.2027, 0.4383, 0.3545,  ..., 0.1665, 0.1642, 0.1619])
负样本数量： 14037
正样本数量： 9593
TP:  6713
TN:  13672
FP:  365
FN:  2880
y_pred: tensor([0.1514, 0.1046, 0.0963,  ..., 0.9977, 0.9979, 0.9980])
负样本数量： 9804
正样本数量： 6563
TP:  4604
TN:  9580
FP:  224
FN:  1959
First attempt - auc_val: 0.9031606102 acc_val: 0.8626745662
Epoch: 0046 loss_train: 0.3297204554 auc_train: 0.9025902227 acc_train: 0.8618590889 precision_train: 0.9487145096 recall_train: 0.6716878963 f1_train: 0.7865082012 loss_val: 0.3289806992 auc_val: 0.9043779680 acc_val: 0.8646482136 precision_val: 0.9510178686 recall_val: 0.7006447734 f1_val: 0.8068540420 time: 0.5520s
Epoch 0046: val_loss 没有改善 0.328981，最佳值 0.328163，等待 5/15
y_pred: tensor([0.7884, 0.8495, 0.2006,  ..., 0.9976, 0.9941, 0.7362],
       grad_fn=<IndexBackward0>)
负样本数量： 14422
正样本数量： 8701
TP:  5892
TN:  14083
FP:  339
FN:  2809
batch idx: 0, loss: 0.327535 auc: 0.9043, acc: 0.8639, precision: 0.9456, recall: 0.6772, f1: 0.7892, time: 0.083s
y_pred: tensor([0.1837, 0.1565, 0.1433,  ..., 0.9961, 0.9962, 0.9965],
       grad_fn=<IndexBackward0>)
负样本数量： 14698
正样本数量： 8660
TP:  5805
TN:  14352
FP:  346
FN:  2855
batch idx: 1, loss: 0.330981 auc: 0.9011, acc: 0.8630, precision: 0.9437, recall: 0.6703, f1: 0.7839, time: 0.087s
y_pred: tensor([0.2138, 0.1568, 0.1429,  ..., 0.9982, 0.9976, 0.9968],
       grad_fn=<IndexBackward0>)
负样本数量： 13918
正样本数量： 8859
TP:  6001
TN:  13647
FP:  271
FN:  2858
batch idx: 2, loss: 0.327535 auc: 0.9042, acc: 0.8626, precision: 0.9568, recall: 0.6774, f1: 0.7932, time: 0.100s
y_pred: tensor([0.1087, 0.0873, 0.0821,  ..., 0.7718, 0.3129, 0.2360],
       grad_fn=<IndexBackward0>)
负样本数量： 14111
正样本数量： 8794
TP:  5813
TN:  13799
FP:  312
FN:  2981
batch idx: 3, loss: 0.339092 auc: 0.8980, acc: 0.8562, precision: 0.9491, recall: 0.6610, f1: 0.7793, time: 0.087s
y_pred: tensor([0.1954, 0.2365, 0.1095,  ..., 0.9969, 0.9973, 0.9971],
       grad_fn=<IndexBackward0>)
负样本数量： 2838
正样本数量： 1778
TP:  1192
TN:  2784
FP:  54
FN:  586
batch idx: 4, loss: 0.326069 auc: 0.9055, acc: 0.8614, precision: 0.9567, recall: 0.6704, f1: 0.7884, time: 0.061s
First attempt - auc_train: 0.9042889044 acc_train: 0.8638584959
y_pred: tensor([0.2005, 0.1528, 0.1446,  ..., 0.0997, 0.0990, 0.0985])
负样本数量： 13850
正样本数量： 9657
TP:  6735
TN:  13512
FP:  338
FN:  2922
y_pred: tensor([0.1130, 0.0830, 0.0774,  ..., 0.9980, 0.9942, 0.9969])
负样本数量： 9991
正样本数量： 6499
TP:  4493
TN:  9781
FP:  210
FN:  2006
First attempt - auc_val: 0.9036716637 acc_val: 0.8613179053
Epoch: 0047 loss_train: 0.3302422941 auc_train: 0.9026102503 acc_train: 0.8614052628 precision_train: 0.9503716448 recall_train: 0.6712624338 f1_train: 0.7867789986 loss_val: 0.3287311643 auc_val: 0.9042465674 acc_val: 0.8634667149 precision_val: 0.9537801450 recall_val: 0.6943793441 f1_val: 0.8036593243 time: 0.5434s
Epoch 0047: val_loss 没有改善 0.328731，最佳值 0.328163，等待 6/15
y_pred: tensor([0.0760, 0.0656, 0.0618,  ..., 0.9932, 0.9975, 0.9981],
       grad_fn=<IndexBackward0>)
负样本数量： 13665
正样本数量： 9070
TP:  6301
TN:  13391
FP:  274
FN:  2769
batch idx: 0, loss: 0.320733 auc: 0.9101, acc: 0.8662, precision: 0.9583, recall: 0.6947, f1: 0.8055, time: 0.085s
y_pred: tensor([0.1505, 0.1285, 0.1065,  ..., 0.7379, 0.4570, 0.4181],
       grad_fn=<IndexBackward0>)
负样本数量： 14644
正样本数量： 8433
TP:  5501
TN:  14321
FP:  323
FN:  2932
batch idx: 1, loss: 0.339162 auc: 0.8935, acc: 0.8590, precision: 0.9445, recall: 0.6523, f1: 0.7717, time: 0.086s
y_pred: tensor([0.1803, 0.1566, 0.3653,  ..., 0.9977, 0.9966, 0.9981],
       grad_fn=<IndexBackward0>)
负样本数量： 14680
正样本数量： 8686
TP:  5877
TN:  14325
FP:  355
FN:  2809
batch idx: 2, loss: 0.328703 auc: 0.9020, acc: 0.8646, precision: 0.9430, recall: 0.6766, f1: 0.7879, time: 0.088s
y_pred: tensor([0.1345, 0.1198, 0.1199,  ..., 0.9965, 0.9966, 0.9976],
       grad_fn=<IndexBackward0>)
负样本数量： 14164
正样本数量： 8751
TP:  5891
TN:  13805
FP:  359
FN:  2860
batch idx: 3, loss: 0.331698 auc: 0.9034, acc: 0.8595, precision: 0.9426, recall: 0.6732, f1: 0.7854, time: 0.089s
y_pred: tensor([0.1846, 0.1646, 0.1375,  ..., 0.3154, 0.3143, 0.2998],
       grad_fn=<IndexBackward0>)
负样本数量： 2834
正样本数量： 1852
TP:  1265
TN:  2744
FP:  90
FN:  587
batch idx: 4, loss: 0.341763 auc: 0.8989, acc: 0.8555, precision: 0.9336, recall: 0.6830, f1: 0.7889, time: 0.061s
First attempt - auc_train: 0.9100985908 acc_train: 0.8661535078
y_pred: tensor([0.1993, 0.2341, 0.1036,  ..., 0.7027, 0.5739, 0.2936])
负样本数量： 13989
正样本数量： 9384
TP:  6455
TN:  13683
FP:  306
FN:  2929
y_pred: tensor([0.1121, 0.0824, 0.0768,  ..., 0.2712, 0.2457, 0.2370])
负样本数量： 9852
正样本数量： 6772
TP:  4736
TN:  9638
FP:  214
FN:  2036
First attempt - auc_val: 0.9016590957 acc_val: 0.8615924357
Epoch: 0048 loss_train: 0.3324118137 auc_train: 0.9015727415 acc_train: 0.8609489967 precision_train: 0.9444084221 recall_train: 0.6759715397 f1_train: 0.7878817755 loss_val: 0.3285004497 auc_val: 0.9046930770 acc_val: 0.8631229744 precision_val: 0.9557540499 recall_val: 0.6936116205 f1_val: 0.8038408006 time: 0.5316s
Epoch 0048: val_loss 没有改善 0.328500，最佳值 0.328163，等待 7/15
y_pred: tensor([0.1856, 0.4110, 0.3562,  ..., 0.9965, 0.9975, 0.9966],
       grad_fn=<IndexBackward0>)
负样本数量： 14220
正样本数量： 8823
TP:  5913
TN:  13912
FP:  308
FN:  2910
batch idx: 0, loss: 0.330971 auc: 0.9026, acc: 0.8603, precision: 0.9505, recall: 0.6702, f1: 0.7861, time: 0.087s
y_pred: tensor([0.1525, 0.1200, 0.1089,  ..., 0.9961, 0.9965, 0.9979],
       grad_fn=<IndexBackward0>)
负样本数量： 14438
正样本数量： 8628
TP:  5631
TN:  14184
FP:  254
FN:  2997
batch idx: 1, loss: 0.333797 auc: 0.9000, acc: 0.8591, precision: 0.9568, recall: 0.6526, f1: 0.7760, time: 0.094s
y_pred: tensor([0.1272, 0.1229, 0.1194,  ..., 0.1682, 0.1615, 0.1597],
       grad_fn=<IndexBackward0>)
负样本数量： 14239
正样本数量： 8438
TP:  5540
TN:  13968
FP:  271
FN:  2898
batch idx: 2, loss: 0.329861 auc: 0.9022, acc: 0.8603, precision: 0.9534, recall: 0.6566, f1: 0.7776, time: 0.091s
y_pred: tensor([0.0815, 0.0645, 0.0573,  ..., 0.2491, 0.2539, 0.2684],
       grad_fn=<IndexBackward0>)
负样本数量： 14178
正样本数量： 8898
TP:  5968
TN:  13896
FP:  282
FN:  2930
batch idx: 3, loss: 0.329676 auc: 0.9038, acc: 0.8608, precision: 0.9549, recall: 0.6707, f1: 0.7880, time: 0.092s
y_pred: tensor([0.1930, 0.1577, 0.1508,  ..., 0.9981, 0.9977, 0.9974],
       grad_fn=<IndexBackward0>)
负样本数量： 2912
正样本数量： 2005
TP:  1382
TN:  2855
FP:  57
FN:  623
batch idx: 4, loss: 0.327160 auc: 0.9076, acc: 0.8617, precision: 0.9604, recall: 0.6893, f1: 0.8026, time: 0.065s
First attempt - auc_train: 0.9025647430 acc_train: 0.8603480450
y_pred: tensor([0.7460, 0.8229, 0.8784,  ..., 0.2356, 0.2268, 0.2194])
负样本数量： 14045
正样本数量： 9613
TP:  6720
TN:  13716
FP:  329
FN:  2893
y_pred: tensor([0.0819, 0.0657, 0.0624,  ..., 0.1202, 0.1264, 0.4050])
负样本数量： 9796
正样本数量： 6543
TP:  4469
TN:  9606
FP:  190
FN:  2074
First attempt - auc_val: 0.9072672593 acc_val: 0.8638092823
Epoch: 0049 loss_train: 0.3302928507 auc_train: 0.9032330958 acc_train: 0.8604343212 precision_train: 0.9551926331 recall_train: 0.6678731567 f1_train: 0.7860400926 loss_val: 0.3296907991 auc_val: 0.9035921703 acc_val: 0.8626225553 precision_val: 0.9562727147 recall_val: 0.6910366933 f1_val: 0.8022595443 time: 0.5550s
Epoch 0049: val_loss 没有改善 0.329691，最佳值 0.328163，等待 8/15

=== 完成所有epoch训练 ===
最佳epoch: 41
最佳验证损失: 0.328163
总训练时间: 29.75秒
Optimization Finished!
Best Epoch: 0041
y_pred: tensor([0.7376, 0.6690, 0.1052,  ..., 0.6889, 0.7502, 0.7915])
负样本数量： 14202
正样本数量： 9506
TP:  6376
TN:  13893
FP:  309
FN:  3130
y_pred: tensor([0.2000, 0.1503, 0.1414,  ..., 0.9930, 0.9941, 0.9953])
负样本数量： 9016
正样本数量： 6343
TP:  4307
TN:  8813
FP:  203
FN:  2036
--------------------------------
--------Testing-----------------
--------------------------------
loss_test: 0.3369339705 auc_test: 0.9035237437 acc_test: 0.8545828795 precision_test: 0.9543830132 recall_test: 0.6748752557 f1_test: 0.7906478217 auc_max: 0.9053068513 acc_max: 0.8549434790 auc_std_test: 0.0017831076 acc_std_test: 0.0003605994 first_attempt_auc_test: 0.9017406361 first_attempt_acc_test: 0.8549434790
../model/expCEKT2025-08-02 11-45-47/
