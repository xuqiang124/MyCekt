/home/dzq/k12/cekt/code/train_demo.py:130: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  embeddings_tensor = torch.tensor(embeddings, dtype=torch.long)
=== GPU信息 ===
PyTorch版本: 2.5.1+cu124
CUDA可用: True
CUDA版本: 12.4
可用GPU数量: 1
GPU 0: NVIDIA GeForce RTX 4090
  总内存: 23.6 GB
==================================================
使用CPU训练
Namespace(no_cuda=True, seed=42, data_dir='../data', save_dir='../model', graph_save_dir='graphs', load_dir='', hid_dim=32, emb_dim=32, attn_dim=32, vae_encoder_dim=32, vae_decoder_dim=32, edge_types=2, dropout=0, bias=True, binary=True, result_type=12, temp=0.5, hard=False, no_factor=False, prior=False, var=1, epochs=20, batch_size=16, train_ratio=0.6, val_ratio=0.2, shuffle=True, lr=0.001, lr_decay=50, gamma=0.5, test=False, test_model_dir='logs/expDKT', weight_method='senet', amp=False, gpu_id=0, cuda=False, factor=True)
从pkl文件加载数据集...../data/Java
从pkl文件加载数据集...../data/Java
训练集大小: 192
验证集大小: 64
测试集大小: 64
模型初始化完成
start training!
EarlyStopping: 监控 val_loss (最小值)，耐心值 15，最小变化阈值 0.001
开始训练，最大epoch数: 20
提前停止配置已启用，监控验证损失
负样本数量： 4505
正样本数量： 5966
TP:  5470
TN:  771
FP:  3734
FN:  496
batch idx: 0, loss: 0.679446 auc: 0.5664, acc: 0.5960, precision: 0.5943, recall: 0.9169, f1: 0.7212, time: 14.181s
负样本数量： 4201
正样本数量： 6629
TP:  6238
TN:  542
FP:  3659
FN:  391
batch idx: 1, loss: 0.671651 auc: 0.5424, acc: 0.6260, precision: 0.6303, recall: 0.9410, f1: 0.7549, time: 23.388s
负样本数量： 5798
正样本数量： 7840
TP:  7525
TN:  592
FP:  5206
FN:  315
batch idx: 2, loss: 0.678405 auc: 0.5495, acc: 0.5952, precision: 0.5911, recall: 0.9598, f1: 0.7316, time: 30.551s
负样本数量： 5155
正样本数量： 6324
TP:  6159
TN:  514
FP:  4641
FN:  165
batch idx: 3, loss: 0.681363 auc: 0.5706, acc: 0.5813, precision: 0.5703, recall: 0.9739, f1: 0.7193, time: 19.065s
负样本数量： 5250
正样本数量： 7848
TP:  7638
TN:  520
FP:  4730
FN:  210
batch idx: 4, loss: 0.663408 auc: 0.5882, acc: 0.6228, precision: 0.6176, recall: 0.9732, f1: 0.7556, time: 22.771s
负样本数量： 4807
正样本数量： 5770
TP:  5645
TN:  335
FP:  4472
FN:  125
batch idx: 5, loss: 0.683657 auc: 0.5787, acc: 0.5654, precision: 0.5580, recall: 0.9783, f1: 0.7106, time: 15.514s
负样本数量： 4393
正样本数量： 5924
TP:  5772
TN:  412
FP:  3981
FN:  152
batch idx: 6, loss: 0.668130 auc: 0.6085, acc: 0.5994, precision: 0.5918, recall: 0.9743, f1: 0.7364, time: 24.606s
负样本数量： 4155
正样本数量： 5947
TP:  5744
TN:  458
FP:  3697
FN:  203
batch idx: 7, loss: 0.666629 auc: 0.5759, acc: 0.6139, precision: 0.6084, recall: 0.9659, f1: 0.7466, time: 20.746s
负样本数量： 5284
正样本数量： 6210
TP:  5882
TN:  797
FP:  4487
FN:  328
batch idx: 8, loss: 0.679602 auc: 0.5973, acc: 0.5811, precision: 0.5673, recall: 0.9472, f1: 0.7096, time: 24.208s
负样本数量： 3773
正样本数量： 6077
TP:  5673
TN:  602
FP:  3171
FN:  404
batch idx: 9, loss: 0.654485 auc: 0.5881, acc: 0.6371, precision: 0.6415, recall: 0.9335, f1: 0.7604, time: 30.601s
负样本数量： 3482
正样本数量： 5179
TP:  4880
TN:  580
FP:  2902
FN:  299
batch idx: 10, loss: 0.656031 auc: 0.6060, acc: 0.6304, precision: 0.6271, recall: 0.9423, f1: 0.7530, time: 29.738s
负样本数量： 3994
正样本数量： 6152
TP:  5741
TN:  757
FP:  3237
FN:  411
batch idx: 11, loss: 0.652671 auc: 0.6024, acc: 0.6404, precision: 0.6395, recall: 0.9332, f1: 0.7589, time: 38.951s
First attempt - auc_train: 0.5664025296 acc_train: 0.5960271225
负样本数量： 4020
正样本数量： 5283
TP:  4783
TN:  898
FP:  3122
FN:  500
负样本数量： 4460
正样本数量： 6122
TP:  5682
TN:  765
FP:  3695
FN:  440
负样本数量： 3813
正样本数量： 5560
TP:  5060
TN:  880
FP:  2933
FN:  500
负样本数量： 5741
正样本数量： 7008
TP:  6441
TN:  1207
FP:  4534
FN:  567
First attempt - auc_val: 0.5832010212 acc_val: 0.6106632269
Epoch: 0000 loss_train: 0.6696232210 auc_train: 0.5811768899 acc_train: 0.6074270491 precision_train: 0.6030812092 recall_train: 0.9532962520 f1_train: 0.7381787324 loss_val: 0.6673564315 auc_val: 0.5920968949 acc_val: 0.6133826801 precision_val: 0.6077360031 recall_val: 0.9156623189 f1_val: 0.7304015849 time: 326.6884s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-07-30 11-54-20//checkpoints/best_model.pt
Epoch 0000: val_loss 改善从 0.667356 到 0.667356
负样本数量： 4104
正样本数量： 7551
TP:  7218
TN:  473
FP:  3631
FN:  333
batch idx: 0, loss: 0.642146 auc: 0.5618, acc: 0.6599, precision: 0.6653, recall: 0.9559, f1: 0.7846, time: 11.498s
负样本数量： 5427
正样本数量： 5695
TP:  5196
TN:  1237
FP:  4190
FN:  499
batch idx: 1, loss: 0.687292 auc: 0.5991, acc: 0.5784, precision: 0.5536, recall: 0.9124, f1: 0.6891, time: 9.781s
负样本数量： 4447
正样本数量： 6580
TP:  5925
TN:  983
FP:  3464
FN:  655
batch idx: 2, loss: 0.658749 auc: 0.5905, acc: 0.6265, precision: 0.6311, recall: 0.9005, f1: 0.7421, time: 23.241s
负样本数量： 4189
正样本数量： 6171
TP:  5647
TN:  759
FP:  3430
FN:  524
batch idx: 3, loss: 0.665006 auc: 0.5675, acc: 0.6183, precision: 0.6221, recall: 0.9151, f1: 0.7407, time: 15.483s
负样本数量： 4649
正样本数量： 6204
TP:  5508
TN:  1254
FP:  3395
FN:  696
batch idx: 4, loss: 0.662392 auc: 0.6025, acc: 0.6231, precision: 0.6187, recall: 0.8878, f1: 0.7292, time: 24.447s
负样本数量： 4704
正样本数量： 6097
TP:  5644
TN:  1094
FP:  3610
FN:  453
batch idx: 5, loss: 0.662147 auc: 0.6184, acc: 0.6238, precision: 0.6099, recall: 0.9257, f1: 0.7353, time: 21.216s
负样本数量： 4231
正样本数量： 3995
TP:  3504
TN:  1225
FP:  3006
FN:  491
batch idx: 6, loss: 0.688321 auc: 0.6161, acc: 0.5749, precision: 0.5382, recall: 0.8771, f1: 0.6671, time: 18.053s
负样本数量： 4625
正样本数量： 8027
TP:  7046
TN:  1272
FP:  3353
FN:  981
batch idx: 7, loss: 0.639246 auc: 0.6101, acc: 0.6574, precision: 0.6776, recall: 0.8778, f1: 0.7648, time: 29.621s
负样本数量： 4343
正样本数量： 6029
TP:  5378
TN:  1173
FP:  3170
FN:  651
batch idx: 8, loss: 0.655554 auc: 0.6116, acc: 0.6316, precision: 0.6292, recall: 0.8920, f1: 0.7379, time: 17.556s
负样本数量： 4628
正样本数量： 5811
TP:  4995
TN:  1477
FP:  3151
FN:  816
batch idx: 9, loss: 0.663286 auc: 0.6097, acc: 0.6200, precision: 0.6132, recall: 0.8596, f1: 0.7158, time: 24.077s
负样本数量： 5278
正样本数量： 7218
TP:  6252
TN:  1546
FP:  3732
FN:  966
batch idx: 10, loss: 0.658119 auc: 0.6030, acc: 0.6240, precision: 0.6262, recall: 0.8662, f1: 0.7269, time: 20.920s
负样本数量： 4172
正样本数量： 6488
TP:  5536
TN:  1450
FP:  2722
FN:  952
batch idx: 11, loss: 0.643435 auc: 0.6215, acc: 0.6553, precision: 0.6704, recall: 0.8533, f1: 0.7508, time: 22.029s
First attempt - auc_train: 0.5617808648 acc_train: 0.6598884599
负样本数量： 4220
正样本数量： 5859
TP:  4935
TN:  1239
FP:  2981
FN:  924
负样本数量： 5180
正样本数量： 6483
TP:  5236
TN:  1831
FP:  3349
FN:  1247
负样本数量： 3157
正样本数量： 4971
TP:  4384
TN:  853
FP:  2304
FN:  587
负样本数量： 5477
正样本数量： 6660
TP:  5477
TN:  1921
FP:  3556
FN:  1183
First attempt - auc_val: 0.5814353945 acc_val: 0.6125607699
Epoch: 0001 loss_train: 0.6604744891 auc_train: 0.6009984793 acc_train: 0.6244401842 precision_train: 0.6212820455 recall_train: 0.8936045952 f1_train: 0.7320169673 loss_val: 0.6626581699 auc_val: 0.5950792538 acc_val: 0.6180877702 precision_val: 0.6237891598 recall_val: 0.8385580414 f1_val: 0.7153883622 time: 276.1377s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-07-30 11-54-20//checkpoints/best_model.pt
Epoch 0001: val_loss 改善从 0.662658 到 0.662658
负样本数量： 4563
正样本数量： 6477
TP:  5550
TN:  1293
FP:  3270
FN:  927
batch idx: 0, loss: 0.659511 auc: 0.6000, acc: 0.6198, precision: 0.6293, recall: 0.8569, f1: 0.7256, time: 17.402s
负样本数量： 4030
正样本数量： 5040
TP:  4127
TN:  1344
FP:  2686
FN:  913
batch idx: 1, loss: 0.671042 auc: 0.5865, acc: 0.6032, precision: 0.6058, recall: 0.8188, f1: 0.6964, time: 21.389s
负样本数量： 3705
正样本数量： 4778
TP:  4082
TN:  1065
FP:  2640
FN:  696
batch idx: 2, loss: 0.665279 auc: 0.5978, acc: 0.6067, precision: 0.6073, recall: 0.8543, f1: 0.7099, time: 24.745s
负样本数量： 3909
正样本数量： 7714
TP:  6763
TN:  1086
FP:  2823
FN:  951
batch idx: 3, loss: 0.631085 auc: 0.6022, acc: 0.6753, precision: 0.7055, recall: 0.8767, f1: 0.7818, time: 17.267s
负样本数量： 4216
正样本数量： 5913
TP:  5158
TN:  1397
FP:  2819
FN:  755
batch idx: 4, loss: 0.645737 auc: 0.6286, acc: 0.6472, precision: 0.6466, recall: 0.8723, f1: 0.7427, time: 14.752s
负样本数量： 4828
正样本数量： 7710
TP:  6652
TN:  1386
FP:  3442
FN:  1058
batch idx: 5, loss: 0.648893 auc: 0.5972, acc: 0.6411, precision: 0.6590, recall: 0.8628, f1: 0.7472, time: 37.628s
负样本数量： 4995
正样本数量： 6836
TP:  5795
TN:  1833
FP:  3162
FN:  1041
batch idx: 6, loss: 0.645991 auc: 0.6338, acc: 0.6447, precision: 0.6470, recall: 0.8477, f1: 0.7339, time: 21.407s
负样本数量： 3808
正样本数量： 5951
TP:  5235
TN:  989
FP:  2819
FN:  716
batch idx: 7, loss: 0.651775 auc: 0.5902, acc: 0.6378, precision: 0.6500, recall: 0.8797, f1: 0.7476, time: 16.817s
负样本数量： 3973
正样本数量： 5490
TP:  4746
TN:  1201
FP:  2772
FN:  744
batch idx: 8, loss: 0.656254 auc: 0.6082, acc: 0.6284, precision: 0.6313, recall: 0.8645, f1: 0.7297, time: 31.398s
负样本数量： 5305
正样本数量： 6453
TP:  5626
TN:  1623
FP:  3682
FN:  827
batch idx: 9, loss: 0.663584 auc: 0.6166, acc: 0.6165, precision: 0.6044, recall: 0.8718, f1: 0.7139, time: 27.703s
负样本数量： 5639
正样本数量： 7603
TP:  6265
TN:  1872
FP:  3767
FN:  1338
batch idx: 10, loss: 0.665047 auc: 0.5948, acc: 0.6145, precision: 0.6245, recall: 0.8240, f1: 0.7105, time: 23.828s
负样本数量： 5826
正样本数量： 5901
TP:  4987
TN:  1865
FP:  3961
FN:  914
batch idx: 11, loss: 0.681085 auc: 0.6153, acc: 0.5843, precision: 0.5573, recall: 0.8451, f1: 0.6717, time: 26.531s
First attempt - auc_train: 0.6000352365 acc_train: 0.6198369565
负样本数量： 5102
正样本数量： 6788
TP:  5881
TN:  1388
FP:  3714
FN:  907
负样本数量： 4099
正样本数量： 5552
TP:  4784
TN:  1184
FP:  2915
FN:  768
负样本数量： 4160
正样本数量： 5688
TP:  4678
TN:  1604
FP:  2556
FN:  1010
负样本数量： 4673
正样本数量： 5945
TP:  4948
TN:  1621
FP:  3052
FN:  997
First attempt - auc_val: 0.5897475385 acc_val: 0.6113540791
Epoch: 0002 loss_train: 0.6571068615 auc_train: 0.6059399350 acc_train: 0.6266314210 precision_train: 0.6306582660 recall_train: 0.8562267975 f1_train: 0.7259159837 loss_val: 0.6619512439 auc_val: 0.6018755995 acc_val: 0.6215745072 precision_val: 0.6248678268 recall_val: 0.8456956400 f1_val: 0.7184199002 time: 318.8278s
Best model so far, saving...
Epoch 0002: val_loss 没有改善 0.661951，最佳值 0.662658，等待 1/15
负样本数量： 6486
正样本数量： 8933
TP:  7307
TN:  2425
FP:  4061
FN:  1626
batch idx: 0, loss: 0.654570 auc: 0.6162, acc: 0.6312, precision: 0.6428, recall: 0.8180, f1: 0.7199, time: 13.019s
负样本数量： 3712
正样本数量： 5983
TP:  5369
TN:  860
FP:  2852
FN:  614
batch idx: 1, loss: 0.645209 auc: 0.6018, acc: 0.6425, precision: 0.6531, recall: 0.8974, f1: 0.7560, time: 12.030s
负样本数量： 3878
正样本数量： 5760
TP:  4787
TN:  1444
FP:  2434
FN:  973
batch idx: 2, loss: 0.645073 auc: 0.6280, acc: 0.6465, precision: 0.6629, recall: 0.8311, f1: 0.7375, time: 23.929s
负样本数量： 4651
正样本数量： 7085
TP:  6070
TN:  1622
FP:  3029
FN:  1015
batch idx: 3, loss: 0.638586 auc: 0.6314, acc: 0.6554, precision: 0.6671, recall: 0.8567, f1: 0.7501, time: 23.430s
负样本数量： 5126
正样本数量： 6056
TP:  5366
TN:  1429
FP:  3697
FN:  690
batch idx: 4, loss: 0.668350 auc: 0.6166, acc: 0.6077, precision: 0.5921, recall: 0.8861, f1: 0.7098, time: 23.406s
负样本数量： 4053
正样本数量： 5413
TP:  4645
TN:  1214
FP:  2839
FN:  768
batch idx: 5, loss: 0.660074 auc: 0.6078, acc: 0.6190, precision: 0.6207, recall: 0.8581, f1: 0.7203, time: 20.151s
负样本数量： 5375
正样本数量： 7087
TP:  6280
TN:  1281
FP:  4094
FN:  807
batch idx: 6, loss: 0.667612 auc: 0.5960, acc: 0.6067, precision: 0.6054, recall: 0.8861, f1: 0.7193, time: 24.787s
负样本数量： 4370
正样本数量： 4845
TP:  4175
TN:  1459
FP:  2911
FN:  670
batch idx: 7, loss: 0.664460 auc: 0.6300, acc: 0.6114, precision: 0.5892, recall: 0.8617, f1: 0.6999, time: 22.924s
负样本数量： 3654
正样本数量： 5876
TP:  5104
TN:  1250
FP:  2404
FN:  772
batch idx: 8, loss: 0.634990 auc: 0.6301, acc: 0.6667, precision: 0.6798, recall: 0.8686, f1: 0.7627, time: 16.777s
负样本数量： 4706
正样本数量： 5571
TP:  4835
TN:  1370
FP:  3336
FN:  736
batch idx: 9, loss: 0.668151 auc: 0.6110, acc: 0.6038, precision: 0.5917, recall: 0.8679, f1: 0.7037, time: 27.740s
负样本数量： 4457
正样本数量： 6244
TP:  5431
TN:  1282
FP:  3175
FN:  813
batch idx: 10, loss: 0.655502 auc: 0.6080, acc: 0.6273, precision: 0.6311, recall: 0.8698, f1: 0.7314, time: 21.994s
负样本数量： 4329
正样本数量： 7013
TP:  6164
TN:  1135
FP:  3194
FN:  849
batch idx: 11, loss: 0.647735 auc: 0.6092, acc: 0.6435, precision: 0.6587, recall: 0.8789, f1: 0.7530, time: 33.389s
First attempt - auc_train: 0.6162449574 acc_train: 0.6311693365
负样本数量： 4531
正样本数量： 6065
TP:  4981
TN:  1524
FP:  3007
FN:  1084
负样本数量： 4240
正样本数量： 5921
TP:  5151
TN:  1201
FP:  3039
FN:  770
负样本数量： 3727
正样本数量： 5466
TP:  4707
TN:  1201
FP:  2526
FN:  759
负样本数量： 5536
正样本数量： 6521
TP:  5434
TN:  1939
FP:  3597
FN:  1087
First attempt - auc_val: 0.5906401863 acc_val: 0.6139109098
Epoch: 0003 loss_train: 0.6541926414 auc_train: 0.6155112098 acc_train: 0.6301421662 precision_train: 0.6328721099 recall_train: 0.8650362540 f1_train: 0.7303097179 loss_val: 0.6597275138 auc_val: 0.6049888707 acc_val: 0.6233052779 precision_val: 0.6262426559 recall_val: 0.8464183392 f1_val: 0.7197729023 time: 291.5295s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-07-30 11-54-20//checkpoints/best_model.pt
Epoch 0003: val_loss 改善从 0.659728 到 0.659728
负样本数量： 5921
正样本数量： 5904
TP:  4806
TN:  2271
FP:  3650
FN:  1098
batch idx: 0, loss: 0.668034 auc: 0.6280, acc: 0.5985, precision: 0.5684, recall: 0.8140, f1: 0.6694, time: 22.286s
负样本数量： 3700
正样本数量： 5655
TP:  4758
TN:  1329
FP:  2371
FN:  897
batch idx: 1, loss: 0.644358 auc: 0.6304, acc: 0.6507, precision: 0.6674, recall: 0.8414, f1: 0.7444, time: 17.477s
负样本数量： 4419
正样本数量： 6260
TP:  5322
TN:  1619
FP:  2800
FN:  938
batch idx: 2, loss: 0.643092 auc: 0.6416, acc: 0.6500, precision: 0.6553, recall: 0.8502, f1: 0.7401, time: 22.229s
负样本数量： 3611
正样本数量： 5452
TP:  4537
TN:  1101
FP:  2510
FN:  915
batch idx: 3, loss: 0.660861 auc: 0.5868, acc: 0.6221, precision: 0.6438, recall: 0.8322, f1: 0.7260, time: 22.198s
负样本数量： 4202
正样本数量： 6816
TP:  6204
TN:  901
FP:  3301
FN:  612
batch idx: 4, loss: 0.646614 auc: 0.6072, acc: 0.6449, precision: 0.6527, recall: 0.9102, f1: 0.7602, time: 21.271s
负样本数量： 4562
正样本数量： 5702
TP:  5118
TN:  1003
FP:  3559
FN:  584
batch idx: 5, loss: 0.670047 auc: 0.6037, acc: 0.5964, precision: 0.5898, recall: 0.8976, f1: 0.7119, time: 19.184s
负样本数量： 5586
正样本数量： 7668
TP:  6593
TN:  1793
FP:  3793
FN:  1075
batch idx: 6, loss: 0.651455 auc: 0.6255, acc: 0.6327, precision: 0.6348, recall: 0.8598, f1: 0.7304, time: 22.079s
负样本数量： 4794
正样本数量： 7989
TP:  7088
TN:  1424
FP:  3370
FN:  901
batch idx: 7, loss: 0.635948 auc: 0.6258, acc: 0.6659, precision: 0.6778, recall: 0.8872, f1: 0.7685, time: 16.324s
负样本数量： 4332
正样本数量： 5817
TP:  5067
TN:  1288
FP:  3044
FN:  750
batch idx: 8, loss: 0.657142 auc: 0.6100, acc: 0.6262, precision: 0.6247, recall: 0.8711, f1: 0.7276, time: 22.606s
负样本数量： 4620
正样本数量： 6079
TP:  5321
TN:  1296
FP:  3324
FN:  758
batch idx: 9, loss: 0.659907 auc: 0.6104, acc: 0.6185, precision: 0.6155, recall: 0.8753, f1: 0.7228, time: 26.710s
负样本数量： 3962
正样本数量： 6383
TP:  5611
TN:  1058
FP:  2904
FN:  772
batch idx: 10, loss: 0.646294 auc: 0.6098, acc: 0.6447, precision: 0.6590, recall: 0.8791, f1: 0.7533, time: 28.165s
负样本数量： 5088
正样本数量： 6141
TP:  5056
TN:  1782
FP:  3306
FN:  1085
batch idx: 11, loss: 0.664639 auc: 0.6134, acc: 0.6090, precision: 0.6046, recall: 0.8233, f1: 0.6972, time: 26.035s
First attempt - auc_train: 0.6279689123 acc_train: 0.5984778013
负样本数量： 2986
正样本数量： 4634
TP:  4046
TN:  891
FP:  2095
FN:  588
负样本数量： 4420
正样本数量： 5219
TP:  4241
TN:  1584
FP:  2836
FN:  978
负样本数量： 5927
正样本数量： 7673
TP:  6530
TN:  1817
FP:  4110
FN:  1143
负样本数量： 4701
正样本数量： 6447
TP:  5535
TN:  1480
FP:  3221
FN:  912
First attempt - auc_val: 0.6166938664 acc_val: 0.6479002625
Epoch: 0004 loss_train: 0.6540324291 auc_train: 0.6160580376 acc_train: 0.6299391099 precision_train: 0.6328123417 recall_train: 0.8617751267 f1_train: 0.7293006353 loss_val: 0.6585218012 auc_val: 0.6092703116 acc_val: 0.6238067292 precision_val: 0.6259938356 recall_val: 0.8488236294 f1_val: 0.7205289643 time: 297.3208s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-07-30 11-54-20//checkpoints/best_model.pt
Epoch 0004: val_loss 改善从 0.658522 到 0.658522
负样本数量： 5150
正样本数量： 6710
TP:  5856
TN:  1452
FP:  3698
FN:  854
batch idx: 0, loss: 0.662322 auc: 0.6065, acc: 0.6162, precision: 0.6129, recall: 0.8727, f1: 0.7201, time: 8.022s
负样本数量： 5218
正样本数量： 6691
TP:  6009
TN:  1293
FP:  3925
FN:  682
batch idx: 1, loss: 0.662602 auc: 0.6178, acc: 0.6131, precision: 0.6049, recall: 0.8981, f1: 0.7229, time: 16.198s
负样本数量： 3075
正样本数量： 5383
TP:  4878
TN:  681
FP:  2394
FN:  505
batch idx: 2, loss: 0.638688 auc: 0.6003, acc: 0.6572, precision: 0.6708, recall: 0.9062, f1: 0.7709, time: 21.839s
负样本数量： 5469
正样本数量： 6563
TP:  5657
TN:  1628
FP:  3841
FN:  906
batch idx: 3, loss: 0.667822 auc: 0.6086, acc: 0.6055, precision: 0.5956, recall: 0.8620, f1: 0.7044, time: 23.639s
负样本数量： 5722
正样本数量： 7358
TP:  6133
TN:  1702
FP:  4020
FN:  1225
batch idx: 4, loss: 0.669935 auc: 0.5890, acc: 0.5990, precision: 0.6041, recall: 0.8335, f1: 0.7005, time: 24.827s
负样本数量： 3978
正样本数量： 6230
TP:  5344
TN:  1332
FP:  2646
FN:  886
batch idx: 5, loss: 0.639080 auc: 0.6318, acc: 0.6540, precision: 0.6688, recall: 0.8578, f1: 0.7516, time: 30.964s
负样本数量： 5212
正样本数量： 6773
TP:  5783
TN:  1826
FP:  3386
FN:  990
batch idx: 6, loss: 0.646518 auc: 0.6504, acc: 0.6349, precision: 0.6307, recall: 0.8538, f1: 0.7255, time: 10.352s
负样本数量： 4727
正样本数量： 7183
TP:  6274
TN:  1513
FP:  3214
FN:  909
batch idx: 7, loss: 0.638352 auc: 0.6390, acc: 0.6538, precision: 0.6613, recall: 0.8735, f1: 0.7527, time: 23.784s
负样本数量： 4339
正样本数量： 5607
TP:  4753
TN:  1397
FP:  2942
FN:  854
batch idx: 8, loss: 0.657705 auc: 0.6215, acc: 0.6183, precision: 0.6177, recall: 0.8477, f1: 0.7146, time: 23.906s
负样本数量： 3682
正样本数量： 4937
TP:  4432
TN:  950
FP:  2732
FN:  505
batch idx: 9, loss: 0.653632 auc: 0.6287, acc: 0.6244, precision: 0.6186, recall: 0.8977, f1: 0.7325, time: 16.863s
负样本数量： 4866
正样本数量： 6932
TP:  5723
TN:  1677
FP:  3189
FN:  1209
batch idx: 10, loss: 0.655413 auc: 0.6121, acc: 0.6272, precision: 0.6422, recall: 0.8256, f1: 0.7224, time: 32.580s
负样本数量： 3359
正样本数量： 5499
TP:  4833
TN:  1117
FP:  2242
FN:  666
batch idx: 11, loss: 0.629316 auc: 0.6470, acc: 0.6717, precision: 0.6831, recall: 0.8789, f1: 0.7687, time: 27.121s
First attempt - auc_train: 0.6064990378 acc_train: 0.6161888702
负样本数量： 4035
正样本数量： 5653
TP:  4734
TN:  1394
FP:  2641
FN:  919
负样本数量： 3846
正样本数量： 5298
TP:  4610
TN:  1134
FP:  2712
FN:  688
负样本数量： 5848
正样本数量： 7023
TP:  5930
TN:  1792
FP:  4056
FN:  1093
负样本数量： 4305
正样本数量： 5999
TP:  5123
TN:  1368
FP:  2937
FN:  876
First attempt - auc_val: 0.6158198945 acc_val: 0.6325350950
Epoch: 0005 loss_train: 0.6517821501 auc_train: 0.6210609103 acc_train: 0.6312885590 precision_train: 0.6342235762 recall_train: 0.8672834126 f1_train: 0.7322436996 loss_val: 0.6580634862 auc_val: 0.6115213374 acc_val: 0.6226523728 precision_val: 0.6252367514 recall_val: 0.8514788234 f1_val: 0.7208481287 time: 307.4325s
Best model so far, saving...
Epoch 0005: val_loss 没有改善 0.658063，最佳值 0.658522，等待 1/15
负样本数量： 4572
正样本数量： 7188
TP:  6271
TN:  1269
FP:  3303
FN:  917
batch idx: 0, loss: 0.645900 auc: 0.6161, acc: 0.6412, precision: 0.6550, recall: 0.8724, f1: 0.7482, time: 9.326s
负样本数量： 5118
正样本数量： 5653
TP:  4907
TN:  1575
FP:  3543
FN:  746
batch idx: 1, loss: 0.667401 auc: 0.6304, acc: 0.6018, precision: 0.5807, recall: 0.8680, f1: 0.6959, time: 14.461s
负样本数量： 4916
正样本数量： 6177
TP:  5391
TN:  1274
FP:  3642
FN:  786
batch idx: 2, loss: 0.667804 auc: 0.6093, acc: 0.6008, precision: 0.5968, recall: 0.8728, f1: 0.7089, time: 16.721s
负样本数量： 3512
正样本数量： 6789
TP:  6092
TN:  904
FP:  2608
FN:  697
batch idx: 3, loss: 0.624127 auc: 0.6196, acc: 0.6792, precision: 0.7002, recall: 0.8973, f1: 0.7866, time: 23.666s
负样本数量： 6057
正样本数量： 7269
TP:  5982
TN:  2292
FP:  3765
FN:  1287
batch idx: 4, loss: 0.658978 auc: 0.6287, acc: 0.6209, precision: 0.6137, recall: 0.8229, f1: 0.7031, time: 29.247s
负样本数量： 4489
正样本数量： 6201
TP:  5428
TN:  1267
FP:  3222
FN:  773
batch idx: 5, loss: 0.654051 auc: 0.6174, acc: 0.6263, precision: 0.6275, recall: 0.8753, f1: 0.7310, time: 21.197s
负样本数量： 4383
正样本数量： 5818
TP:  5079
TN:  1247
FP:  3136
FN:  739
batch idx: 6, loss: 0.655147 auc: 0.6264, acc: 0.6201, precision: 0.6183, recall: 0.8730, f1: 0.7239, time: 17.727s
负样本数量： 4292
正样本数量： 5597
TP:  4897
TN:  1220
FP:  3072
FN:  700
batch idx: 7, loss: 0.658437 auc: 0.6233, acc: 0.6186, precision: 0.6145, recall: 0.8749, f1: 0.7220, time: 28.293s
负样本数量： 3933
正样本数量： 6326
TP:  5526
TN:  1117
FP:  2816
FN:  800
batch idx: 8, loss: 0.643565 auc: 0.6052, acc: 0.6475, precision: 0.6624, recall: 0.8735, f1: 0.7535, time: 23.525s
负样本数量： 4237
正样本数量： 6111
TP:  5339
TN:  1210
FP:  3027
FN:  772
batch idx: 9, loss: 0.650911 auc: 0.6201, acc: 0.6329, precision: 0.6382, recall: 0.8737, f1: 0.7376, time: 23.341s
负样本数量： 4158
正样本数量： 6977
TP:  5922
TN:  1300
FP:  2858
FN:  1055
batch idx: 10, loss: 0.641005 auc: 0.6186, acc: 0.6486, precision: 0.6745, recall: 0.8488, f1: 0.7517, time: 32.637s
负样本数量： 5130
正样本数量： 5760
TP:  5009
TN:  1704
FP:  3426
FN:  751
batch idx: 11, loss: 0.659729 auc: 0.6404, acc: 0.6164, precision: 0.5938, recall: 0.8696, f1: 0.7057, time: 27.707s
First attempt - auc_train: 0.6161410933 acc_train: 0.6411564626
负样本数量： 4688
正样本数量： 5756
TP:  4792
TN:  1672
FP:  3016
FN:  964
负样本数量： 4111
正样本数量： 5683
TP:  4998
TN:  983
FP:  3128
FN:  685
负样本数量： 4096
正样本数量： 5412
TP:  4647
TN:  1083
FP:  3013
FN:  765
负样本数量： 5139
正样本数量： 7122
TP:  5991
TN:  1909
FP:  3230
FN:  1131
First attempt - auc_val: 0.6238178050 acc_val: 0.6189199540
Epoch: 0006 loss_train: 0.6522546907 auc_train: 0.6212899679 acc_train: 0.6295209142 precision_train: 0.6313078423 recall_train: 0.8685305517 f1_train: 0.7306667997 loss_val: 0.6600793004 auc_val: 0.6090809176 acc_val: 0.6191424371 precision_val: 0.6212907114 recall_val: 0.8529578499 f1_val: 0.7186488009 time: 300.3378s
Epoch 0006: val_loss 没有改善 0.660079，最佳值 0.658522，等待 2/15
负样本数量： 4696
正样本数量： 6455
TP:  5356
TN:  1804
FP:  2892
FN:  1099
batch idx: 0, loss: 0.642789 auc: 0.6470, acc: 0.6421, precision: 0.6494, recall: 0.8297, f1: 0.7286, time: 20.522s
负样本数量： 5444
正样本数量： 6714
TP:  5885
TN:  1469
FP:  3975
FN:  829
batch idx: 1, loss: 0.665756 auc: 0.6201, acc: 0.6049, precision: 0.5969, recall: 0.8765, f1: 0.7101, time: 21.904s
负样本数量： 4496
正样本数量： 5950
TP:  5307
TN:  1158
FP:  3338
FN:  643
batch idx: 2, loss: 0.659251 auc: 0.6172, acc: 0.6189, precision: 0.6139, recall: 0.8919, f1: 0.7272, time: 16.822s
负样本数量： 3114
正样本数量： 4119
TP:  3662
TN:  784
FP:  2330
FN:  457
batch idx: 3, loss: 0.662108 auc: 0.6123, acc: 0.6147, precision: 0.6111, recall: 0.8891, f1: 0.7244, time: 15.430s
负样本数量： 5355
正样本数量： 6460
TP:  5338
TN:  1815
FP:  3540
FN:  1122
batch idx: 4, loss: 0.664308 auc: 0.6256, acc: 0.6054, precision: 0.6013, recall: 0.8263, f1: 0.6960, time: 17.337s
负样本数量： 4305
正样本数量： 5959
TP:  5309
TN:  1134
FP:  3171
FN:  650
batch idx: 5, loss: 0.651315 auc: 0.6270, acc: 0.6277, precision: 0.6261, recall: 0.8909, f1: 0.7354, time: 18.686s
负样本数量： 3547
正样本数量： 5445
TP:  4772
TN:  1114
FP:  2433
FN:  673
batch idx: 6, loss: 0.639296 auc: 0.6290, acc: 0.6546, precision: 0.6623, recall: 0.8764, f1: 0.7545, time: 28.111s
负样本数量： 4760
正样本数量： 6979
TP:  6057
TN:  1347
FP:  3413
FN:  922
batch idx: 7, loss: 0.650329 auc: 0.6192, acc: 0.6307, precision: 0.6396, recall: 0.8679, f1: 0.7365, time: 16.375s
负样本数量： 4548
正样本数量： 6818
TP:  5924
TN:  1278
FP:  3270
FN:  894
batch idx: 8, loss: 0.649706 auc: 0.6161, acc: 0.6336, precision: 0.6443, recall: 0.8689, f1: 0.7399, time: 23.110s
负样本数量： 5992
正样本数量： 7490
TP:  6249
TN:  2296
FP:  3696
FN:  1241
batch idx: 9, loss: 0.652069 auc: 0.6383, acc: 0.6338, precision: 0.6284, recall: 0.8343, f1: 0.7168, time: 26.592s
负样本数量： 5472
正样本数量： 7931
TP:  7020
TN:  1431
FP:  4041
FN:  911
batch idx: 10, loss: 0.652572 auc: 0.6088, acc: 0.6305, precision: 0.6347, recall: 0.8851, f1: 0.7393, time: 20.648s
负样本数量： 3068
正样本数量： 5546
TP:  4924
TN:  817
FP:  2251
FN:  622
batch idx: 11, loss: 0.632580 auc: 0.6207, acc: 0.6665, precision: 0.6863, recall: 0.8878, f1: 0.7742, time: 15.182s
First attempt - auc_train: 0.6470476052 acc_train: 0.6420948794
负样本数量： 4406
正样本数量： 5610
TP:  4599
TN:  1598
FP:  2808
FN:  1011
负样本数量： 5402
正样本数量： 7184
TP:  6107
TN:  1669
FP:  3733
FN:  1077
负样本数量： 3775
正样本数量： 4640
TP:  3995
TN:  1275
FP:  2500
FN:  645
负样本数量： 4451
正样本数量： 6539
TP:  5697
TN:  1171
FP:  3280
FN:  842
First attempt - auc_val: 0.6171894508 acc_val: 0.6187100639
Epoch: 0007 loss_train: 0.6518398970 auc_train: 0.6234365895 acc_train: 0.6302870574 precision_train: 0.6328431115 recall_train: 0.8687459744 f1_train: 0.7319029877 loss_val: 0.6582303345 auc_val: 0.6141958732 acc_val: 0.6219334451 precision_val: 0.6228098929 recall_val: 0.8505237820 f1_val: 0.7189920333 time: 276.3595s
Epoch 0007: val_loss 没有改善 0.658230，最佳值 0.658522，等待 3/15
负样本数量： 4742
正样本数量： 7945
TP:  6841
TN:  1387
FP:  3355
FN:  1104
batch idx: 0, loss: 0.643158 auc: 0.6151, acc: 0.6485, precision: 0.6709, recall: 0.8610, f1: 0.7542, time: 15.504s
负样本数量： 4063
正样本数量： 5685
TP:  5069
TN:  1040
FP:  3023
FN:  616
batch idx: 1, loss: 0.652276 auc: 0.6177, acc: 0.6267, precision: 0.6264, recall: 0.8916, f1: 0.7359, time: 15.306s
负样本数量： 4713
正样本数量： 5706
TP:  4941
TN:  1392
FP:  3321
FN:  765
batch idx: 2, loss: 0.663706 auc: 0.6200, acc: 0.6078, precision: 0.5980, recall: 0.8659, f1: 0.7075, time: 17.021s
负样本数量： 5078
正样本数量： 6745
TP:  5546
TN:  1927
FP:  3151
FN:  1199
batch idx: 3, loss: 0.650558 auc: 0.6338, acc: 0.6321, precision: 0.6377, recall: 0.8222, f1: 0.7183, time: 30.562s
负样本数量： 5085
正样本数量： 6164
TP:  5116
TN:  1783
FP:  3302
FN:  1048
batch idx: 4, loss: 0.661324 auc: 0.6213, acc: 0.6133, precision: 0.6077, recall: 0.8300, f1: 0.7017, time: 27.482s
负样本数量： 5102
正样本数量： 6112
TP:  5302
TN:  1717
FP:  3385
FN:  810
batch idx: 5, loss: 0.654050 auc: 0.6421, acc: 0.6259, precision: 0.6103, recall: 0.8675, f1: 0.7165, time: 22.375s
负样本数量： 4717
正样本数量： 6194
TP:  5181
TN:  1593
FP:  3124
FN:  1013
batch idx: 6, loss: 0.654657 auc: 0.6290, acc: 0.6208, precision: 0.6238, recall: 0.8365, f1: 0.7147, time: 23.253s
负样本数量： 3902
正样本数量： 5503
TP:  4880
TN:  1057
FP:  2845
FN:  623
batch idx: 7, loss: 0.649369 auc: 0.6313, acc: 0.6313, precision: 0.6317, recall: 0.8868, f1: 0.7378, time: 14.708s
负样本数量： 3809
正样本数量： 5157
TP:  4725
TN:  838
FP:  2971
FN:  432
batch idx: 8, loss: 0.658152 auc: 0.6150, acc: 0.6205, precision: 0.6140, recall: 0.9162, f1: 0.7352, time: 27.692s
负样本数量： 4045
正样本数量： 7182
TP:  6497
TN:  941
FP:  3104
FN:  685
batch idx: 9, loss: 0.633408 auc: 0.6188, acc: 0.6625, precision: 0.6767, recall: 0.9046, f1: 0.7742, time: 23.525s
负样本数量： 5038
正样本数量： 6408
TP:  5606
TN:  1410
FP:  3628
FN:  802
batch idx: 10, loss: 0.660544 auc: 0.6193, acc: 0.6130, precision: 0.6071, recall: 0.8748, f1: 0.7168, time: 28.930s
负样本数量： 4503
正样本数量： 7065
TP:  6166
TN:  1282
FP:  3221
FN:  899
batch idx: 11, loss: 0.643992 auc: 0.6214, acc: 0.6438, precision: 0.6569, recall: 0.8728, f1: 0.7496, time: 28.889s
First attempt - auc_train: 0.6151425912 acc_train: 0.6485378734
负样本数量： 4619
正样本数量： 5980
TP:  5109
TN:  1365
FP:  3254
FN:  871
负样本数量： 4681
正样本数量： 5908
TP:  4960
TN:  1619
FP:  3062
FN:  948
负样本数量： 4077
正样本数量： 5701
TP:  4936
TN:  1257
FP:  2820
FN:  765
负样本数量： 4657
正样本数量： 6384
TP:  5431
TN:  1399
FP:  3258
FN:  953
First attempt - auc_val: 0.6135666373 acc_val: 0.6108123408
Epoch: 0008 loss_train: 0.6520994902 auc_train: 0.6237379949 acc_train: 0.6288520966 precision_train: 0.6301137908 recall_train: 0.8691672212 f1_train: 0.7301998673 loss_val: 0.6580234468 auc_val: 0.6156131933 acc_val: 0.6210203654 precision_val: 0.6226646331 recall_val: 0.8526052500 f1_val: 0.7196893838 time: 312.0270s
Best model so far, saving...
Epoch 0008: val_loss 没有改善 0.658023，最佳值 0.658522，等待 4/15
负样本数量： 5368
正样本数量： 7153
TP:  6186
TN:  1584
FP:  3784
FN:  967
batch idx: 0, loss: 0.656064 auc: 0.6166, acc: 0.6206, precision: 0.6205, recall: 0.8648, f1: 0.7225, time: 15.319s
负样本数量： 3971
正样本数量： 6544
TP:  5831
TN:  1203
FP:  2768
FN:  713
batch idx: 1, loss: 0.628752 auc: 0.6479, acc: 0.6689, precision: 0.6781, recall: 0.8910, f1: 0.7701, time: 12.123s
负样本数量： 4983
正样本数量： 6564
TP:  5760
TN:  1392
FP:  3591
FN:  804
batch idx: 2, loss: 0.658173 auc: 0.6252, acc: 0.6194, precision: 0.6160, recall: 0.8775, f1: 0.7238, time: 15.339s
负样本数量： 4687
正样本数量： 6998
TP:  6145
TN:  1390
FP:  3297
FN:  853
batch idx: 3, loss: 0.643375 auc: 0.6314, acc: 0.6448, precision: 0.6508, recall: 0.8781, f1: 0.7476, time: 16.530s
负样本数量： 4686
正样本数量： 5479
TP:  4666
TN:  1544
FP:  3142
FN:  813
batch idx: 4, loss: 0.662392 auc: 0.6296, acc: 0.6109, precision: 0.5976, recall: 0.8516, f1: 0.7023, time: 27.822s
负样本数量： 3848
正样本数量： 5314
TP:  4671
TN:  1219
FP:  2629
FN:  643
batch idx: 5, loss: 0.641456 auc: 0.6491, acc: 0.6429, precision: 0.6399, recall: 0.8790, f1: 0.7406, time: 15.827s
负样本数量： 4527
正样本数量： 5359
TP:  4561
TN:  1434
FP:  3093
FN:  798
batch idx: 6, loss: 0.661602 auc: 0.6221, acc: 0.6064, precision: 0.5959, recall: 0.8511, f1: 0.7010, time: 21.472s
负样本数量： 3661
正样本数量： 4882
TP:  4254
TN:  1143
FP:  2518
FN:  628
batch idx: 7, loss: 0.650859 auc: 0.6301, acc: 0.6317, precision: 0.6282, recall: 0.8714, f1: 0.7300, time: 16.638s
负样本数量： 4840
正样本数量： 6709
TP:  5984
TN:  1127
FP:  3713
FN:  725
batch idx: 8, loss: 0.658873 auc: 0.6142, acc: 0.6157, precision: 0.6171, recall: 0.8919, f1: 0.7295, time: 22.789s
负样本数量： 3788
正样本数量： 6238
TP:  5137
TN:  1298
FP:  2490
FN:  1101
batch idx: 9, loss: 0.643010 auc: 0.6238, acc: 0.6418, precision: 0.6735, recall: 0.8235, f1: 0.7410, time: 25.434s
负样本数量： 4197
正样本数量： 5596
TP:  4809
TN:  1234
FP:  2963
FN:  787
batch idx: 10, loss: 0.659401 auc: 0.6173, acc: 0.6171, precision: 0.6188, recall: 0.8594, f1: 0.7195, time: 22.671s
负样本数量： 6241
正样本数量： 9030
TP:  7908
TN:  1740
FP:  4501
FN:  1122
batch idx: 11, loss: 0.651692 auc: 0.6163, acc: 0.6318, precision: 0.6373, recall: 0.8757, f1: 0.7377, time: 30.840s
First attempt - auc_train: 0.6166128617 acc_train: 0.6205574635
负样本数量： 5173
正样本数量： 6667
TP:  5641
TN:  1587
FP:  3586
FN:  1026
负样本数量： 4705
正样本数量： 6314
TP:  5383
TN:  1471
FP:  3234
FN:  931
负样本数量： 4572
正样本数量： 6186
TP:  5217
TN:  1570
FP:  3002
FN:  969
负样本数量： 3584
正样本数量： 4806
TP:  4212
TN:  1015
FP:  2569
FN:  594
First attempt - auc_val: 0.6038545260 acc_val: 0.6104729730
Epoch: 0009 loss_train: 0.6513040711 auc_train: 0.6269681055 acc_train: 0.6293414763 precision_train: 0.6311290750 recall_train: 0.8679247962 f1_train: 0.7304794623 loss_val: 0.6578470469 auc_val: 0.6159144111 acc_val: 0.6215931028 precision_val: 0.6229873543 recall_val: 0.8546045108 f1_val: 0.7205578159 time: 274.3299s
Best model so far, saving...
Epoch 0009: val_loss 没有改善 0.657847，最佳值 0.658522，等待 5/15
负样本数量： 3886
正样本数量： 4821
TP:  4188
TN:  1067
FP:  2819
FN:  633
batch idx: 0, loss: 0.663533 auc: 0.6253, acc: 0.6035, precision: 0.5977, recall: 0.8687, f1: 0.7082, time: 10.461s
负样本数量： 4609
正样本数量： 6801
TP:  5984
TN:  1281
FP:  3328
FN:  817
batch idx: 1, loss: 0.649534 auc: 0.6171, acc: 0.6367, precision: 0.6426, recall: 0.8799, f1: 0.7428, time: 17.786s
负样本数量： 3506
正样本数量： 6197
TP:  5568
TN:  936
FP:  2570
FN:  629
batch idx: 2, loss: 0.629384 auc: 0.6179, acc: 0.6703, precision: 0.6842, recall: 0.8985, f1: 0.7768, time: 19.023s
负样本数量： 4530
正样本数量： 6715
TP:  5901
TN:  1231
FP:  3299
FN:  814
batch idx: 3, loss: 0.647495 auc: 0.6263, acc: 0.6342, precision: 0.6414, recall: 0.8788, f1: 0.7416, time: 17.245s
负样本数量： 5622
正样本数量： 7615
TP:  6498
TN:  1831
FP:  3791
FN:  1117
batch idx: 4, loss: 0.652038 auc: 0.6340, acc: 0.6292, precision: 0.6315, recall: 0.8533, f1: 0.7259, time: 21.181s
负样本数量： 4293
正样本数量： 6721
TP:  5956
TN:  1084
FP:  3209
FN:  765
batch idx: 5, loss: 0.647203 auc: 0.6167, acc: 0.6392, precision: 0.6499, recall: 0.8862, f1: 0.7498, time: 24.341s
负样本数量： 4003
正样本数量： 5016
TP:  4401
TN:  1195
FP:  2808
FN:  615
batch idx: 6, loss: 0.661310 auc: 0.6169, acc: 0.6205, precision: 0.6105, recall: 0.8774, f1: 0.7200, time: 14.308s
负样本数量： 4639
正样本数量： 6278
TP:  5324
TN:  1574
FP:  3065
FN:  954
batch idx: 7, loss: 0.651700 auc: 0.6327, acc: 0.6319, precision: 0.6346, recall: 0.8480, f1: 0.7260, time: 15.326s
负样本数量： 3646
正样本数量： 4379
TP:  3738
TN:  1185
FP:  2461
FN:  641
batch idx: 8, loss: 0.657220 auc: 0.6388, acc: 0.6135, precision: 0.6030, recall: 0.8536, f1: 0.7067, time: 16.697s
负样本数量： 4824
正样本数量： 7074
TP:  6259
TN:  1448
FP:  3376
FN:  815
batch idx: 9, loss: 0.641709 auc: 0.6298, acc: 0.6478, precision: 0.6496, recall: 0.8848, f1: 0.7492, time: 21.125s
负样本数量： 6568
正样本数量： 7599
TP:  6489
TN:  2117
FP:  4451
FN:  1110
batch idx: 10, loss: 0.662165 auc: 0.6272, acc: 0.6075, precision: 0.5931, recall: 0.8539, f1: 0.7000, time: 23.813s
负样本数量： 4671
正样本数量： 6650
TP:  5646
TN:  1393
FP:  3278
FN:  1004
batch idx: 11, loss: 0.654363 auc: 0.6191, acc: 0.6218, precision: 0.6327, recall: 0.8490, f1: 0.7251, time: 23.034s
First attempt - auc_train: 0.6252932439 acc_train: 0.6035373837
负样本数量： 4370
正样本数量： 5216
TP:  4563
TN:  1097
FP:  3273
FN:  653
负样本数量： 5234
正样本数量： 7203
TP:  6040
TN:  1853
FP:  3381
FN:  1163
负样本数量： 4297
正样本数量： 5098
TP:  4145
TN:  1619
FP:  2678
FN:  953
负样本数量： 4133
正样本数量： 6456
TP:  5716
TN:  1066
FP:  3067
FN:  740
First attempt - auc_val: 0.5946008629 acc_val: 0.5904443981
Epoch: 0010 loss_train: 0.6514712224 auc_train: 0.6251414298 acc_train: 0.6296655018 precision_train: 0.6309067780 recall_train: 0.8693445329 f1_train: 0.7310021368 loss_val: 0.6591988802 auc_val: 0.6148548350 acc_val: 0.6197691927 precision_val: 0.6204350055 recall_val: 0.8529474173 f1_val: 0.7178638386 time: 260.0487s
Epoch 0010: val_loss 没有改善 0.659199，最佳值 0.658522，等待 6/15
负样本数量： 3948
正样本数量： 5272
TP:  4734
TN:  935
FP:  3013
FN:  538
batch idx: 0, loss: 0.660352 auc: 0.6152, acc: 0.6149, precision: 0.6111, recall: 0.8980, f1: 0.7272, time: 9.133s
负样本数量： 4907
正样本数量： 6712
TP:  5745
TN:  1446
FP:  3461
FN:  967
batch idx: 1, loss: 0.654458 auc: 0.6288, acc: 0.6189, precision: 0.6240, recall: 0.8559, f1: 0.7218, time: 23.275s
负样本数量： 5842
正样本数量： 7944
TP:  6896
TN:  1845
FP:  3997
FN:  1048
batch idx: 2, loss: 0.649673 auc: 0.6328, acc: 0.6340, precision: 0.6331, recall: 0.8681, f1: 0.7322, time: 21.208s
负样本数量： 4516
正样本数量： 6277
TP:  5444
TN:  1258
FP:  3258
FN:  833
batch idx: 3, loss: 0.656365 auc: 0.6168, acc: 0.6210, precision: 0.6256, recall: 0.8673, f1: 0.7269, time: 22.023s
负样本数量： 4078
正样本数量： 5335
TP:  4693
TN:  1110
FP:  2968
FN:  642
batch idx: 4, loss: 0.656686 auc: 0.6317, acc: 0.6165, precision: 0.6126, recall: 0.8797, f1: 0.7222, time: 20.894s
负样本数量： 3771
正样本数量： 5510
TP:  4796
TN:  1040
FP:  2731
FN:  714
batch idx: 5, loss: 0.651869 auc: 0.6206, acc: 0.6288, precision: 0.6372, recall: 0.8704, f1: 0.7358, time: 18.206s
负样本数量： 4132
正样本数量： 7394
TP:  6609
TN:  880
FP:  3252
FN:  785
batch idx: 6, loss: 0.641779 auc: 0.5928, acc: 0.6497, precision: 0.6702, recall: 0.8938, f1: 0.7660, time: 34.958s
负样本数量： 4450
正样本数量： 5133
TP:  4357
TN:  1358
FP:  3092
FN:  776
batch idx: 7, loss: 0.668854 auc: 0.6168, acc: 0.5964, precision: 0.5849, recall: 0.8488, f1: 0.6926, time: 18.562s
负样本数量： 5523
正样本数量： 7287
TP:  6174
TN:  1865
FP:  3658
FN:  1113
batch idx: 8, loss: 0.650568 auc: 0.6357, acc: 0.6276, precision: 0.6279, recall: 0.8473, f1: 0.7213, time: 24.213s
负样本数量： 4484
正样本数量： 5757
TP:  5056
TN:  1399
FP:  3085
FN:  701
batch idx: 9, loss: 0.652193 auc: 0.6363, acc: 0.6303, precision: 0.6211, recall: 0.8782, f1: 0.7276, time: 23.314s
负样本数量： 4776
正样本数量： 6011
TP:  5095
TN:  1852
FP:  2924
FN:  916
batch idx: 10, loss: 0.644122 auc: 0.6586, acc: 0.6440, precision: 0.6354, recall: 0.8476, f1: 0.7263, time: 20.670s
负样本数量： 4370
正样本数量： 7234
TP:  6297
TN:  1388
FP:  2982
FN:  937
batch idx: 11, loss: 0.632549 auc: 0.6382, acc: 0.6623, precision: 0.6786, recall: 0.8705, f1: 0.7627, time: 20.674s
First attempt - auc_train: 0.6152331649 acc_train: 0.6148590022
负样本数量： 4682
正样本数量： 5551
TP:  4779
TN:  1244
FP:  3438
FN:  772
负样本数量： 4969
正样本数量： 6658
TP:  5530
TN:  1748
FP:  3221
FN:  1128
负样本数量： 4727
正样本数量： 6980
TP:  5959
TN:  1579
FP:  3148
FN:  1021
负样本数量： 3656
正样本数量： 4784
TP:  4172
TN:  1099
FP:  2557
FN:  612
First attempt - auc_val: 0.6019783082 acc_val: 0.5885859474
Epoch: 0011 loss_train: 0.6516222358 auc_train: 0.6270279466 acc_train: 0.6286946838 precision_train: 0.6301397197 recall_train: 0.8687973403 f1_train: 0.7302152051 loss_val: 0.6582086086 auc_val: 0.6171877769 acc_val: 0.6207392776 precision_val: 0.6219654271 recall_val: 0.8543260550 f1_val: 0.7193933525 time: 294.1575s
Epoch 0011: val_loss 没有改善 0.658209，最佳值 0.658522，等待 7/15
负样本数量： 5293
正样本数量： 6534
TP:  5557
TN:  1652
FP:  3641
FN:  977
batch idx: 0, loss: 0.663314 auc: 0.6181, acc: 0.6095, precision: 0.6042, recall: 0.8505, f1: 0.7065, time: 14.563s
负样本数量： 5353
正样本数量： 5878
TP:  5096
TN:  1504
FP:  3849
FN:  782
batch idx: 1, loss: 0.675137 auc: 0.6157, acc: 0.5877, precision: 0.5697, recall: 0.8670, f1: 0.6876, time: 22.621s
负样本数量： 6295
正样本数量： 7488
TP:  6257
TN:  2247
FP:  4048
FN:  1231
batch idx: 2, loss: 0.660182 auc: 0.6267, acc: 0.6170, precision: 0.6072, recall: 0.8356, f1: 0.7033, time: 21.808s
负样本数量： 5341
正样本数量： 6775
TP:  5886
TN:  1716
FP:  3625
FN:  889
batch idx: 3, loss: 0.649378 auc: 0.6499, acc: 0.6274, precision: 0.6189, recall: 0.8688, f1: 0.7228, time: 17.186s
负样本数量： 4524
正样本数量： 6307
TP:  5534
TN:  1280
FP:  3244
FN:  773
batch idx: 4, loss: 0.649600 auc: 0.6312, acc: 0.6291, precision: 0.6304, recall: 0.8774, f1: 0.7337, time: 18.517s
负样本数量： 5128
正样本数量： 8597
TP:  7497
TN:  1421
FP:  3707
FN:  1100
batch idx: 5, loss: 0.642209 auc: 0.6126, acc: 0.6498, precision: 0.6691, recall: 0.8720, f1: 0.7572, time: 22.873s
负样本数量： 3412
正样本数量： 5630
TP:  5109
TN:  886
FP:  2526
FN:  521
batch idx: 6, loss: 0.635858 auc: 0.6280, acc: 0.6630, precision: 0.6692, recall: 0.9075, f1: 0.7703, time: 22.218s
负样本数量： 2578
正样本数量： 4883
TP:  4372
TN:  690
FP:  1888
FN:  511
batch idx: 7, loss: 0.624966 auc: 0.6265, acc: 0.6785, precision: 0.6984, recall: 0.8954, f1: 0.7847, time: 22.025s
负样本数量： 4278
正样本数量： 5366
TP:  4670
TN:  1184
FP:  3094
FN:  696
batch idx: 8, loss: 0.662172 auc: 0.6229, acc: 0.6070, precision: 0.6015, recall: 0.8703, f1: 0.7113, time: 20.701s
负样本数量： 4898
正样本数量： 6659
TP:  5530
TN:  1791
FP:  3107
FN:  1129
batch idx: 9, loss: 0.650223 auc: 0.6331, acc: 0.6335, precision: 0.6403, recall: 0.8305, f1: 0.7231, time: 19.599s
负样本数量： 3691
正样本数量： 5670
TP:  5052
TN:  853
FP:  2838
FN:  618
batch idx: 10, loss: 0.651381 auc: 0.6148, acc: 0.6308, precision: 0.6403, recall: 0.8910, f1: 0.7451, time: 15.581s
负样本数量： 4006
正样本数量： 6079
TP:  5308
TN:  1275
FP:  2731
FN:  771
batch idx: 11, loss: 0.638464 auc: 0.6363, acc: 0.6528, precision: 0.6603, recall: 0.8732, f1: 0.7519, time: 21.604s
First attempt - auc_train: 0.6180710285 acc_train: 0.6095374989
负样本数量： 4548
正样本数量： 6399
TP:  5506
TN:  1267
FP:  3281
FN:  893
负样本数量： 5588
正样本数量： 6289
TP:  5193
TN:  1998
FP:  3590
FN:  1096
负样本数量： 4177
正样本数量： 6343
TP:  5552
TN:  1125
FP:  3052
FN:  791
负样本数量： 3721
正样本数量： 4942
TP:  4223
TN:  1250
FP:  2471
FN:  719
First attempt - auc_val: 0.6029196068 acc_val: 0.6187083219
Epoch: 0012 loss_train: 0.6502402425 auc_train: 0.6263132239 acc_train: 0.6321686506 precision_train: 0.6341151410 recall_train: 0.8699203345 f1_train: 0.7331350545 loss_val: 0.6572430730 auc_val: 0.6149868140 acc_val: 0.6226568372 precision_val: 0.6235020120 recall_val: 0.8539955875 f1_val: 0.7207440731 time: 295.6104s
Best model so far, saving...
已保存最佳模型到 ../model/expCEKT2025-07-30 11-54-20//checkpoints/best_model.pt
Epoch 0012: val_loss 改善从 0.657243 到 0.657243
负样本数量： 4174
正样本数量： 7702
TP:  6838
TN:  1163
FP:  3011
FN:  864
batch idx: 0, loss: 0.628970 auc: 0.6250, acc: 0.6737, precision: 0.6943, recall: 0.8878, f1: 0.7792, time: 17.402s
负样本数量： 3294
正样本数量： 4827
TP:  4264
TN:  900
FP:  2394
FN:  563
batch idx: 1, loss: 0.649348 auc: 0.6221, acc: 0.6359, precision: 0.6404, recall: 0.8834, f1: 0.7425, time: 24.041s
负样本数量： 5991
正样本数量： 7412
TP:  6228
TN:  1826
FP:  4165
FN:  1184
batch idx: 2, loss: 0.666272 auc: 0.6143, acc: 0.6009, precision: 0.5992, recall: 0.8403, f1: 0.6996, time: 27.255s
负样本数量： 3440
正样本数量： 4811
TP:  4026
TN:  1073
FP:  2367
FN:  785
batch idx: 3, loss: 0.656271 auc: 0.6190, acc: 0.6180, precision: 0.6298, recall: 0.8368, f1: 0.7187, time: 18.560s
负样本数量： 6935
正样本数量： 6505
TP:  5465
TN:  2336
FP:  4599
FN:  1040
batch idx: 4, loss: 0.678433 auc: 0.6246, acc: 0.5804, precision: 0.5430, recall: 0.8401, f1: 0.6597, time: 24.146s
负样本数量： 5449
正样本数量： 8002
TP:  6857
TN:  1662
FP:  3787
FN:  1145
batch idx: 5, loss: 0.648559 auc: 0.6237, acc: 0.6333, precision: 0.6442, recall: 0.8569, f1: 0.7355, time: 25.065s
负样本数量： 4354
正样本数量： 6964
TP:  6145
TN:  1382
FP:  2972
FN:  819
batch idx: 6, loss: 0.632079 auc: 0.6399, acc: 0.6650, precision: 0.6740, recall: 0.8824, f1: 0.7643, time: 28.279s
负样本数量： 4721
正样本数量： 6531
TP:  5749
TN:  1339
FP:  3382
FN:  782
batch idx: 7, loss: 0.650839 auc: 0.6279, acc: 0.6299, precision: 0.6296, recall: 0.8803, f1: 0.7341, time: 17.294s
负样本数量： 3654
正样本数量： 5550
TP:  4961
TN:  984
FP:  2670
FN:  589
batch idx: 8, loss: 0.643425 auc: 0.6264, acc: 0.6459, precision: 0.6501, recall: 0.8939, f1: 0.7528, time: 26.191s
负样本数量： 4292
正样本数量： 6140
TP:  5457
TN:  1097
FP:  3195
FN:  683
batch idx: 9, loss: 0.652842 auc: 0.6217, acc: 0.6283, precision: 0.6307, recall: 0.8888, f1: 0.7378, time: 17.784s
负样本数量： 4503
正样本数量： 5727
TP:  5014
TN:  1486
FP:  3017
FN:  713
batch idx: 10, loss: 0.644288 auc: 0.6577, acc: 0.6354, precision: 0.6243, recall: 0.8755, f1: 0.7289, time: 23.319s
负样本数量： 3990
正样本数量： 5695
TP:  5003
TN:  1111
FP:  2879
FN:  692
batch idx: 11, loss: 0.652719 auc: 0.6143, acc: 0.6313, precision: 0.6347, recall: 0.8785, f1: 0.7370, time: 21.939s
First attempt - auc_train: 0.6250389447 acc_train: 0.6737116874
负样本数量： 3976
正样本数量： 5420
TP:  4731
TN:  1032
FP:  2944
FN:  689
负样本数量： 4876
正样本数量： 6434
TP:  5540
TN:  1552
FP:  3324
FN:  894
负样本数量： 4492
正样本数量： 5605
TP:  4738
TN:  1474
FP:  3018
FN:  867
负样本数量： 4690
正样本数量： 6514
TP:  5493
TN:  1524
FP:  3166
FN:  1021
First attempt - auc_val: 0.6044727544 acc_val: 0.6133461047
Epoch: 0013 loss_train: 0.6503370504 auc_train: 0.6263827660 acc_train: 0.6315068491 precision_train: 0.6328736716 recall_train: 0.8703831118 f1_train: 0.7324996174 loss_val: 0.6581101716 auc_val: 0.6161780820 acc_val: 0.6204820589 precision_val: 0.6216669252 recall_val: 0.8556265620 f1_val: 0.7200302994 time: 295.6433s
Epoch 0013: val_loss 没有改善 0.658110，最佳值 0.657243，等待 1/15
负样本数量： 5016
正样本数量： 6428
TP:  5529
TN:  1647
FP:  3369
FN:  899
batch idx: 0, loss: 0.653933 auc: 0.6290, acc: 0.6271, precision: 0.6214, recall: 0.8601, f1: 0.7215, time: 13.992s
负样本数量： 4390
正样本数量： 5483
TP:  4737
TN:  1519
FP:  2871
FN:  746
batch idx: 1, loss: 0.648079 auc: 0.6428, acc: 0.6336, precision: 0.6226, recall: 0.8639, f1: 0.7237, time: 15.099s
负样本数量： 4234
正样本数量： 6413
TP:  5481
TN:  1295
FP:  2939
FN:  932
batch idx: 2, loss: 0.647852 auc: 0.6273, acc: 0.6364, precision: 0.6510, recall: 0.8547, f1: 0.7390, time: 22.126s
负样本数量： 4448
正样本数量： 5927
TP:  5141
TN:  1382
FP:  3066
FN:  786
batch idx: 3, loss: 0.653998 auc: 0.6266, acc: 0.6287, precision: 0.6264, recall: 0.8674, f1: 0.7275, time: 22.461s
负样本数量： 3334
正样本数量： 5583
TP:  5026
TN:  744
FP:  2590
FN:  557
